<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>æŠ€æœ¯æ–‡ç«  on Junyi's Lab</title><link>/tags/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0/</link><description>Junyi's Lab (æŠ€æœ¯æ–‡ç« )</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><managingEditor>junyi.h@comp.nus.edu.sg
(Junyi Hou)</managingEditor><lastBuildDate>Tue, 12 Sep 2023 15:15:37 +0800</lastBuildDate><atom:link href="/tags/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0/index.xml" rel="self" type="application/rss+xml"/><item><title>Distributed System: Primary Backup Replication</title><link>/posts/paxos-review-3/</link><pubDate>Tue, 12 Sep 2023 15:15:37 +0800</pubDate><author>junyi.h@comp.nus.edu.sg (Junyi Hou)</author><guid>/posts/paxos-review-3/</guid><description>&lt;p>å¼€èƒƒèœæ¥äº†ï¼&lt;/p>
&lt;p>ä½ æœ‰ä¸€ä¸ªç¡¬ç›˜ï¼Œå­˜äº†å¾ˆå¤šé‡è¦èµ„æ–™ï¼Œä½ æ‹…å¿ƒè¿™ä¸ªç¡¬ç›˜æŸå¤©åäº†ï¼Œæ€ä¹ˆåŠï¼Ÿ&lt;/p>
&lt;p>å½“ç„¶æ˜¯å¤šä¹°ç‚¹ç¡¬ç›˜ï¼ŒæŠŠæ•°æ®å¤‡ä»½åœ¨ä¸åŒçš„ç¡¬ç›˜ä¸Šã€‚&lt;/p>
&lt;p>ä¿è¯å¯é ï¼Œå°±æ˜¯é€šè¿‡å¤šä¸ªä¸€è‡´çš„æ•°æ®å‰¯æœ¬æ¥å®ç°çš„ã€‚&lt;/p>
&lt;hr>
&lt;h2 id="å‰æå‡è®¾" >
&lt;div>
&lt;a href="#%e5%89%8d%e6%8f%90%e5%81%87%e8%ae%be">
#
&lt;/a>
å‰æå‡è®¾
&lt;/div>
&lt;/h2>
&lt;p>æˆ‘ä»¬å‡è®¾æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯&lt;ruby>ç¡®å®š&lt;rt>deterministic&lt;/rt>&lt;/ruby>çš„&lt;/p>
&lt;!--
å¤šçº¿ç¨‹é‚£æ ·ï¼Œå› ä¸º scheduler çš„åŸå› å¯¼è‡´æ¯æ¬¡æ‰§è¡Œçš„ç»“æœéƒ½ä¸ä¸€æ ·ã€‚ -->
&lt;h2 id="æœ€ç®€å•çš„-primary--backup" >
&lt;div>
&lt;a href="#%e6%9c%80%e7%ae%80%e5%8d%95%e7%9a%84-primary--backup">
#
&lt;/a>
æœ€ç®€å•çš„ primary &amp;amp; backup
&lt;/div>
&lt;/h2>
&lt;ol>
&lt;li>client&lt;strong>s&lt;/strong> å‘é€ operation (Put, Get, Append) åˆ° primary-server&lt;/li>
&lt;li>primary-server å†³å®š operation çš„æ‰§è¡Œé¡ºåº&lt;/li>
&lt;li>primary-server æŠŠ operation çš„æ‰§è¡Œé¡ºåºå‘é€ç»™ backup-server&lt;/li>
&lt;li>backup-server æŒ‰ç…§ primary-server å‘é€çš„é¡ºåºæ‰§è¡Œ operationï¼ˆhot-standbyï¼‰
&lt;ul>
&lt;li>æˆ–è€… backup-server æŒ‰ç…§ primary-server å‘é€çš„é¡ºåºè®°å½• operation ä½†ä¸æ‰§è¡Œï¼ˆcold-standbyï¼‰&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ç­‰ backup-server æˆåŠŸç»“æŸï¼Œprimary-server ç»™ client å‘å›å¤&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>é—®é¢˜æ˜¯ï¼Œæ€ä¹ˆå†³å®šè°æ¥å½“ primary-serverï¼Ÿ&lt;/strong>&lt;/p>
&lt;p>&lt;strong>æ€ä¹ˆå†³å®šè°æ¥å½“ backup-serverï¼Ÿ&lt;/strong>&lt;/p>
&lt;p>&lt;strong>client æ€ä¹ˆçŸ¥é“è°æ˜¯ primary-serverï¼Ÿ&lt;/strong>&lt;/p>
&lt;p>&lt;strong>ç­”æ¡ˆï¼š&lt;/strong> &lt;span class="spoiler">å¼•å…¥ä¸€å° view-serverï¼Œè®©è¿™ä¸ª view-server æ¥åšå†³å®šï¼Œå¹¶ä¸” client å»é—® view-server è°æ˜¯ primary-serverã€‚ä¸ºä»€ä¹ˆå«å®ƒ view-serverï¼Ÿå› ä¸ºè¿™æ¶‰åŠåˆ°ä¸€ä¸ªé‡è¦æ¦‚å¿µã€Œviewã€ï¼Œåé¢ä¼šè®²åˆ°ï¼Œåˆ«ç€æ€¥ï¼&lt;/span>&lt;/p>
&lt;p>çŸ¥é“äº†ç­”æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·è®¾è®¡æ•´ä¸ªç³»ç»Ÿï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>æˆ‘ä»¬è®©æ¯å°æœåŠ¡å™¨å‘é€å¿ƒè·³ç»™ view-serverï¼Œå‘Šè¯‰ view-server è‡ªå·±è¿˜æ´»ç€ã€‚&lt;/p>
&lt;p>é—®ï¼šæœ‰æ²¡æœ‰å¯èƒ½è‡ªå·±æ´»ç€ä½†æ˜¯ view-server è®¤ä¸ºè‡ªå·±æ­»äº†ï¼Ÿ&lt;span class="spoiler"> æœ‰å¯èƒ½å› ä¸ºç½‘ç»œé—®é¢˜ï¼Œå¿ƒè·³æ²¡å‘å‡ºå»ï¼Œview-server è®¤ä¸ºèŠ‚ç‚¹æŒ‚äº†ï¼Œä½†å…¶å®èŠ‚ç‚¹è¿˜æ´»ç€&lt;/span>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æˆ‘ä»¬ promote idle-server æˆä¸º backup-serverï¼Œä½†ä¸è¶Šçº§ promote æˆä¸º primary-server&lt;/p>
&lt;p>é—®ï¼šé™¤éæœ‰ç§æƒ…å†µï¼Ÿ&lt;span class="spoiler">ç³»ç»Ÿåˆšå¯åŠ¨æ—¶ï¼ˆå…¨éƒ½æ˜¯ idle-serverã€éœ€è¦ä¸€ä¸ª primary çš„æ—¶å€™ï¼‰&lt;/span>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åªæœ‰ backup-server ä¼šè¢« promote æˆ primary-server&lt;/p>
&lt;/li>
&lt;/ul>
&lt;figure>
&lt;img src="view-service.png" alt="View Service" width="500" />
&lt;figcaption>Fig.1 - One View Server and Two Nodes&lt;/figcaption>
&lt;/figure>
&lt;h2 id="ä»€ä¹ˆæ˜¯-view-server-é‡Œçš„-view" >
&lt;div>
&lt;a href="#%e4%bb%80%e4%b9%88%e6%98%af-view-server-%e9%87%8c%e7%9a%84-view">
#
&lt;/a>
ä»€ä¹ˆæ˜¯ view-server é‡Œçš„ view
&lt;/div>
&lt;/h2>
&lt;p>ä¸€ä¸ª view æ˜¯ä¸€ä¸ª primary-server å’Œä¸€ä¸ª backup-server çš„é›†åˆï¼Œæè¿°äº†å½“å‰çŠ¶æ€&lt;strong>è°æ˜¯ primary è°æ˜¯ backup&lt;/strong>ã€‚&lt;/p>
&lt;p>æ³¨æ„ï¼Œä¸€ä¸ª view é‡Œï¼Œåªæœ‰ä¸€ä¸ª primary å’Œä¸€ä¸ª backupï¼Œå…¶å®ƒçš„ server æ ‡è®°ä¸º idleã€‚ï¼ˆæƒ³æƒ³çœ‹ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿï¼‰&lt;/p>
&lt;p>view ç”± view-server è¿›è¡Œç®¡ç†ï¼Œå…¶ä»–èŠ‚ç‚¹å¯ä»¥è·å–åˆ°å½“å‰ç³»ç»Ÿçš„ viewã€‚&lt;/p>
&lt;figure>
&lt;img src="view.png" alt="view-service" width="400" />
&lt;figcaption>Fig.2 - Example of three different views, denotes three different states of the system&lt;/figcaption>
&lt;/figure>
&lt;p>&lt;strong>çœ‹äº†ä¸Šé¢çš„æè¿°ï¼Œæ„Ÿè§‰è‡ªå·±åˆè¡Œäº†ï¼Œäºæ˜¯æˆ‘è®¾è®¡å‡ºäº†ä¸‹é¢çš„æµç¨‹&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>ç³»ç»Ÿåˆšå¼€å§‹ï¼ŒæŒ‘ä¸€ä¸ª primary-serverï¼Œç„¶åæŒ‘ä¸€ä¸ª backup-serverï¼Œå…¶å®ƒçš„éƒ½æ˜¯ idle-serverï¼Œç„¶åå¼€å§‹å·¥ä½œã€‚&lt;/p>
&lt;p>primary ç«‹é©¬è®© backup æˆä¸ºæ–°çš„ primaryï¼Œä» idle é‡Œé¢æŒ‘ä¸€ä¸ªæˆä¸º backupï¼Œç„¶åè®©è¿™ä¸ªæ–°çš„ primary æŠŠçŠ¶æ€éƒ½å‘é€ç»™ backup&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>å¾ˆç®€å•å˜›ï¼è¿™èƒ½æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ&lt;/strong>&lt;/p>
&lt;p>è¯éŸ³åˆšè½ï¼Œé—®é¢˜å°±æ¥äº†ã€‚&lt;/p>
&lt;p>è¯·çœ‹ä¸‹é¢è¿™ä¸ªæƒ…å†µï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-markdown" data-lang="markdown">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#5af78e">`View 1, primary=A, backup=B;`&lt;/span> è¿™æ—¶å€™ A æŒ‚äº†ï¼ŒB æˆä¸º primaryï¼Œä» idle é‡Œé¢æŒ‘ä¸€ä¸ª C æˆä¸º backupï¼Œç„¶å B å‘é€çŠ¶æ€ç»™ Cã€‚
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#5af78e">`View 2, primary=B, backup=C;`&lt;/span> B å‘çŠ¶æ€çš„æ—¶å€™æŒ‚äº†ï¼ŒC æˆä¸º primaryï¼Œidle é‡Œé¢æ²¡æœºå™¨äº†
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#5af78e">`View 3, primary=C, backup=_;`&lt;/span> Cï¼šğŸ˜…ï¼Ÿï¼ˆæ­¤æ—¶ C æ ¹æœ¬ä¸çŸ¥é“ç³»ç»Ÿçš„çŠ¶æ€æ˜¯ä»€ä¹ˆï¼‰
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ‰€ä»¥æˆ‘ä»¬åˆšåˆšå¯¹æ•´ä¸ªç³»ç»Ÿçš„æè¿°ï¼Œæ˜¯æœ‰ç¼ºé™·çš„ã€‚&lt;/p>
&lt;p>æ€ä¹ˆæ”¹å‘¢ï¼Œæˆ‘ä»¬è®© view-server å¿…é¡»ç­‰å¾… primary-server &lt;ruby>ç¡®è®¤&lt;rt>ACK&lt;/rt>&lt;/ruby> å½“å‰çš„ viewã€‚&lt;/p>
&lt;p>å°±ç®— primary-server æŒ‚äº†ï¼Œview-server ä¹Ÿè¦ç­‰ ACKã€‚&lt;/p>
&lt;p>ï¼ˆç›´è§‰å‘Šè¯‰æˆ‘ä»¬ï¼Œè¿™ç§ç­‰å¾… ACK çš„è¡Œä¸ºå¯èƒ½å¯¼è‡´ç³»ç»Ÿå¡ä½ï¼‰&lt;/p>
&lt;h2 id="æ€»ç»“ä¸€ä¸‹æ‰€æœ‰çš„è§„åˆ™" >
&lt;div>
&lt;a href="#%e6%80%bb%e7%bb%93%e4%b8%80%e4%b8%8b%e6%89%80%e6%9c%89%e7%9a%84%e8%a7%84%e5%88%99">
#
&lt;/a>
æ€»ç»“ä¸€ä¸‹æ‰€æœ‰çš„è§„åˆ™
&lt;/div>
&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>åœ¨ view i+1 çš„ primary å¿…é¡»æ˜¯ view i çš„ backup&lt;/p>
&lt;p>å¦‚æœæ²¡æœ‰è¿™ä¸ªè§„åˆ™ä¼šæ€æ ·ï¼Ÿ&lt;span class="spoiler">&lt;strong>Split brain:&lt;/strong> primary A, backup B, but can&amp;rsquo;t reach view-server. C,D are promoted to primary and backup, C doesn&amp;rsquo;t know previous state.&lt;/span>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>primary å¿…é¡»ç­‰ backup æ‰§è¡Œå®Œï¼Œæ‰å¯ä»¥å›å¤ client&lt;/p>
&lt;p>å¦‚æœæ²¡æœ‰è¿™ä¸ªè§„åˆ™ä¼šæ€æ ·ï¼Ÿ&lt;span class="spoiler">&lt;strong>Missing write:&lt;/strong> client writes to Aï¼ŒA crashes before writing to B, clients read from B&lt;/span>&lt;/p>
&lt;p>ä¸€å®šè¦è½¬å‘ read() ç»™ backup å—ï¼Ÿï¼ˆè¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„ä¼˜åŒ–æ“ä½œï¼‰&lt;span class="spoiler">å¿…é¡»è½¬å‘ã€‚ä¸ç„¶å¯èƒ½å‡ºç° &lt;strong>Stale read&lt;/strong>: at &lt;em>view 1&lt;/em>, A,B are primary and backup, but A cannot reach view-server. now &lt;em>view 2&lt;/em>, B,C are primary backup. client 1 writes to B, client 2 reads from A. A returns outdated dataï¼ˆä¸è¿‡ stale read ä¾ç„¶ç¬¦åˆ sequential consistencyï¼‰&lt;/span>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¦‚æœ view æ˜¯æ­£ç¡®çš„ï¼Œbackup å¿…é¡»æ¥å—&lt;ruby>è½¬å‘çš„è¯·æ±‚&lt;rt>Forwarded Request&lt;/rt>&lt;/ruby>ï¼Œå¹¶ä¸”æ‰§è¡Œ&lt;/p>
&lt;p>å¦‚æœæ²¡æœ‰è¿™ä¸ªè§„åˆ™ä¼šæ€æ ·ï¼Ÿ&lt;span class="spoiler">&lt;strong>Partially Split Brain&lt;/strong>&lt;/span>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>non-primary èŠ‚ç‚¹&lt;strong>å¿…é¡»æ‹’ç»&lt;/strong> client çš„è¯·æ±‚&lt;/p>
&lt;p>å¦‚æœæ²¡æœ‰è¿™ä¸ªè§„åˆ™ä¼šæ€æ ·ï¼Ÿ&lt;span class="spoiler">&lt;strong>Inconsistencies:&lt;/strong> client&amp;rsquo;s view may outdated, send request to old primary server.&lt;/span>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>state-transfer çš„æ—¶å€™ä¸èƒ½æœ‰æ“ä½œã€‚ï¼ˆAtomic State Transferï¼‰&lt;/p>
&lt;p>å¦‚æœæ²¡æœ‰è¿™ä¸ªè§„åˆ™ä¼šæ€æ ·ï¼Ÿ&lt;span class="spoiler">&lt;/span>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="è„‘è£‚-split-brain" >
&lt;div>
&lt;a href="#%e8%84%91%e8%a3%82-split-brain">
#
&lt;/a>
è„‘è£‚ (Split-brain)
&lt;/div>
&lt;/h2>
&lt;p>è¿™ä¸ªè¯æœ‰ç‚¹å“äººã€‚ã€‚ã€‚å…¶å®æ˜¯åœ¨è¯´ï¼š&lt;strong>åœ¨ç½‘ç»œæ•…éšœæ—¶ï¼Œä¸¤ä¸ªåŠä»¥ä¸Šçš„èŠ‚ç‚¹éƒ½è®¤ä¸ºè‡ªå·±æ˜¯ Leader (primary-server)ã€‚&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>View 1, primary=A, backup=B; è¿™æ—¶å€™ A ç½‘ç»œå‡ºæ•…éšœæ— æ³•è¿æ¥åˆ° view-serverï¼ŒB æˆä¸ºæ–°çš„ primaryã€‚
View 2, primary=B, backup=_; B æ˜¯ æ–°çš„ primaryï¼Œä½† A ä¹Ÿè®¤ä¸ºè‡ªå·±æ˜¯ primary&lt;/p>
&lt;/blockquote>
&lt;p>åœ¨æˆ‘ä»¬ä¹‹å‰çš„è§„å®šé‡Œï¼Œåªæœ‰ primary-server ä¼šå›å¤ clientï¼Œä½†æ˜¯è„‘è£‚çš„æ—¶å€™ï¼Œä¸¤ä¸ªèŠ‚ç‚¹éƒ½ä¼šå›å¤ clientï¼Œè¿™å°±å¯èƒ½å¯¼è‡´ client æ”¶åˆ°çš„æ•°æ®ä¸ä¸€è‡´ã€‚
ï¼ˆç ´åäº† Linearzabilityï¼‰&lt;/p>
&lt;h2 id="ç³»ç»Ÿå¡ä½" >
&lt;div>
&lt;a href="#%e7%b3%bb%e7%bb%9f%e5%8d%a1%e4%bd%8f">
#
&lt;/a>
ç³»ç»Ÿå¡ä½
&lt;/div>
&lt;/h2>
&lt;p>æœ‰å“ªäº›å¯èƒ½å¯¼è‡´ç³»ç»Ÿå¡ä½ï¼ˆå¤„ç†ä¸äº† client çš„è¯·æ±‚ï¼‰çš„æƒ…å†µï¼Ÿ&lt;/p>
&lt;ol>
&lt;li>view-server æŒ‚äº†&lt;/li>
&lt;li>æ•´ä¸ªç½‘ç»œæŒ‚äº†&lt;/li>
&lt;li>client åªèƒ½ç»ƒåˆ° view-serverï¼Œä¸èƒ½è¿æ¥åˆ° primary-server&lt;/li>
&lt;li>backup server æ²¡æœ‰äº†ï¼ˆå› ä¸º primary è½¬ç§»çŠ¶æ€ç»™ backupï¼Œè½¬ç§»å®Œäº†å›å¤ view-server ä¸€ä¸ª ACKï¼‰&lt;/li>
&lt;li>çŠ¶æ€è½¬ç§»ä¹‹å‰ primary æŒ‚äº†&lt;/li>
&lt;/ol>
&lt;h2 id="é‡å¤å†™å…¥" >
&lt;div>
&lt;a href="#%e9%87%8d%e5%a4%8d%e5%86%99%e5%85%a5">
#
&lt;/a>
é‡å¤å†™å…¥
&lt;/div>
&lt;/h2>
&lt;h2 id="ä¸ºä»€ä¹ˆ-primary-backup-æ¯”è¾ƒéš¾" >
&lt;div>
&lt;a href="#%e4%b8%ba%e4%bb%80%e4%b9%88-primary-backup-%e6%af%94%e8%be%83%e9%9a%be">
#
&lt;/a>
ä¸ºä»€ä¹ˆ Primary Backup æ¯”è¾ƒéš¾
&lt;/div>
&lt;/h2>
&lt;ul>
&lt;li>primary å¯èƒ½æŒ‚æ‰&lt;/li>
&lt;li>backup å¯èƒ½æŒ‚æ‰&lt;/li>
&lt;li>é€šè®¯å¯èƒ½ ä¸´æ—¶/æ°¸ä¹… æŒ‚æ‰&lt;/li>
&lt;li>å‚ä¸è€…çš„å†³ç­–å¯èƒ½å­˜åœ¨å»¶è¿Ÿï¼š
&lt;ul>
&lt;li>view server ä¸çŸ¥é“ primary æŒ‚äº†&lt;/li>
&lt;li>primary æŒ‚äº†å—ï¼ŸæŒ‚äº†ä¹‹åæ¢å¤ï¼Œè¿˜éœ€è¦å›å¤ client å—ï¼Ÿ&lt;/li>
&lt;li>backup æŒ‚äº†å—ï¼Ÿstate transfer ç»“æŸäº†å—ï¼Ÿ&lt;/li>
&lt;li>client ä¸çŸ¥é“ view æœ‰æ²¡æœ‰åˆ‡æ¢&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="æ€»ç»“ä¸€ä¸‹-view-server-çš„ç¼ºç‚¹" >
&lt;div>
&lt;a href="#%e6%80%bb%e7%bb%93%e4%b8%80%e4%b8%8b-view-server-%e7%9a%84%e7%bc%ba%e7%82%b9">
#
&lt;/a>
æ€»ç»“ä¸€ä¸‹ view-server çš„ç¼ºç‚¹
&lt;/div>
&lt;/h2>
&lt;ol>
&lt;li>view-server è‡ªå·±å­˜åœ¨å•ç‚¹æ•…éšœé—®é¢˜&lt;/li>
&lt;li>view-server å¿…é¡»ç­‰å¾… primary çš„ ackï¼Œå³ä½¿ primary å¯èƒ½æŒ‚äº†ä¹Ÿè¦ç­‰&lt;/li>
&lt;/ol>
&lt;h2 id="rubyçŠ¶æ€æœºå¤åˆ¶rtstate-machine-replicationrtruby" >
&lt;div>
&lt;a href="#ruby%e7%8a%b6%e6%80%81%e6%9c%ba%e5%a4%8d%e5%88%b6rtstate-machine-replicationrtruby">
#
&lt;/a>
&lt;ruby>çŠ¶æ€æœºå¤åˆ¶&lt;rt>State Machine Replication&lt;/rt>&lt;/ruby>
&lt;/div>
&lt;/h2>
&lt;blockquote>
&lt;p>&lt;strong>çŠ¶æ€æœºæœ‰ä¸€ä¸ªç‰¹æ€§ï¼š&lt;/strong> ä»»ä½•åˆå§‹çŠ¶æ€ä¸€æ ·çš„çŠ¶æ€æœºï¼Œå¦‚æœæ‰§è¡Œçš„å‘½ä»¤åºåˆ—ä¸€æ ·ï¼Œåˆ™æœ€ç»ˆè¾¾åˆ°çš„çŠ¶æ€ä¹Ÿä¸€æ ·ã€‚&lt;/p>
&lt;p>å¦‚æœå°†æ­¤ç‰¹æ€§åº”ç”¨åœ¨å¤šå‚ä¸è€…è¿›è¡Œåå•†å…±è¯†ä¸Šï¼Œå¯ä»¥ç†è§£ä¸ºç³»ç»Ÿä¸­å­˜åœ¨å¤šä¸ªå…·æœ‰å®Œå…¨ç›¸åŒçš„çŠ¶æ€æœºï¼ˆå‚ä¸è€…ï¼‰ï¼Œè¿™äº›çŠ¶æ€æœºèƒ½æœ€ç»ˆä¿æŒä¸€è‡´çš„å…³é”®å°±æ˜¯èµ·å§‹çŠ¶æ€å®Œå…¨ä¸€è‡´å’Œæ‰§è¡Œå‘½ä»¤åºåˆ—å®Œå…¨ä¸€è‡´ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>æ ¹æ®çŠ¶æ€æœºçš„ç‰¹æ€§ï¼Œè¦è®©å¤šå°æœºå™¨çš„æœ€ç»ˆçŠ¶æ€ä¸€è‡´ï¼Œåªè¦ç¡®ä¿å®ƒä»¬çš„åˆå§‹çŠ¶æ€æ˜¯ä¸€è‡´çš„ï¼Œå¹¶ä¸”æ¥æ”¶åˆ°çš„æ“ä½œæŒ‡ä»¤åºåˆ—ä¹Ÿæ˜¯ä¸€è‡´çš„å³å¯ï¼Œæ— è®ºè¿™ä¸ªæ“ä½œæŒ‡ä»¤æ˜¯æ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤æŠ‘æˆ–æ˜¯å…¶ä»–ä»»ä½•å¯èƒ½çš„ç¨‹åºè¡Œä¸ºï¼Œéƒ½å¯ä»¥ç†è§£ä¸ºè¦å°†ä¸€è¿ä¸²çš„æ“ä½œæ—¥å¿—æ­£ç¡®åœ°å¹¿æ’­ç»™å„ä¸ªåˆ†å¸ƒå¼èŠ‚ç‚¹ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬å¹¶ä¸è¦æ±‚æ‰€æœ‰èŠ‚ç‚¹çš„æ¯ä¸€æ¡æŒ‡ä»¤éƒ½æ˜¯åŒæ—¶å¼€å§‹ã€åŒæ­¥å®Œæˆçš„ï¼Œåªè¦æ±‚åœ¨æ­¤æœŸé—´çš„å†…éƒ¨çŠ¶æ€ä¸èƒ½è¢«å¤–éƒ¨è§‚å¯Ÿåˆ°ï¼Œä¸”å½“æ“ä½œæŒ‡ä»¤åºåˆ—æ‰§è¡Œå®Œæ¯•æ—¶ï¼Œæ‰€æœ‰èŠ‚ç‚¹çš„æœ€ç»ˆçš„çŠ¶æ€æ˜¯ä¸€è‡´çš„ï¼Œè¿™ç§æ¨¡å‹å°±è¢«ç§°ä¸ºçŠ¶æ€æœºå¤åˆ¶ï¼ˆState Machine Replicationï¼‰ã€‚&lt;/p>
&lt;style>
.spoiler {
color: black;
background-color: black;
transition: color 0.2s;
border-radius: 5px;
padding-right: 5px;
padding-left: 5px;
}
/* .spoiler::before {
content: "hover me to see the answer";
color: white;
background-color: black;
} */
.spoiler:hover {
visibility: visible;
color: white
}
/*
.spoiler:hover::before {
display: none;
} */
&lt;/style>
&lt;h2 id="tips" >
&lt;div>
&lt;a href="#tips">
#
&lt;/a>
Tips
&lt;/div>
&lt;/h2>
&lt;p>å®ç° Paxos çš„æ³¨æ„äº‹é¡¹å¯ä»¥å‚è€ƒ Junhui çš„ Cheatsheet&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>&lt;/p>
&lt;h2 id="reference" >
&lt;div>
&lt;a href="#reference">
#
&lt;/a>
Reference
&lt;/div>
&lt;/h2>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>&lt;a href="https://jzhu.xyz/posts/paxos">https://jzhu.xyz/posts/paxos&lt;/a> (Cheatsheet of MultiPaxos Impl)&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Distributed System: Consistency</title><link>/posts/paxos-review-2/</link><pubDate>Tue, 12 Sep 2023 14:06:01 +0800</pubDate><author>junyi.h@comp.nus.edu.sg (Junyi Hou)</author><guid>/posts/paxos-review-2/</guid><description>&lt;p>è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯å¯¹åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„&lt;ruby>ä¸€è‡´æ€§&lt;rt>Consistency&lt;/rt>&lt;/ruby>è¿›è¡ŒåŒºåˆ†&lt;/p>
&lt;p>&lt;strong>&lt;ruby>å¼±ä¸€è‡´æ€§&lt;rt>Weak Consistency&lt;/rt>&lt;/ruby>&lt;/strong>ï¼šå…è®¸ç³»ç»Ÿçš„è¡Œä¸ºä¸å•ä¸€ç³»ç»Ÿçš„è¡Œä¸ºä¸ä¸€è‡´ã€‚&lt;/p>
&lt;p>&lt;strong>&lt;ruby>å¼ºä¸€è‡´æ€§&lt;rt>Strong Consistency&lt;/rt>&lt;/ruby>&lt;/strong>ï¼šæ•´ä¸ªç³»ç»Ÿè¡¨ç°å¾—åƒæ˜¯ä¸€ä¸ªå•ä¸€çš„ã€æ— å¹¶å‘çš„å®ä½“ã€‚&lt;/p>
&lt;hr>
&lt;p>ä¸‹é¢çš„ä¸€è‡´æ€§ï¼Œç”±å¼±åˆ°å¼º&lt;/p>
&lt;h2 id="rubyæœ€ç»ˆä¸€è‡´æ€§rteventual-consistencyrtruby" >
&lt;div>
&lt;a href="#ruby%e6%9c%80%e7%bb%88%e4%b8%80%e8%87%b4%e6%80%a7rteventual-consistencyrtruby">
#
&lt;/a>
&lt;ruby>æœ€ç»ˆä¸€è‡´æ€§&lt;rt>Eventual Consistency&lt;/rt>&lt;/ruby>
&lt;/div>
&lt;/h2>
&lt;p>ç³»ç»Ÿæœ€ç»ˆä¼šè¾¾åˆ°ä¸€è‡´çš„çŠ¶æ€ã€‚&lt;/p>
&lt;h2 id="rubyå› æœä¸€è‡´æ€§rtcausal-consistencyrtruby" >
&lt;div>
&lt;a href="#ruby%e5%9b%a0%e6%9e%9c%e4%b8%80%e8%87%b4%e6%80%a7rtcausal-consistencyrtruby">
#
&lt;/a>
&lt;ruby>å› æœä¸€è‡´æ€§&lt;rt>Causal Consistency&lt;/rt>&lt;/ruby>
&lt;/div>
&lt;/h2>
&lt;p>æ¯” Sequential Consistency æ›´å¼±ã€‚
å¦‚æœæ“ä½œ A ä¾èµ–äºæ“ä½œ Bï¼Œé‚£ä¹ˆæ“ä½œ B å‘ç”Ÿåœ¨æ“ä½œ A ä¹‹å‰ï¼Œä½†æ˜¯å¦‚æœæ“ä½œ A å’Œæ“ä½œ B ä¹‹é—´æ²¡æœ‰å› æœå…³ç³»ï¼Œé‚£ä¹ˆæ“ä½œ A å’Œæ“ä½œ B çš„é¡ºåºæ˜¯ä¸ç¡®å®šçš„ã€‚&lt;/p>
&lt;blockquote>
&lt;p>æœ‰å› æ‰æœ‰æœï¼Œå› åœ¨æœä¹‹å‰&lt;/p>
&lt;p>å…ˆçœ‹è§å› ï¼Œå†çœ‹è§æœ&lt;/p>
&lt;p>å¦‚æœä¸€ä¸ªé—®é¢˜è¢«å›ç­”ï¼Œæ˜¾ç„¶é—®é¢˜æœ¬èº«å¾—å…ˆåœ¨é‚£é‡Œï¼Œå› ä¸ºç»™å‡ºç­”æ¡ˆçš„äººå¿…é¡»å·²ç»çœ‹åˆ°è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è®¤ä¸ºåœ¨é—®é¢˜å’Œç­”æ¡ˆä¹‹é—´å­˜åœ¨å› æœä¾èµ–ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>æ¯”å¦‚å¾®ä¿¡æœ‹å‹åœˆéœ€è¦æœåŠ¡å™¨ä¹‹é—´é‡‡ç”¨å› æœä¸€è‡´æ€§ï¼Œæ¥ä¿è¯ç”¨æˆ·åˆ·æœ‹å‹åœˆæ—¶ä¸ä¼šçœ‹åˆ°è¯„è®ºæ‰€å¯¹åº”çš„ç­”å¤è€Œçœ‹ä¸åˆ°å¯¹åº”çš„è¯„è®ºã€‚&lt;/p>
&lt;img src="wechat-arch.png" alt="drawing" width="600" />
&lt;p>å»¶ä¼¸é˜…è¯»ï¼šæ€ä¹ˆç”Ÿæˆå”¯ä¸€ä¸”é€’å¢çš„ IDï¼Ÿ&lt;a href="https://www.infoq.cn/article/wechat-serial-number-generator-architecture/">å¾®ä¿¡åºåˆ—å·ç”Ÿæˆå™¨æ¶æ„è®¾è®¡åŠæ¼”å˜&lt;/a>&lt;a href="https://segmentfault.com/a/1190000040964518">é›ªèŠ±ç®—æ³•&lt;/a>&lt;/p>
&lt;h2 id="rubyåºåˆ—ä¸€è‡´æ€§rtsequential-consistencyrtruby" >
&lt;div>
&lt;a href="#ruby%e5%ba%8f%e5%88%97%e4%b8%80%e8%87%b4%e6%80%a7rtsequential-consistencyrtruby">
#
&lt;/a>
&lt;ruby>åºåˆ—ä¸€è‡´æ€§&lt;rt>Sequential Consistency&lt;/rt>&lt;/ruby>
&lt;/div>
&lt;/h2>
&lt;p>ä¸ç®¡ç³»ç»Ÿæ€ä¹ˆè¿è¡Œï¼Œå¾—åˆ°çš„ç»“æœå°±å¥½åƒæŠŠæ‰€æœ‰èŠ‚ç‚¹çš„æ‰€æœ‰æ“ä½œæŒ‰ç…§æŸä¸ª sequential order æ’åºåè¿è¡Œï¼Œä½†æ˜¯åœ¨è¿™ä¸ª sequential order ä¸­ï¼Œæ¥è‡ªåŒä¸€ä¸ªèŠ‚ç‚¹çš„æ“ä½œä»ç„¶ä¿æŒç€å®ƒä»¬åœ¨èŠ‚ç‚¹ä¸­è¢«æŒ‡å®šçš„é¡ºåºã€‚&lt;/p>
&lt;p>æ¢å¥è¯è¯´ï¼Œç‰©ç†æ„ä¹‰ä¸Šçš„æ—¶é—´ï¼Œä¸èƒ½å†³å®š&lt;ruby>æ“ä½œ&lt;rt>operations&lt;/rt>&lt;/ruby>çš„æ‰§è¡Œé¡ºåº&lt;/p>
&lt;p>ç”¨ä½œ Transaction æ—¶æˆ‘ä»¬ç§°ä¹‹ä¸º Serializability&lt;/p>
&lt;p>å¸¸ç”¨åœ¨ é“¶è¡Œã€é‡‘èæ•°æ®åº“ã€äº‹åŠ¡&lt;/p>
&lt;h2 id="rubyçº¿æ€§ä¸€è‡´æ€§rtlinearizable-consistencyrtruby" >
&lt;div>
&lt;a href="#ruby%e7%ba%bf%e6%80%a7%e4%b8%80%e8%87%b4%e6%80%a7rtlinearizable-consistencyrtruby">
#
&lt;/a>
&lt;ruby>çº¿æ€§ä¸€è‡´æ€§&lt;rt>Linearizable Consistency&lt;/rt>&lt;/ruby>
&lt;/div>
&lt;/h2>
&lt;p>ä¹Ÿå« Linearizability&lt;/p>
&lt;p>æ˜¯ã€é¡ºåºä¸€è‡´æ€§ + æŒ‰ç…§ç‰©ç†æ—¶é—´é¡ºåºæ‰§è¡Œã€‘ã€‚&lt;/p>
&lt;p>æ»¡è¶³çº¿æ€§ä¸€è‡´æ€§çš„æ•°æ®ç»“æ„ï¼Œè¡¨ç°å¾—åƒæ˜¯ä¸€ä¸ªå•ä¸€çš„ã€æ— å¹¶å‘çš„å®ä½“ã€‚&lt;span style="color: #cd7a32;">&lt;strong>æ˜¯æœ€å¼ºçš„ä¿è¯&lt;/strong>&lt;/span>&lt;/p>
&lt;p>æ¯”å¦‚ Google Spanner&lt;/p>
&lt;hr>
&lt;p>ä»‹ç»åˆ°è¿™é‡Œï¼ŒåŸºæœ¬ä¸Šå¯¹ Consistency æœ‰äº†å¤§è‡´çš„äº†è§£ï¼Œæ¥ä¸‹æ¥å¯ä»¥çœ‹ Primary Backup Replication äº†ã€‚&lt;/p>
&lt;h2 id="lab-2" >
&lt;div>
&lt;a href="#lab-2">
#
&lt;/a>
Lab 2
&lt;/div>
&lt;/h2>
&lt;p>å®ç° Primary-backup replicationï¼š&lt;/p>
&lt;ol>
&lt;li>client å‘é€è¯·æ±‚ç»™ primary-server&lt;/li>
&lt;li>ç”±ä¸€ä¸ª ä¸­å¤® view-server å†³å®šè°æ˜¯ primary è°æ˜¯ backup&lt;/li>
&lt;li>primary æŒ‚äº†ï¼Œbackup é¡¶ä¸Šæ¥&lt;/li>
&lt;/ol>
&lt;img src="pbr.png" alt="drawing" width="400"/></description></item><item><title>å½“ RA çš„æˆ‘å­¦åˆ°äº†ä»€ä¹ˆï¼šå¦‚ä½•ä¼˜åŒ–å®éªŒæµç¨‹</title><link>/posts/ra-experience/</link><pubDate>Fri, 25 Aug 2023 21:32:31 +0800</pubDate><author>junyi.h@comp.nus.edu.sg (Junyi Hou)</author><guid>/posts/ra-experience/</guid><description>&lt;h2 id="èƒŒæ™¯" >
&lt;div>
&lt;a href="#%e8%83%8c%e6%99%af">
#
&lt;/a>
èƒŒæ™¯
&lt;/div>
&lt;/h2>
&lt;p>æˆä¸º NUS çš„ Research Assistantï¼Œ æˆ‘è·‘äº† &lt;del>1,072&lt;/del> 3,172 ä¸ªå®éªŒã€‚&lt;/p>
&lt;p>å‡ å‘¨å‰ï¼Œé¢å¯¹å°è€æ¿çš„éœ€æ±‚ï¼Œæˆ‘æ‰‹è¶³æ— æªï¼š&lt;/p>
&lt;blockquote>
&lt;p>â€œæŠŠ XX æ•°æ®é›†åœ¨ A B C ä¸‰ä¸ªç®—æ³•ä¸Šè·‘ä¸€ä¸‹â€&lt;/p>
&lt;p>â€œæŠŠ learning rate æ”¹æˆ 0.001 è·‘ä¸€ä¸‹â€&lt;/p>
&lt;p>â€œæŠŠ activationå±‚ å»æ‰ï¼Œè·‘ä¸€ä¸‹â€&lt;/p>
&lt;p>â€œæ˜¨å¤©è·‘çš„å®éªŒç»“æœæ€ä¹ˆæ ·äº†ï¼Ÿâ€ ï¼ˆä¸€çœ‹ log å‘ç°é›¶é›¶æ•£æ•£å‡ ä¸ªä»»åŠ¡å‡ºé”™äº†éœ€è¦é‡æ–°è·‘ï¼‰&lt;/p>
&lt;/blockquote>
&lt;p>ç‰¹åˆ«æ˜¯ï¼ŒåŒæ—¶åœ¨&lt;strong>ä¸åŒæœåŠ¡å™¨ä¸Š&lt;/strong>è¿è¡Œ&lt;strong>å¾ˆå¤šä»»åŠ¡&lt;/strong>ï¼Œå¹¶ä¸”&lt;strong>ä¸ªåˆ«ä»»åŠ¡&lt;/strong>è·‘çš„æ—¶å€™ &lt;code>æ˜¾å¡/å†…å­˜&lt;/code> æŠ¥é”™ï¼Œlog é‡Œè®°å½•çš„ä¿¡æ¯å¹¶ä¸è¶³ä»¥åŒºåˆ†è¿™æ˜¯å“ªä¸ªä»»åŠ¡çš„æ—¶å€™&amp;hellip;.&lt;/p>
&lt;p>æ›´ç³Ÿç³•çš„æ˜¯ï¼Œä¸åŒæœåŠ¡å™¨ä¸Šçš„ä»£ç ç‰ˆæœ¬ä¹Ÿå¯èƒ½ä¸åŒï¼Œè¿™è®©é—®é¢˜å˜å¾—æ›´å¤æ‚ï¼ˆä½¿ç”¨gitå¯èƒ½æ˜¯ä¸€ä¸ªè§£å†³æ–¹æ³•ï¼‰ã€‚&lt;/p>
&lt;p>å½“æˆ‘å†™ä¸‹è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œæ„è¯†åˆ°æˆ‘å¯ä»¥æŠŠæ€»ç»“å‡ºçš„æŠ€èƒ½&lt;strong>è¿ç§»åˆ°å…¶ä»–é¡¹ç›®ä¸­&lt;/strong>ã€‚&lt;/p>
&lt;p>ä¸ºäº†é˜²æ­¢é—å¿˜ï¼Œæˆ‘æŠŠè¿™æ¬¡çš„ç»éªŒå†™ä¸‹æ¥ï¼Œè·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹å¿ƒå¾—ï¼ˆæˆ‘æ˜¯å¦‚ä½•å»ºç«‹å±äºæˆ‘çš„&lt;strong>æ–‡ä»¶ç®¡ç†ä½“ç³»&lt;/strong>å’Œ&lt;strong>å®éªŒè¿›åº¦è¿½è¸ª&lt;/strong>æ–¹æ³•ï¼‰&lt;/p>
&lt;h2 id="æ–‡ä»¶ç®¡ç†ä½“ç³»" >
&lt;div>
&lt;a href="#%e6%96%87%e4%bb%b6%e7%ae%a1%e7%90%86%e4%bd%93%e7%b3%bb">
#
&lt;/a>
æ–‡ä»¶ç®¡ç†ä½“ç³»
&lt;/div>
&lt;/h2>
&lt;p>&lt;strong>æ•°æ®é›†æ–‡ä»¶å¤¹&lt;/strong>ä½¿ç”¨ç»Ÿä¸€çš„æ–‡ä»¶ç»“æ„ï¼Œç”¨äºå­˜æ”¾å„ç§æ•°æ®é›†ã€‚ï¼ˆä¸é¡¹ç›®æ— å…³ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>/home/junyi/data/mnist/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/home/junyi/data/cifar10/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/home/junyi/data/covtype/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>é¡¹ç›®æ–‡ä»¶å¤¹&lt;/strong>é’ˆå¯¹æ¯ä¸€ä¸ªé¡¹ç›®å•ç‹¬è®¾ç«‹ï¼ˆä¾‹å¦‚VertiBenchå’ŒVertiLearnï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>/home/junyi/project/VertiBench/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/home/junyi/project/VertiLearn/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ./experiment/ &lt;span style="color:#78787e"># å®éªŒæ–‡ä»¶å¤¹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ./experiment/&lt;span style="color:#ff6ac1">{&lt;/span>exp-name&lt;span style="color:#ff6ac1">}&lt;/span>-&lt;span style="color:#ff6ac1">{&lt;/span>timestamp&lt;span style="color:#ff6ac1">}&lt;/span>/*.log
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ./data/ &lt;span style="color:#78787e"># è½¯é“¾æ¥åˆ°æ•°æ®é›†&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ./code/ &lt;span style="color:#78787e"># é¡¹ç›®çš„ä»“åº“ / ç›¸å…³ä»£ç &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ./rebuttal/ &lt;span style="color:#78787e"># å›å¤ Reviewer çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ./rebuttal/&lt;span style="color:#ff6ac1">{&lt;/span>reviewer-id&lt;span style="color:#ff6ac1">}&lt;/span>/experiment/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ./rebuttal/&lt;span style="color:#ff6ac1">{&lt;/span>reviewer-id&lt;span style="color:#ff6ac1">}&lt;/span>/plot/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ./rebuttal/&lt;span style="color:#ff6ac1">{&lt;/span>reviewer-id&lt;span style="color:#ff6ac1">}&lt;/span>/comment/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å¦‚ä½•åšå®éªŒ" >
&lt;div>
&lt;a href="#%e5%a6%82%e4%bd%95%e5%81%9a%e5%ae%9e%e9%aa%8c">
#
&lt;/a>
å¦‚ä½•åšå®éªŒ
&lt;/div>
&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>â­ï¸ è‡ªåŠ¨åŒ–&lt;/strong>: è·‘å¤ªå¤šçš„å®éªŒçœŸçš„å¾ˆéº»çƒ¦ï¼Œç‰¹åˆ«æ˜¯å‡ºé—®é¢˜éœ€è¦é‡è·‘ç‰¹å®šçš„å®éªŒæ—¶ä¼šè®©äººå¤´å¤§ã€‚æˆ‘åšå†³åå¯¹æ‰‹å·¥æ“ä½œï¼Œå³ä½¿åšæ‰‹å·¥å®éªŒï¼Œä¹ŸåŠ¡å¿…è®°å½•æ¯ä¸€ä¸ªå®éªŒå‘½ä»¤ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ä½¿ç”¨è„šæœ¬&lt;/strong>: æˆ‘é è„šæœ¬å®ç°è‡ªåŠ¨åŒ–ï¼Œç”¨ä¸€ä¸ªè„šæœ¬æ¥ç®¡ç†æ‰€æœ‰çš„å®éªŒï¼Œæ¯ä¸ªå®éªŒéƒ½ä¼šè¢«åˆ†é…ä¸€ä¸ª&lt;strong>å”¯ä¸€id&lt;/strong>ã€‚è¿™æ ·åœ¨æŸä¸ªå®éªŒå‡ºé”™æ—¶ï¼Œä¾‹å¦‚&lt;code>æ˜¾å­˜ä¸è¶³&lt;/code>ï¼Œæˆ‘å¯ä»¥ç›´æ¥æ ¹æ® id é‡æ–°è¿è¡Œè¯¥å®éªŒï¼ˆç‰¹åˆ«æ˜¯åœ¨ä½¿ç”¨ slurm çš„æ—¶å€™ï¼Œæœ‰è¿™æ ·çš„è„šæœ¬å¯ä»¥çœå»ä¸å°‘å†™ sbatch çš„å·¥ä½œï¼‰ã€‚åŒæ—¶ï¼Œæˆ‘è¿˜æœ‰å¦ä¸€ä¸ªè„šæœ¬ç”¨æ¥&lt;strong>è¿½è¸ªæ¯ä¸ªå®éªŒçš„è¿›åº¦&lt;/strong>ï¼ˆæ‰“å°è¿›åº¦æ¡ï¼‰ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ—¥å¿—è¦ print å®Œæ•´&lt;/strong>: æ¯æ¬¡å®éªŒéƒ½ç¡®ä¿æ‰“å°æ‰€æœ‰çš„å‚æ•°ï¼Œæ¯ä¸€è¡Œçš„å¼€å¤´éƒ½è¦æœ‰æ—¶é—´ï¼ˆç²¾ç¡®åˆ°ç§’ï¼‰ï¼Œæ‰“å°çš„å†…å®¹åŒ…æ‹¬æ¨¡å‹çš„&lt;strong>è¶…å‚æ•°&lt;/strong>å’Œ&lt;strong>ç»“æ„&lt;/strong>ï¼Œå¹¶ä¸”æŠŠ parse çš„ args éƒ½æ‰“å°å‡ºæ¥ã€‚å½“å®éªŒå˜å¾—å¤æ‚å¹¶ä¸”æ—¶é—´æœ‰é™æ—¶ï¼Œè¿™ç§è¯¦ç»†çš„è®°å½•éå¸¸æœ‰åŠ©äºæˆ‘å›é¡¾ã€‚ï¼ˆå¦‚æœå®éªŒåè¶³å¤Ÿè¯¦ç»†ï¼Œå…¶å®åœ¨æ—¥å¿—é‡Œä¹Ÿæ²¡å¿…è¦æ‰“å°è¿™ä¹ˆå¤šå†…å®¹ï¼‰&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ä¸ºå®éªŒå‘½å&lt;/strong>: ä¸ºäº†æ–¹ä¾¿æŸ¥æ‰¾ï¼Œæ¯æ¬¡å®éªŒæˆ‘éƒ½ä¼šç»™å®ƒä¸€ä¸ªæè¿°æ€§çš„åå­—ï¼Œå¦‚ â€œtest SplitNN with lr 0.3â€ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ä½¿ç”¨ git&lt;/strong>: ä¸ºäº†å°½å¿«å¾—åˆ°ç»“æœï¼Œæˆ‘ä¸å¾—ä¸åœ¨å¤šå°æœºå™¨ä¸Šè¿›è¡Œå®éªŒï¼Œè¿™è®©æˆ‘éå¸¸éå¸¸å¤´ç—›ã€‚å»ºè®®ä½¿ç”¨ git æ¥å®Œæˆå¤šä¸ªæœºå™¨çš„ä»£ç åŒæ­¥ã€‚ï¼ˆä¸å»ºè®®ç”¨ git æ¥åŒæ­¥&lt;strong>æ•°æ®é›†&lt;/strong>ğŸ¤£ï¼‰&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="æ€»ç»“" >
&lt;div>
&lt;a href="#%e6%80%bb%e7%bb%93">
#
&lt;/a>
æ€»ç»“
&lt;/div>
&lt;/h2>
&lt;p>è¿™æ¬¡ RA æ„Ÿè§‰è¿˜è›®è‹¦çš„ï¼Œä¸è¿‡å¥½åœ¨æˆ‘ â€œé—­é—¨é€ è½¦â€ï¼Œé€ å‡ºæ¥ä¸€å¥—å±äºæˆ‘çš„æ–‡ç®¡ç†ä½“ç³»å’Œè¿›åº¦è¿½è¸ªç³»ç»Ÿï¼Œæé«˜äº†å·¥ä½œæ•ˆç‡ï¼Œä¹Ÿå‡å°‘äº†å¾ˆå¤šå¿ƒæ™ºè´Ÿæ‹…ã€‚&lt;/p>
&lt;blockquote>
&lt;p>ï¼ˆåæ¥æœ‰è€å¸ˆè¯´ï¼Œåš benchmark ç¡®å®æ˜¯ä¸€ä¸ªå¾ˆè‹¦çš„å·¥ä½œï¼‰&lt;/p>
&lt;/blockquote>
&lt;p>å¸Œæœ›æˆ‘çš„ç»éªŒèƒ½ä¸ºå¤§å®¶æä¾›ä¸€äº›å‚è€ƒã€‚&lt;/p>
&lt;p>åŒæ—¶ä¹Ÿæƒ³å‘Šè¯«è‡ªå·±ï¼Œ&lt;strong>&lt;span style="color: red;">ä¸è¦æƒ³å·æ‡’ï¼ï¼ï¼&lt;/span>&lt;/strong> &lt;strong>ä¸è¦æƒ³ç€ â€œè¿™ä¸ªå®éªŒæ‰‹åŠ¨è·‘ä¸€ä¸‹ç®—äº†â€&lt;/strong>ï¼Œå› ä¸ºä½ æ°¸è¿œä¸çŸ¥é“å“ªä¸ªå®éªŒä¼šå‡ºé—®é¢˜ï¼Œå“ªä¸ªå®éªŒä¼šæˆä¸ºä½ çš„é‡è¦æˆæœã€‚&lt;/p>
&lt;p>ä¹Ÿé¡ºä¾¿æ„Ÿè°¢å°è€æ¿ä¸€ç›´å¯¹æˆ‘å¾ˆæœ‰è€å¿ƒï¼åœ¨åˆä½œè¿‡ç¨‹ä¸­å°è€æ¿ç»™åˆ°æˆ‘å¾ˆå¤šä¸­è‚¯çš„å»ºè®®ï¼Œè®©æˆ‘å­¦åˆ°äº†å¾ˆå¤šï¼Œå…·ä½“è·Ÿå°è€æ¿å‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼Œæˆ‘å‡†å¤‡å¦å¤–å†™ç¯‡æ–‡ç« æ¥è®°å½•ã€‚ (è§ &lt;a href="https://www.junyi.dev/posts/research-101/">è¿™ç¯‡æ–‡ç« &lt;/a>)&lt;/p>
&lt;hr>
&lt;h2 id="åç»­æ›´æ–°" >
&lt;div>
&lt;a href="#%e5%90%8e%e7%bb%ad%e6%9b%b4%e6%96%b0">
#
&lt;/a>
åç»­æ›´æ–°
&lt;/div>
&lt;/h2>
&lt;h3 id="2023-å¹´-9-æœˆ-22-æ—¥æ›´æ–°" >
&lt;div>
&lt;a href="#2023-%e5%b9%b4-9-%e6%9c%88-22-%e6%97%a5%e6%9b%b4%e6%96%b0">
##
&lt;/a>
2023 å¹´ 9 æœˆ 22 æ—¥æ›´æ–°
&lt;/div>
&lt;/h3>
&lt;p>è®ºæ–‡æŠ• NeurIPS 2023 è¢«æ‹’äº†ï¼Œè½¬æŠ• ICLR 2024ï¼Œéœ€è¦è¡¥ä¸€äº›å®éªŒï¼Œè¿˜å¥½æœ‰&lt;strong>è‡ªåŠ¨åŒ–è„šæœ¬&lt;/strong>å’Œ&lt;strong>æœ‰åºçš„æ–‡ä»¶ç»“æ„&lt;/strong>ï¼Œè®©æˆ‘ä¸ç”¨èŠ±å¤ªå¤šæ—¶é—´å°±èƒ½å®Œæˆè¿™äº›å®éªŒã€‚&lt;/p>
&lt;h3 id="2023-å¹´-10-æœˆ-2-æ—¥æ›´æ–°" >
&lt;div>
&lt;a href="#2023-%e5%b9%b4-10-%e6%9c%88-2-%e6%97%a5%e6%9b%b4%e6%96%b0">
##
&lt;/a>
2023 å¹´ 10 æœˆ 2 æ—¥æ›´æ–°
&lt;/div>
&lt;/h3>
&lt;p>è¡¥äº†å®éªŒï¼Œé‡æ–°ç”»äº†å›¾ï¼ˆæˆ‘åªéœ€è¦æŠŠ log æ”¾åˆ°å¯¹åº”çš„æ–‡ä»¶å¤¹é‡Œï¼Œç„¶åè¿è¡Œä¸€ä¸‹ Jupyter Notebook å°±å¯ä»¥äº†ï¼‰&lt;/p>
&lt;h3 id="2023-å¹´-11-æœˆ-16-æ—¥æ›´æ–°" >
&lt;div>
&lt;a href="#2023-%e5%b9%b4-11-%e6%9c%88-16-%e6%97%a5%e6%9b%b4%e6%96%b0">
##
&lt;/a>
2023 å¹´ 11 æœˆ 16 æ—¥æ›´æ–°
&lt;/div>
&lt;/h3>
&lt;p>ICLR 2024 çš„ Rebuttal æœŸé—´ï¼Œåˆè¡¥äº† 840 ä¸ªå®éªŒ&amp;hellip;.&lt;/p>
&lt;h3 id="2024-å¹´-3-æœˆ-4-æ—¥æ›´æ–°" >
&lt;div>
&lt;a href="#2024-%e5%b9%b4-3-%e6%9c%88-4-%e6%97%a5%e6%9b%b4%e6%96%b0">
##
&lt;/a>
2024 å¹´ 3 æœˆ 4 æ—¥æ›´æ–°
&lt;/div>
&lt;/h3>
&lt;p>ICLR 2024 ä¸­ç¨¿äº†ï¼æ¬¢è¿å¤§å®¶å‚è§‚æˆ‘ä»¬çš„&lt;a href="https://openreview.net/forum?id=glwwbaeKm2">è®ºæ–‡&lt;/a>ã€&lt;a href="https://vertibench.xtra.science/">ç½‘ç«™&lt;/a> å’Œ &lt;a href="https://github.com/Xtra-Computing/VertiBench">GitHub&lt;/a>&lt;/p></description></item><item><title>ä¸€ä¸ªæ ‡æ³¨åè¯çš„æ–¹å¼</title><link>/posts/a-writing-trick/</link><pubDate>Fri, 17 Dec 2021 21:13:48 +0800</pubDate><author>junyi.h@comp.nus.edu.sg (Junyi Hou)</author><guid>/posts/a-writing-trick/</guid><description>&lt;p>åœ¨å†™æŠ€æœ¯åšå®¢çš„æ—¶å€™ï¼Œéš¾å…ä¼šå†™åˆ°ä¸€äº›å•è¯çš„ä¸­æ–‡ç‰ˆæœ¬ï¼Œä¸ºäº†é˜²æ­¢æ­§ä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ &lt;code>&amp;lt;ruby&amp;gt;&lt;/code> æ ‡ç­¾æŠŠåŸå§‹å•è¯æ ‡æ³¨å‡ºæ¥&lt;/p>
&lt;p>ä¸‹é¢æ˜¯ä¸€äº›ä¾‹å­ï¼š&lt;/p>
&lt;blockquote>
&lt;p>è¿‘äº›å¹´æ¥ï¼Œ&lt;ruby>å®¹å™¨&lt;rt>Container&lt;/rt>&lt;/ruby>æŠ€æœ¯æå¤§åœ°é™ä½äº†æœåŠ¡çš„éƒ¨ç½²æˆæœ¬&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡&lt;ruby>å®šæ—¶ä»»åŠ¡&lt;rt>cron job&lt;/rt>&lt;/ruby>åŠŸèƒ½è¿›è¡Œç³»ç»Ÿç®¡ç†&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>è‹¹æœçš„&lt;ruby>éš”ç©ºæŠ•é€&lt;rt>AirDrop&lt;/rt>&lt;/ruby>å¹¶æ²¡æœ‰é‚£ä¹ˆå¯é ï¼Œä¸¢å¤±æ–‡ä»¶çš„æƒ…å†µç»å¸¸å‘ç”Ÿ&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-html" data-lang="html">&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1&lt;/span>&lt;span>è¿‘äº›å¹´æ¥ï¼Œ&amp;lt;&lt;span style="color:#ff6ac1">ruby&lt;/span>&amp;gt;å®¹å™¨&amp;lt;&lt;span style="color:#ff6ac1">rt&lt;/span>&amp;gt;Container&amp;lt;/&lt;span style="color:#ff6ac1">rt&lt;/span>&amp;gt;&amp;lt;/&lt;span style="color:#ff6ac1">ruby&lt;/span>&amp;gt;æŠ€æœ¯æå¤§åœ°é™ä½äº†æœåŠ¡çš„éƒ¨ç½²æˆæœ¬
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2&lt;/span>&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3&lt;/span>&lt;span>åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡&amp;lt;&lt;span style="color:#ff6ac1">ruby&lt;/span>&amp;gt;å®šæ—¶ä»»åŠ¡&amp;lt;&lt;span style="color:#ff6ac1">rt&lt;/span>&amp;gt;cron job&amp;lt;/&lt;span style="color:#ff6ac1">rt&lt;/span>&amp;gt;&amp;lt;/&lt;span style="color:#ff6ac1">ruby&lt;/span>&amp;gt;åŠŸèƒ½è¿›è¡Œç³»ç»Ÿç®¡ç†
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4&lt;/span>&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5&lt;/span>&lt;span>è‹¹æœçš„&amp;lt;&lt;span style="color:#ff6ac1">ruby&lt;/span>&amp;gt;éš”ç©ºæŠ•é€&amp;lt;&lt;span style="color:#ff6ac1">rt&lt;/span>&amp;gt;AirDrop&amp;lt;/&lt;span style="color:#ff6ac1">rt&lt;/span>&amp;gt;&amp;lt;/&lt;span style="color:#ff6ac1">ruby&lt;/span>&amp;gt;å¹¶æ²¡æœ‰é‚£ä¹ˆå¯é ï¼Œä¸¢å¤±æ–‡ä»¶çš„æƒ…å†µç»å¸¸å‘ç”Ÿ
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>FEC - å‰å‘çº é”™æŠ€æœ¯</title><link>/posts/fec/</link><pubDate>Tue, 04 Aug 2020 15:19:38 +0800</pubDate><author>junyi.h@comp.nus.edu.sg (Junyi Hou)</author><guid>/posts/fec/</guid><description>&lt;p>FECï¼šForward Error Correctionï¼Œå‰å‘çº é”™&lt;/p>
&lt;blockquote>
&lt;p>FEC æ˜¯ä¸€ç§é€šè¿‡åœ¨ç½‘ç»œä¼ è¾“ä¸­å¢åŠ æ•°æ®åŒ…çš„å†—ä½™ä¿¡æ¯ï¼Œä½¿å¾—æ¥æ”¶ç«¯èƒ½å¤Ÿåœ¨ç½‘ç»œå‘ç”Ÿä¸¢åŒ…ååˆ©ç”¨è¿™äº›å†—ä½™ä¿¡æ¯ç›´æ¥æ¢å¤å‡ºä¸¢å¤±çš„æ•°æ®åŒ…çš„ä¸€ç§æ–¹æ³•ã€‚
&lt;a href="https://zhuanlan.zhihu.com/p/104579290">https://zhuanlan.zhihu.com/p/104579290&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;h1 id="parity-check-å¥‡å¶æ ¡éªŒ" >
&lt;div>
&lt;a href="#parity-check-%e5%a5%87%e5%81%b6%e6%a0%a1%e9%aa%8c">
##
&lt;/a>
Parity Check å¥‡å¶æ ¡éªŒ
&lt;/div>
&lt;/h1>
&lt;pre tabindex="0">&lt;code>// ä¾‹å¦‚ï¼šæ±‚ 10100001 ä¸­ 1 çš„æ•°é‡æ˜¯å¥‡æ•°è¿˜æ˜¯å¶æ•°
// ç»“æœä¸º 1 å°±æ˜¯å¥‡æ•°ä¸ª 1ï¼Œç»“æœä¸º 0 å°±æ˜¯å¶æ•°ä¸ª 1
1 ^ 0 ^ 1 ^ 0 ^ 0 ^ 0 ^ 0 ^ 1 = 1
&lt;/code>&lt;/pre>&lt;p>æ¯ä¸ªå­—èŠ‚çš„æ•°æ®éƒ½è®¡ç®—ä¸€ä¸ªæ ¡éªŒä½ï¼Œæ•°æ®å’Œæ ¡éªŒä½ä¸€èµ·å‘é€å‡ºå»ï¼Œè¿™æ ·æ¥æ”¶æ–¹å¯ä»¥æ ¹æ®æ ¡éªŒä½ç²—ç•¥åœ°åˆ¤æ–­æ¥æ”¶åˆ°çš„æ•°æ®æ˜¯å¦æœ‰è¯¯ã€‚&lt;/p>
&lt;h1 id="åŸºäº-xor-çš„-fec" >
&lt;div>
&lt;a href="#%e5%9f%ba%e4%ba%8e-xor-%e7%9a%84-fec">
##
&lt;/a>
åŸºäº XOR çš„ FEC
&lt;/div>
&lt;/h1>
&lt;p>å‡è®¾ç½‘ç»œé€šä¿¡æœ‰ N ä¸ª packet éœ€è¦å‘é€ï¼Œé‚£ä¹ˆå¯ä»¥æ¯ 2 ä¸ª packet ç”Ÿæˆä¸€ä¸ª FEC packetï¼Œè¿™æ ·ï¼Œè¿ç»­çš„ 3 ä¸ª packet çš„ä»»æ„ä¸€ä¸ª packet ä¸¢å¤±ï¼Œéƒ½èƒ½é€šè¿‡å¦å¤– 2 ä¸ªæ¢å¤å‡ºæ¥ã€‚&lt;/p>
&lt;p>ä½†è€ƒè™‘åˆ°æ¯ 2 ä¸ª packet å°±äº§ç”Ÿ 1 ä¸ª fec packetï¼Œå†—ä½™åº¦å¯èƒ½æœ‰ç‚¹é«˜ï¼ˆæ¯”è¾ƒæµªè´¹å¸¦å®½ï¼‰ï¼Œæˆ‘ä»¬èƒ½å¦æ¯ 3 ä¸ªæˆ–è€…æ¯ N ä¸ª packet å†äº§ç”Ÿä¸€ä¸ª fec packet å‘¢ï¼Ÿå½“ç„¶å¯ä»¥ï¼Œæˆ‘ä»¬ä»¥æ¯ 3 ä¸ª packetï¼ˆAã€Bã€Cï¼‰ äº§ç”Ÿ 1 ä¸ª fec packetï¼ˆDï¼‰ä¸ºä¾‹æ¥æ¨å¯¼ä¸€ä¸‹ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>d = a ^ b ^ c
a = a ^ (b ^ b) ^ (c ^ c) = (b ^ c) ^ (a ^ b ^ c) = b ^ c ^ d
b = (a ^ a) ^ b ^ (c ^ c) = (a ^ c) ^ (a ^ b ^ c) = a ^ c ^ d
c = (a ^ a) ^ (b ^ b) ^ c = (a ^ b) ^ (a ^ b ^ c) = a ^ b ^ d
&lt;/code>&lt;/pre>&lt;p>ç”±ä¸Šè¿°å…¬å¼æ¨å¯¼å³å¯çŸ¥é“ï¼Œè¿™ 4 ä¸ª packetï¼Œä»»æ„ä¸¢å¤± 1 ä¸ª packetï¼Œå‡å¯ä»¥ç”±å…¶ä»– 3 ä¸ª packet æ¢å¤å‡ºæ¥ã€‚&lt;/p>
&lt;h1 id="å¯¹è±¡å­˜å‚¨---ec-çº åˆ ç " >
&lt;div>
&lt;a href="#%e5%af%b9%e8%b1%a1%e5%ad%98%e5%82%a8---ec-%e7%ba%a0%e5%88%a0%e7%a0%81">
##
&lt;/a>
å¯¹è±¡å­˜å‚¨ - EC çº åˆ ç 
&lt;/div>
&lt;/h1>
&lt;p>é€šè¿‡ K ä¸ªæœ‰æ•ˆæ•°æ®ï¼Œäº§ç”Ÿ M ä¸ª FEC å†—ä½™åŒ…ï¼Œè¿™ K + M ä¸ªæ•°æ®ï¼Œä»»æ„ä¸¢å¤± M ä¸ªæ•°æ®ï¼Œéƒ½èƒ½æŠŠ K ä¸ªæœ‰æ•ˆæ•°æ®æ¢å¤å‡ºæ¥ã€‚&lt;/p>
&lt;h2 id="reed-solomon-codes" >
&lt;div>
&lt;a href="#reed-solomon-codes">
#
&lt;/a>
Reed-Solomon Codes
&lt;/div>
&lt;/h2>
&lt;h1 id="rfc-è‰æ¡ˆ-payload-flexible-fec" >
&lt;div>
&lt;a href="#rfc-%e8%8d%89%e6%a1%88-payload-flexible-fec">
##
&lt;/a>
RFC è‰æ¡ˆ Payload Flexible FEC
&lt;/div>
&lt;/h1>
&lt;h2 id="11-å¥‡å¶æ ¡éªŒç " >
&lt;div>
&lt;a href="#11-%e5%a5%87%e5%81%b6%e6%a0%a1%e9%aa%8c%e7%a0%81">
#
&lt;/a>
1.1 å¥‡å¶æ ¡éªŒç 
&lt;/div>
&lt;/h2>
&lt;h3 id="111-ä¸€ç»´-parity-fec-protection" >
&lt;div>
&lt;a href="#111-%e4%b8%80%e7%bb%b4-parity-fec-protection">
##
&lt;/a>
1.1.1 ä¸€ç»´ Parity FEC Protection
&lt;/div>
&lt;/h3>
&lt;p>éäº¤é”™ï¼ŒæŒ‰è¡Œç”Ÿæˆï¼Œä¸€è¡Œé‡Œä¸¢ä¸€ä¸ªåŒ…å¯ä»¥ï¼Œä¸¢ä¸¤ä¸ªå°±æ²¡æ³•æ¢å¤äº†ï¼ˆBurst Lossï¼‰&lt;/p>
&lt;p>ä¸€ç»´è¿ç»­ FEC ä¿æŠ¤&lt;/p>
&lt;pre tabindex="0">&lt;code>+---+ +---+ +===+
| 1 | X X | 4 | |R_1|
+---+ +---+ +===+
+---+ +---+ +---+ +---+ +===+
| 5 | | 6 | | 7 | | 8 | |R_2|
+---+ +---+ +---+ +---+ +===+
+---+ +---+ +---+ +---+ +===+
| 9 | | 10| | 11| | 12| |R_3|
+---+ +---+ +---+ +---+ +===+
&lt;/code>&lt;/pre>&lt;p>éäº¤é”™ï¼ŒæŒ‰åˆ—ç”Ÿæˆï¼Œä¸€åˆ—é‡Œä¸¢ä¸€ä¸ªåŒ…å¯ä»¥ï¼Œä¸¢ä¸¤ä¸ªå°±æ²¡æ³•æ¢å¤äº†ï¼ˆPeriodic Lossï¼‰&lt;/p>
&lt;p>ä¸€ç»´éš”è¡Œ FEC ä¿æŠ¤&lt;/p>
&lt;pre tabindex="0">&lt;code>+---+ +---+ +---+
| 1 | X | 3 | | 4 |
+---+ +---+ +---+
+---+ +---+ +---+
| 5 | X | 7 | | 8 |
+---+ +---+ +---+
+---+ +---+ +---+ +---+
| 9 | | 10| | 11| | 12|
+---+ +---+ +---+ +---+
+===+ +===+ +===+ +===+
|C_1| |C_2| |C_3| |C_4|
+===+ +===+ +===+ +===+
&lt;/code>&lt;/pre>&lt;h3 id="112-äºŒç»´-parity-fec-protection" >
&lt;div>
&lt;a href="#112-%e4%ba%8c%e7%bb%b4-parity-fec-protection">
##
&lt;/a>
1.1.2 äºŒç»´ Parity FEC Protection
&lt;/div>
&lt;/h3>
&lt;p>äº’è”ç½‘ä¸¢åŒ…æ˜¯éšæœºçš„ã€çˆ†å‘å¼çš„ï¼Œå‘é€ç«¯åº”è¯¥ç”Ÿæˆ non-interleaved å’Œ interleaved å‰é¡¹çº é”™åŒ…ï¼ˆFEC packetsï¼‰&lt;/p>
&lt;p>è¿™ç§ FEC ä¿æŠ¤è¢«ç§°ä½œ äºŒç»´å¥‡å¶æ ¡éªŒå‰å‘çº é”™ä¿æŠ¤&lt;/p>
&lt;p>ä½†æ˜¯å¦‚æœå‘ç”Ÿç‰¹å®šçš„ loss patternï¼Œè¿™ç§ä¿æŠ¤æ¨¡å¼ä¾ç„¶ä¼šå¤±æ•ˆï¼Œæ¯”å¦‚ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>+---+ +---+ +===+
| 1 | X X | 4 | |R_1|
+---+ +---+ +===+
+---+ +---+ +---+ +---+ +===+
| 5 | | 6 | | 7 | | 8 | |R_2|
+---+ +---+ +---+ +---+ +===+
+---+ +---+ +===+
| 9 | X X | 12| |R_3|
+---+ +---+ +===+
+===+ +===+ +===+ +===+
|C_1| |C_2| |C_3| |C_4|
+===+ +===+ +===+ +===+
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>+---+ +---+ +---+
| 1 | | 2 | X | 4 | X
+---+ +---+ +---+
+---+ +---+ +---+ +---+ +===+
| 5 | | 6 | | 7 | | 8 | |R_2|
+---+ +---+ +---+ +---+ +===+
+---+ +---+ +---+
| 9 | | 10| X | 12| X
+---+ +---+ +---+
+===+ +===+ +===+ +===+
|C_1| |C_2| |C_3| |C_4|
+===+ +===+ +===+ +===+
&lt;/code>&lt;/pre>&lt;h3 id="113-å¼€é”€è®¡ç®—-overhead-computation" >
&lt;div>
&lt;a href="#113-%e5%bc%80%e9%94%80%e8%ae%a1%e7%ae%97-overhead-computation">
##
&lt;/a>
1.1.3 å¼€é”€è®¡ç®— Overhead Computation
&lt;/div>
&lt;/h3>
&lt;p>å¼€é”€ï¼ˆoverheadï¼‰è¢«å®šä¹‰ä¸ºï¼š&lt;/p>
&lt;p>ä¿®å¤åŒ…å¤§å° / æºåŒ…å¤§å°&lt;/p>
&lt;p>å•ä½ï¼šBytes&lt;/p>
&lt;p>é€šå¸¸æ¥è¯´ï¼Œä¿®å¤åŒ…æ¯”æºåŒ…æ›´å¤§ã€‚&lt;/p>
&lt;p>å¦‚æœæˆ‘ä»¬å‡è®¾æ¯ä¸€ä¸ªä¿®å¤åŒ…æºå¸¦ä¸æºåŒ…ç­‰é‡çš„ bytesï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºæ¯ä¸€ä¸ªä¸åŒçš„ FEC ä¿æŠ¤ç­–ç•¥çš„å¼€é”€ï¼š&lt;/p>
&lt;p>ä¸€ç»´è¿ç»­ FEC ä¿æŠ¤ï¼šå¼€é”€ = 1/L&lt;/p>
&lt;p>ä¸€ç»´éš”è¡Œ FEC ä¿æŠ¤ï¼šå¼€é”€ = 1/D&lt;/p>
&lt;p>äºŒç»´ FEC ä¿æŠ¤ï¼šå¼€é”€ = 1/L + 1/D&lt;/p>
&lt;p>where L and D are the number of columns and rows in the source block, respectively.&lt;/p>
&lt;h1 id="3-å®šä¹‰" >
&lt;div>
&lt;a href="#3-%e5%ae%9a%e4%b9%89">
##
&lt;/a>
3. å®šä¹‰
&lt;/div>
&lt;/h1>
&lt;p>Lï¼šè¡¨ç¤ºåˆ—&lt;/p>
&lt;p>Dï¼šè¡¨ç¤ºè¡Œ&lt;/p>
&lt;p>bitmaskï¼šç”± FEC åŒ…ä¿æŠ¤çš„åŒ…çš„è¿è¡Œé•¿åº¦ç¼–ç ã€‚å¦‚æœæ©ç ä¸­çš„ä½ i è¢«è®¾ç½®ä¸º 1ï¼Œæºæ•°æ®åŒ…çš„ç¼–å· N + i è¢«è¿™ä¸ª FEC åŒ…ä¿æŠ¤ã€‚è¿™é‡Œï¼ŒN æ˜¯æ•°åŸºæ•°ï¼ŒFEC åŒ…ä¸­ä¹Ÿæœ‰è¡¨ç¤ºã€‚&lt;/p>
&lt;h1 id="4-åŒ…æ ¼å¼" >
&lt;div>
&lt;a href="#4-%e5%8c%85%e6%a0%bc%e5%bc%8f">
##
&lt;/a>
4. åŒ…æ ¼å¼
&lt;/div>
&lt;/h1>
&lt;p>è¿™ä¸€å°èŠ‚å®šä¹‰äº†æºåŒ…å’Œä¿®å¤åŒ…çš„æ ¼å¼&lt;/p>
&lt;h2 id="41-æºåŒ…" >
&lt;div>
&lt;a href="#41-%e6%ba%90%e5%8c%85">
#
&lt;/a>
4.1 æºåŒ…
&lt;/div>
&lt;/h2>
&lt;h2 id="42-ä¿®å¤åŒ…" >
&lt;div>
&lt;a href="#42-%e4%bf%ae%e5%a4%8d%e5%8c%85">
#
&lt;/a>
4.2 ä¿®å¤åŒ…
&lt;/div>
&lt;/h2>
&lt;p>ä¿®å¤åŒ…å¿…é¡»åŒ…å«æ ‡è¯†å®ƒä»¬æ‰€å±çš„æºå—çš„ä¿¡æ¯ï¼Œä»¥åŠåŒ…å«çš„ä¿®å¤ç¬¦å·ä¸åŸå§‹æºå—ä¹‹é—´çš„å…³ç³»ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¿®å¤åŒ…çš„ RTP æŠ¥å¤´ä»¥åŠ RTP æœ‰æ•ˆè´Ÿè½½ä¸­çš„å¦ä¸€ä¸ªæŠ¥å¤´ï¼Œæˆ‘ä»¬å°†å…¶ç§°ä¸º FEC æŠ¥å¤´ï¼Œå¦‚å›¾ 9 æ‰€ç¤ºã€‚&lt;/p>
&lt;p>ï¼ˆæ³¨æ„ï¼Œå—ç‰¹å®š FEC åŒ…ä¿æŠ¤çš„æ‰€æœ‰æºæµåŒ…éƒ½éœ€è¦åœ¨åŒä¸€ä¸ª RTP ä¼šè¯ä¸­ã€‚ï¼‰&lt;/p>
&lt;pre tabindex="0">&lt;code>+------------------------------+
| IP Header |
+------------------------------+
| Transport Header |
+------------------------------+
| RTP Header | __
+------------------------------+ |
| FEC Header | \
+------------------------------+ &amp;gt; RTP Payload
| Repair Symbols | /
+------------------------------+ __|
&lt;/code>&lt;/pre>&lt;p>Marker (M) Bit: åº”è¯¥è¢«è®¾ç½®æˆ 0&lt;/p>
&lt;pre tabindex="0">&lt;code> 0 1 2 3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|R|F| P|X| CC |M| PT recovery | length recovery |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| TS recovery |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SSRCCount | reserved |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SSRC_i |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SN base_i |k| Mask [0-14] |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|k| Mask [15-45] (optional) |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|k| |
+-+ Mask [46-108] (optional) |
| |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| ... next in SSRC_i ... |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/code>&lt;/pre>&lt;h1 id="8-æ‹¥å¡æ§åˆ¶è€ƒè™‘" >
&lt;div>
&lt;a href="#8-%e6%8b%a5%e5%a1%9e%e6%8e%a7%e5%88%b6%e8%80%83%e8%99%91">
##
&lt;/a>
8. æ‹¥å¡æ§åˆ¶è€ƒè™‘
&lt;/div>
&lt;/h1>
&lt;p>in networks where the congestion is a major contributor to the packet loss, the potential impacts of using FEC SHOULD be considered carefully before injecting the repair flows into the network.&lt;/p>
&lt;p>In particular, in bandwidth-limited networks, FEC repair flows may consume most or all of the available bandwidth and consequently may congest the network. In such cases, the applications MUST NOT arbitrarily increase the amount of FEC protection since doing so may lead to a congestion collapse. If desired, stronger FEC protection MAY be applied only after the source rate has been reduced.&lt;/p>
&lt;h1 id="9-å®‰å…¨æ€§è€ƒè™‘" >
&lt;div>
&lt;a href="#9-%e5%ae%89%e5%85%a8%e6%80%a7%e8%80%83%e8%99%91">
##
&lt;/a>
9. å®‰å…¨æ€§è€ƒè™‘
&lt;/div>
&lt;/h1></description></item><item><title>RFC8627 - Payload Flexible FEC</title><link>/posts/rfc8627-payload-flex-fec/</link><pubDate>Sun, 02 Aug 2020 11:08:57 +0800</pubDate><author>junyi.h@comp.nus.edu.sg (Junyi Hou)</author><guid>/posts/rfc8627-payload-flex-fec/</guid><description>&lt;p>FEC è¿˜è›®æœ‰æ„æ€çš„ï¼Œè¿™ç¯‡ç¿»è¯‘çš„å†…å®¹æ˜¯ Payload Flexible FEC çš„ RFC ç»†èŠ‚
ï¼ˆå‘•å¿ƒæ²¥è¡€çš„ç¿»è¯‘ï¼‰&lt;/p>
&lt;h1 id="4-packet-formats-åŒ…æ ¼å¼" >
&lt;div>
&lt;a href="#4-packet-formats-%e5%8c%85%e6%a0%bc%e5%bc%8f">
##
&lt;/a>
4. Packet Formats åŒ…æ ¼å¼
&lt;/div>
&lt;/h1>
&lt;p>è¿™ä¸€èŠ‚å®šä¹‰äº†æºåŒ…å’Œä¿®å¤åŒ…çš„æ ¼å¼&lt;/p>
&lt;h2 id="41-source-packets-æºåŒ…" >
&lt;div>
&lt;a href="#41-source-packets-%e6%ba%90%e5%8c%85">
#
&lt;/a>
4.1. Source Packets æºåŒ…
&lt;/div>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>The source packets MUST contain the information that identifies the
source block and the position within the source block occupied by the
packet. Since the source packets that are carried within an RTP
stream already contain unique sequence numbers in their RTP headers
[RFC3550], we can identify the source packets in a straightforward
manner and there is no need to append additional field(s). The
primary advantage of not modifying the source packets in any way is
that it provides backward compatibility for the receivers that do not
support FEC at all. In multicast scenarios, this backward
compatibility becomes quite useful as it allows the non-FEC-capable
and FEC-capable receivers to receive and interpret the same source
packets sent in the same multicast session.
&lt;/code>&lt;/pre>&lt;h2 id="42-repair-packets-ä¿®å¤åŒ…" >
&lt;div>
&lt;a href="#42-repair-packets-%e4%bf%ae%e5%a4%8d%e5%8c%85">
#
&lt;/a>
4.2. Repair Packets ä¿®å¤åŒ…
&lt;/div>
&lt;/h2>
&lt;p>ä¿®å¤åŒ…ä¸­å¿…é¡»æœ‰èƒ½å¤ŸåŒºåˆ† source block they pertain to å’Œ the relationship between the contained repair symbols and the original source block.&lt;/p>
&lt;p>é’ˆå¯¹è¿™ä¸ªè¦æ±‚ï¼Œä¿®å¤åŒ…ä½¿ç”¨ RTP çš„å¤´ï¼Œä»¥åŠ RTP è½½è·ä¸­çš„å¦ä¸€ä¸ªå¤´ï¼Œæˆ‘ä»¬æŠŠå®ƒå«åš FEC å¤´ï¼Œå…·ä½“è¯·çœ‹ Figure 9&lt;/p>
&lt;pre tabindex="0">&lt;code>+------------------------------+
| IP Header |
+------------------------------+
| Transport Header |
+------------------------------+
| RTP Header | __
+------------------------------+ |
| FEC Header | \
+------------------------------+ &amp;gt; RTP Payload
| Repair Symbols | /
+------------------------------+ __|
Figure 9: Format of repair packets
&lt;/code>&lt;/pre>&lt;p>æ³¨æ„ï¼Œè¢« FEC ä¿æŠ¤çš„æ‰€æœ‰ åŒ…ï¼Œå¿…é¡»åœ¨åŒä¸€ä¸ª RTP session é‡Œ&lt;/p>
&lt;p>RTP çš„å¤´éƒ¨æ ¹æ® RFC3550 æ‰€å®šä¹‰ï¼Œæ·»åŠ äº†è¿›ä¸€æ­¥çš„ clarificationsï¼š&lt;/p>
&lt;ul>
&lt;li>Marker (M) Bitï¼šè¿™ä¸ª bit ä¸æ˜¯ç»™è¿™ä¸ª payload type ç”¨çš„ï¼Œæ‰€ä»¥åº”è¯¥è¢«è®¾ç½®æˆ 0&lt;/li>
&lt;li>Payload Typeï¼šä¿®å¤åŒ…çš„ (åŠ¨æ€) è½½è·ç±»å‹ç”±å¸¦å¤–æ–¹å¼ç¡®å®šã€‚æ ¹æ® RFC3550 ä¸­çš„å®šä¹‰ï¼ŒRTP æ¥å—è€…æ”¶åˆ°ä¸èƒ½è¯†åˆ«çš„ PayloadType åŒ…æ—¶ï¼Œä¼šå°†æ•´ä¸ªåŒ…ä¸¢æ‰ã€‚è¿™ä¸ªç‰¹ç‚¹æä¾›äº†åå‘å…¼å®¹æ€§ã€‚å¦‚æœä¸€ä¸ªä¸æ”¯æŒ FEC çš„æ¥å—è€…æ”¶åˆ°äº†ä¿®å¤åŒ…ï¼Œå®ƒå°†ä¸èƒ½è¯†åˆ«ä¿®å¤åŒ…çš„ payload typeï¼Œä»è€Œä¸¢æ‰ä¿®å¤åŒ…&lt;/li>
&lt;li>Sequence Numberï¼ˆSNï¼‰ï¼šåºåˆ—å·æœ‰ä¸€ä¸ªæ ‡å‡†çš„å®šä¹‰ï¼Œå®ƒçš„å€¼å¿…é¡»å¤§äºä¸Šæ¬¡ä¼ è¾“ä¿®å¤åŒ…æ‰€ç”¨çš„å€¼ã€‚åˆå§‹å€¼åº”è¯¥æ˜¯éšæœºç”Ÿæˆçš„ï¼ˆä¸å¯é¢„æµ‹çš„ï¼‰&lt;/li>
&lt;li>Timestampï¼ˆTSï¼‰ï¼šæ˜¯å«æˆ³åº”è¯¥è¢«è®¾ç½®æˆä¿®å¤åŒ…è¢«ä¼ è¾“æ—¶çš„æ—¶é—´ã€‚è¿™ä¸ªæ—¶é—´æˆ³ä¸æ˜¯ç”¨æ¥ç»™ FEC åšçº é”™ç”¨çš„ï¼Œé€šå¸¸æ˜¯ç»™ jitter calculation ç”¨çš„ã€‚&lt;/li>
&lt;li>Synchronization Sourceï¼ˆSSRCï¼‰ï¼šæ ¹æ® RFC3550ï¼Œè¿™ä¸ª SSRC å€¼åº”è¯¥è¢«éšæœºåˆ†é…ã€‚è¿™å…è®¸å‘é€è€…åœ¨åŒä¸€ä¸ªç«¯å£å¤ç”¨æºåŒ…å’Œä¿®å¤åŒ…ï¼Œæˆ–è€…åœ¨åŒä¸€ç«¯å£å¤ç”¨å¤šä¸ªä¿®å¤åŒ…ã€‚&lt;strong>ä¿®å¤æµ&lt;/strong> SHOULD ä½¿ç”¨ RTCP CNAME å­—æ®µæŠŠè‡ªå·±è·Ÿ&lt;strong>æºæµ&lt;/strong>å…³è”ã€‚åœ¨ä¸€äº›ç½‘ç»œé‡Œï¼ŒåŒæ—¶äº§ç”ŸæºåŒ…å’Œä¿®å¤åŒ…çš„ RTP æºå¯èƒ½ä¸æ˜¯åŒä¸€ä¸ªä¸»æœºã€‚åœ¨è¿™ä¸ªåœºæ™¯é‡Œï¼Œç»™æºæµå’Œä¿®å¤æµä½¿ç”¨åŒæ ·çš„ CNAME æ„å‘³ç€ RTP æºå’Œ FEC æºå¿…é¡»å…±äº«åŒä¸€ä¸ª CNAMEã€‚åŸºäºä¸€ä¸ªå·²çŸ¥çš„ç®—æ³•å’Œ RTPã€FEC æºï¼Œä¸€ä¸ªå…¬å…±çš„ CNAME å¯èƒ½è¢«äº§ç”Ÿï¼ˆRFC7022ï¼‰ã€‚è¿™ä¸ªç”¨æ³•ç¬¦åˆ RFC3550 ä¸­çš„å®šä¹‰ã€‚
&lt;span style="color: red;">&lt;b>æ³¨æ„ï¼Œç”±äºæ˜¯éšæœºåˆ†é… SSRCï¼Œè¿™é‡Œæœ‰å¯èƒ½ä¼šé€ æˆ SSRC å†²çªã€‚å‘ç”Ÿå†²çªæ—¶ï¼Œå¿…é¡»æŒ‰ç…§ RFC3550 ä¸­çš„å®šä¹‰å»è§£å†³å†²çªã€‚&lt;/b>&lt;/span>&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code> 0 1 2 3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|R|F| P|X| CC |M| PT recovery | length recovery |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| TS recovery |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SSRCCount | reserved |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SSRC_i |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SN base_i |k| Mask [0-14] |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|k| Mask [15-45] (optional) |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|k| |
+-+ Mask [46-108] (optional) |
| |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| ... next in SSRC_i ... |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Figure 10: Format of the FEC header
&lt;/code>&lt;/pre>&lt;p>FEC å¤´éƒ¨åŒ…å«ä»¥ä¸‹å­—æ®µï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>R bit å»è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªé‡ä¼ åŒ…çš„è¯å¿…é¡»è®¾ç½®æˆ 1ï¼Œ&lt;strong>å¯¹äºä¿®å¤åŒ…å¿…é¡»è®¾ç½®æˆ&lt;/strong> 0&lt;/p>
&lt;/li>
&lt;li>
&lt;p>F å­—æ®µè¡¨ç¤º mask çš„ç±»å‹ï¼š&lt;/p>
&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>+---------------+-------------------------------------+
| F bit | Use |
+---------------+-------------------------------------+
| 0 | flexible mask |
| 1 | packets indicated by offset M and N |
+---------------+-------------------------------------+
Figure 11: F-bit values
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>
&lt;p>P, X, CC, M å’Œ PT recovery å­—æ®µç”¨æˆ·ç¡®å®šè¢«æ¢å¤åŒ…çš„å­—æ®µ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Length Recovery ï¼ˆ16-bitï¼‰å­—æ®µè¢«ç”¨æ¥ç¡®å®šæ¢å¤åŒ…çš„é•¿åº¦&lt;/p>
&lt;/li>
&lt;li>
&lt;p>TS recoveryï¼ˆ32-bitï¼‰å­—æ®µè¢«ç”¨æ¥ç¡®å®šæ¢å¤åŒ…çš„æ—¶é—´æˆ³&lt;/p>
&lt;/li>
&lt;li>
&lt;p>SSRC countï¼ˆ8-bitï¼‰å­—æ®µæè¿°äº† FEC åŒ…ä¿æŠ¤çš„ SSRC çš„æ•°é‡ã€‚0 ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆå€¼ï¼Œå¹¶ä¸”è¿™ä¸ªåŒ… MUST è¢«å¿½ç•¥ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Reservedï¼ˆ24-bitï¼‰ä¸ºäº†æœªæ¥çš„ç”¨é€”è€Œè¢«ä¿ç•™ã€‚å®ƒ MUST è¢«å‘é€è€…è®¾ç½®æˆ 0ï¼Œå¹¶ä¸”è¢«æ¥å—è€…å¿½ç•¥&lt;/p>
&lt;/li>
&lt;li>
&lt;p>SSRC_iï¼ˆ32-bitï¼‰å­—æ®µæè¿°äº†å½“å‰è¿™ä¸ªç‰¹å®šçš„ FEC åŒ…ä¿æŠ¤äº†å“ªä¸ª SSRCã€‚å¦‚æœ FEC åŒ…ä¿æŠ¤äº†å¤šä¸ª SSRCï¼ˆSSRC count &amp;gt; 1ï¼‰ï¼Œé‚£ä¹ˆè¿™é‡Œå°†ä¼šæœ‰å¤šä¸ª blocks of data åŒ…å« SSRC, SN base å’Œ Mask Fields.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>SN base_iï¼ˆ16-bitï¼‰å­—æ®µè¡¨ç¤ºæ­¤ä¿®å¤åŒ…ä¿æŠ¤çš„ç‰¹å®š SSRCï¼ˆåœ¨ SSRC_i ä¸­æŒ‡ç¤ºï¼‰çš„æºåŒ…çš„æœ€ä½åºå·ï¼ˆè€ƒè™‘åˆ°å›ç»•ï¼‰ã€è¯‘è€…ï¼šæˆ‘ä¸çŸ¥é“ä»€ä¹ˆæ˜¯å›ç»• wrap around into accountã€‘&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¦‚æœ F bit è¢«è®¾ç½®æˆ 0ï¼Œåˆ™è¡¨ç¤ºè¿™ä¸ªç‰¹å®šçš„ä¿®å¤åŒ…æ‰€ä¿æŠ¤çš„æºåŒ…çš„æ‰€æœ‰ SSRC ä½¿ç”¨ flexible bitmask æ¥å¤„ç†ã€‚å¯¹äºä¸€ä¸ªè¢« FEC ä¿æŠ¤çš„ç‰¹å®šçš„ SSRC_i åŒ…ï¼Œmask æ˜¯ä¸€ä¸ªæ¸¸ç¨‹ç¼–ç ï¼ˆrun-length encodingï¼‰ã€‚ç¬¬ j ä½è®¾ç½®æˆ 1 è¡¨ç¤º æºåŒ…çš„åºåˆ—å·ï¼ˆSN base_i + j + 1ï¼‰è¢«è¿™ä¸ª FEC åŒ…æ‰€ä¿æŠ¤ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>bitmask ä¸­çš„ k-bit è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª 15-,46 - æˆ– 109-bitmaskã€‚k=0 è¡¨ç¤ºè¿™é‡Œæœ‰ä¸€ä¸ªä»¥ä¸Šçš„ k-bit setï¼Œk=1 è¡¨ç¤ºè¿™æ˜¯ bit mask ä¸­æœ€åä¸€ä¸ª blockã€‚å½“è§£æä¸€ä¸ªå¤´çš„æ—¶å€™ï¼Œå½“å‰çš„ k-bit æ•°é‡å†³å®šäº† bit mask v çš„å¤§å°ï¼š&lt;/p>
&lt;/li>
&lt;li>
&lt;p>$$&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>size_of_next_bitmast = 2^{count(k)+3}-1
$$&lt;/p>
&lt;pre tabindex="0">&lt;code> 0 1 2 3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|0| P|X| CC |M| PT recovery | length recovery |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| TS recovery |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SSRCCount | reserved |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SSRC_i |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SN base_i |k| Mask [0-14] |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|k| Mask [15-45] (optional) |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|k| |
+-+ Mask [46-108] (optional)
|
| |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| ... next in SSRC_i ... |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Figure 12: Protocol format for F=0
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>å¦‚æœ F-bit è¢«è®¾ç½®æˆ 1ï¼Œå®ƒè¡¨ç¤ºè¢«è¿™ä¸ªç‰¹å®šä¿®å¤åŒ…æ‰€ä¿æŠ¤çš„æºåŒ…ä¸­çš„æ‰€æœ‰ SSRC ä½¿ç”¨å›ºå®š offset&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code> 0 1 2 3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|0| P|X| CC |M| PT recovery | length recovery |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| TS recovery |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SSRCCount | reserved |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SSRC_i |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SN base_i | M (columns) | N (rows) |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Figure 13: Protocol format for F=1
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>Consequently, the following conditions occur for M and N values:
If M&amp;gt;0, N=0, is Row FEC, and no column FEC will follow
Hence, FEC = SN, SN+1, SN+2, ... , SN+(M-1), SN+M.
If M&amp;gt;0, N=1, is Row FEC, and column FEC will follow.
Hence, FEC = SN, SN+1, SN+2, ... , SN+(M-1), SN+M.
and more to come
If M&amp;gt;0, N&amp;gt;1, indicates column FEC of every M packet
in a group of N packets starting at SN base.
Hence, FEC = SN+(Mx0), SN+(Mx1), ... , SN+(MxN).
Figure 14: Interpreting the M and N field values
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>é€šè¿‡è®¾ç½® R ä¸º 1ï¼ŒF ä¸º 1ï¼Œè¿™ä¸ª FEC å°±åªä¿æŠ¤ä¸€ä¸ªåŒ…äº†ã€‚æ¯”å¦‚ï¼ŒSN Base_i è¡¨ç¤ºäº† FEC è½½è·æ‰¿è½½ç€çš„åŒ…ï¼Œè¿™æ˜¯ä¸€ç§éå¸¸æœ‰æ•ˆçš„é‡ä¼ åŒ…çš„æ–¹æ³•ã€‚ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œè§£æè¿™ç§åŒ…éå¸¸ç‰¹åˆ«ã€‚åºåˆ—å·ï¼ˆSN base_iï¼‰æ›¿ä»£äº† FEC åŒ…ä¸­ length recovery å­—æ®µã€‚SSRC_count åº”è¯¥ä¸º 1ï¼ŒM å’Œ N åº”è¯¥ä¸º 0ï¼Œå¹¶ä¸” FEC å¤´çš„ reserved bits ä¹Ÿä¸å¤å­˜åœ¨ã€‚é€šè¿‡è¿™ä¸ªæ–¹æ³•æˆ‘ä»¬å¯ä»¥çœä¸‹ 64 bitsã€‚&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code> 0 1 2 3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|1| P|X| CC |M| PT recovery | sequence number |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| timestamp |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SSRC |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Retransmission |
: payload :
| |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Figure 15: Protocol format for Retransmission
&lt;/code>&lt;/pre>&lt;p>åœ¨ Section 6.2 é‡Œæè¿°äº†è®¾ç½®è¿™äº›å­—æ®µçš„ç»†èŠ‚&lt;/p>
&lt;p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œmask-based çš„æ–¹æ³•ï¼ˆä¸ RFC2733 å’Œ RFC5109 ä¸­å¾ˆç›¸ä¼¼ï¼‰å¯èƒ½ä¸æ˜¯éå¸¸æœ‰æ•ˆçš„æŒ‡æ˜åœ¨å½“å‰ source block ä¸­ä¿®å¤åŒ…ä¸å“ªä¸ªæºåŒ…å…³è”ã€‚ç‰¹åˆ«çš„æ˜¯ï¼Œå¯¹äºæƒ³ä½¿ç”¨ large source block size çš„åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œæè¿°æºåŒ… - ä¿®å¤åŒ… çš„è¿™ä¸ªå…³è”ï¼Œæ‰€éœ€çš„ mask å¯èƒ½å¤§çš„ä»¤äººéš¾ä»¥æ¥å—ã€‚&lt;/p>
&lt;p>[SMPTE2022-1] ä¸­æå‡ºçš„ 8 ä½å­—æ®µæŒ‡ç¤ºä¸€ç§ç³»ç»ŸåŒ–çš„æ–¹æ³•ã€‚ ç›¸åï¼Œæœ¬æ–‡æ¡£ä¸­çš„æ–¹æ³•ä½¿ç”¨ 8 ä½å­—æ®µæŒ‡ç¤ºå— FEC æ•°æ®åŒ…ä¿æŠ¤çš„æ•°æ®åŒ…åç§»é‡ã€‚ [SMPTE2022-1] ä¸­çš„æ–¹æ³•æœ¬è´¨ä¸Šå¯¹äºå¸¸è§„æ¨¡å¼æ›´æœ‰æ•ˆï¼Œä½†ä¸èƒ½æä¾›è¡¨ç¤ºå…¶ä»–ä¿æŠ¤æ¨¡å¼çš„çµæ´»æ€§ï¼ˆæ¯”å¦‚ï¼šstaircaseï¼‰&lt;/p>
&lt;h1 id="5-payload-format-parameters-è½½è·æ ¼å¼å‚æ•°" >
&lt;div>
&lt;a href="#5-payload-format-parameters-%e8%bd%bd%e8%8d%b7%e6%a0%bc%e5%bc%8f%e5%8f%82%e6%95%b0">
##
&lt;/a>
5. Payload Format Parameters è½½è·æ ¼å¼å‚æ•°
&lt;/div>
&lt;/h1>
&lt;p>è¿™ä¸€ç« èŠ‚æä¾›äº†å¯¹äºéäº¤é”™å’Œäº¤é”™çš„å¥‡å¶ FEC çš„åª’ä½“å­ç±»å‹æ³¨å†Œã€‚è¿™ä¸€ç« ä¹Ÿé€šè¿‡è¿™äº›å‚æ•°é…ç½® FEC ç¼–ç å’Œè§£ç ã€‚å¦‚æœæ²¡æœ‰ç‰¹å®šçš„ FEC code è¢«å­ç±»å‹æ‰€æŒ‡æ˜ï¼Œé‚£ä¹ˆ FEC code é»˜è®¤æ˜¯è¿™ä¸€ç« é‡Œå®šä¹‰çš„å¥‡å¶ç ï¼ˆparity codeï¼‰ã€‚&lt;/p>
&lt;h2 id="51-media-type-registration---parity-codes-åª’ä½“ç±»å‹æ³¨å†Œ---å¥‡å¶ç " >
&lt;div>
&lt;a href="#51-media-type-registration---parity-codes-%e5%aa%92%e4%bd%93%e7%b1%bb%e5%9e%8b%e6%b3%a8%e5%86%8c---%e5%a5%87%e5%81%b6%e7%a0%81">
#
&lt;/a>
5.1. Media Type Registration - Parity Codes åª’ä½“ç±»å‹æ³¨å†Œ - å¥‡å¶ç 
&lt;/div>
&lt;/h2>
&lt;h2 id="52-mapping-to-sdp-parameters-åˆ°-sdp-å‚æ•°çš„æ˜ å°„" >
&lt;div>
&lt;a href="#52-mapping-to-sdp-parameters-%e5%88%b0-sdp-%e5%8f%82%e6%95%b0%e7%9a%84%e6%98%a0%e5%b0%84">
#
&lt;/a>
5.2. Mapping to SDP Parameters åˆ° SDP å‚æ•°çš„æ˜ å°„
&lt;/div>
&lt;/h2>
&lt;p>The mapping of the media type specification for â€œnon-interleaved-parityfecâ€ and â€œinterleaved-parityfecâ€ and their parameters in SDP is as follows:&lt;/p>
&lt;ul>
&lt;li>The media type (e.g., â€œapplicationâ€) goes into the â€œm=â€ line as the media name.&lt;/li>
&lt;li>The media subtype goes into the â€œa=rtpmapâ€ line as the encoding name. The RTP clock rate parameter (â€œrateâ€) also goes into the â€œa=rtpmapâ€ line as the clock rate.&lt;/li>
&lt;li>The remaining required payload-format-specific parameters go into the â€œa=fmtpâ€ line by copying them directly from the media type string as a semicolon-separated list of parameter=value pairs.&lt;/li>
&lt;/ul>
&lt;p>æœ‰å…³ SDP çš„ä¾‹å­è¯·çœ‹ Section 7.&lt;/p>
&lt;h3 id="521-offer-answer-model-considerations" >
&lt;div>
&lt;a href="#521-offer-answer-model-considerations">
##
&lt;/a>
5.2.1. Offer-Answer Model Considerations
&lt;/div>
&lt;/h3>
&lt;p>When offering 1-D interleaved parity FEC over RTP using SDP in an Offer/Answer model [RFC3264], the following considerations apply:&lt;/p>
&lt;ul>
&lt;li>ä¸åŒ L å’Œ D çš„ç»„åˆä¼šäº§ç”Ÿä¸åŒçš„ FEC æ•°æ®ï¼Œå¹¶ä¸”æ— æ³•ä¸å…¶å®ƒç»„åˆç›¸äº’ä½¿ç”¨ã€‚å‘é€è€…å¯èƒ½ä¼šæƒ³è¦æä¾›å¤šä¸ªæœ‰æ•ˆçš„ L å’Œ D çš„ç»„åˆä¾›æ¥æ”¶è€…ä½¿ç”¨ã€‚æ¥æ”¶è€… SHOULD æ­£å¸¸é€‰æ‹©æœ‰è¶³å¤Ÿçš„ interleaving çš„ offerã€‚å¦‚æœå¤šä¸ª offer å­˜åœ¨ï¼Œæ¥æ”¶è€…å¯èƒ½é€‰æ‹©æœ€ä½å¼€å°çš„æˆ–éœ€è¦æœ€å°ç¼“å†²åŒºçš„ offerã€‚å…·ä½“çš„é€‰æ‹©è·Ÿåœºæ™¯è¦æ±‚æœ‰å…³&lt;/li>
&lt;li>Repair-window çš„å€¼ä¾èµ–äº L å’Œ D çš„å€¼ï¼Œä¸èƒ½éšä¾¿å†™ã€‚æ›´å…·ä½“çš„æ¥è®²ï¼ŒL å’Œ D çš„å€¼å†³å®šäº† repair-window å¤§å°çš„ä¸‹é™ï¼ˆæœ€å°å€¼ï¼‰ã€‚repair-window çš„ä¸Šé™å¹¶ä¸ç”± L å’Œ D æ¥å†³å®šã€‚&lt;/li>
&lt;li>åœ¨ç›¸åŒçš„ L å’Œ D æ¡ä»¶ä¸‹ï¼Œå°±ç®— repair-window çš„å€¼ä¸åŒï¼Œä¹Ÿä¼šäº§ç”Ÿç›¸åŒçš„ FEC æ•°æ®ï¼Œä¸è¿‡ï¼Œä¸åŒçš„ repair-window å’Œ ç›¸åŒ L/D çš„ç»„åˆï¼Œä»ç„¶è¢«è§†ä½œä¸åŒçš„ offerã€‚repair-window ä¼šå½±å“åˆ°ä¼ è¾“æºåŒ…çš„æœ€å¤§å»¶è¿Ÿï¼Œå› ä¸ºç›´æ¥å½±å“åˆ°äº† receiver çš„ buffering çš„æ¡ä»¶ï¼Œæ‰€ä»¥åœ¨é€‰æ‹© offer çš„æ—¶å€™ receiver å¿…é¡»è€ƒè™‘å»¶è¿Ÿã€‚&lt;/li>
&lt;li>There are no optional format parameters defined for this payload. Any unknown option in the offer MUST be ignored and deleted from the answer. å¦‚æœå®¢æˆ·ç«¯ä¸æƒ³è¦ FECï¼Œé‚£ä¹ˆ answer é‡Œå°±ä¼šæŠŠ FEC å»æ‰&lt;/li>
&lt;/ul>
&lt;p>è¿™é‡Œè¯´çš„ offer æŒ‡çš„æ˜¯ Lã€D å’Œ repair-window çš„ç»„åˆ&lt;/p>
&lt;h3 id="522-declarative-considerations" >
&lt;div>
&lt;a href="#522-declarative-considerations">
##
&lt;/a>
5.2.2. Declarative Considerations
&lt;/div>
&lt;/h3>
&lt;p>In declarative usage, like SDP in the Real-time Streaming Protocol (RTSP) [RFC2326] or the Session Announcement Protocol (SAP) [RFC2974], the following considerations apply:&lt;/p>
&lt;ul>
&lt;li>è½½è·çš„æ ¼å¼é…ç½®å‚æ•°å…¨éƒ½æ˜¯å£°æ˜çš„ï¼Œå‚ä¸è€… MUST ä½¿ç”¨åœ¨ session ä¸­è¢«æä¾›çš„é…ç½®&lt;/li>
&lt;li>é€šè¿‡å£°æ˜å¤šä¸ª RTP è½½è·ç±»å‹ï¼Œä¸€ä¸ªä»¥ä¸Šçš„é…ç½®å¯èƒ½è¢«æä¾›ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œreceivers åº”å½“é€‰æ‹©ä¸€ä¸ªæœ€é€‚åˆçš„ repair flow&lt;/li>
&lt;/ul>
&lt;h1 id="6-protection-and-recovery-procedures---parity-codes-ä¿æŠ¤å’Œæ¢å¤è¿‡ç¨‹---å¥‡å¶ç " >
&lt;div>
&lt;a href="#6-protection-and-recovery-procedures---parity-codes-%e4%bf%9d%e6%8a%a4%e5%92%8c%e6%81%a2%e5%a4%8d%e8%bf%87%e7%a8%8b---%e5%a5%87%e5%81%b6%e7%a0%81">
##
&lt;/a>
6. Protection and Recovery Procedures - Parity Codes ä¿æŠ¤å’Œæ¢å¤è¿‡ç¨‹ - å¥‡å¶ç 
&lt;/div>
&lt;/h1>
&lt;p>è¿™ä¸€ç« æä¾›äº†å¯¹ 1-D å’Œ 2-D å¥‡å¶ç çš„å®Œæ•´å®šä¹‰å’Œå®ƒä»¬çš„ RTP è½½è·æ ¼å¼&lt;/p>
&lt;h2 id="61-overview-æ¦‚è§ˆ" >
&lt;div>
&lt;a href="#61-overview-%e6%a6%82%e8%a7%88">
#
&lt;/a>
6.1. Overview æ¦‚è§ˆ
&lt;/div>
&lt;/h2>
&lt;p>ä¸‹é¢çš„ç« èŠ‚è¯¦ç»†ä»‹ç»äº†ç”Ÿæˆä¿®å¤åŒ…ã€é€šè¿‡ä¿®å¤åŒ…é‡å»ºæºåŒ…çš„å…·ä½“æ­¥éª¤ã€‚&lt;/p>
&lt;h2 id="62-repair-packet-construction-ä¿®å¤åŒ…çš„æ„é€ " >
&lt;div>
&lt;a href="#62-repair-packet-construction-%e4%bf%ae%e5%a4%8d%e5%8c%85%e7%9a%84%e6%9e%84%e9%80%a0">
#
&lt;/a>
6.2. Repair Packet Construction ä¿®å¤åŒ…çš„æ„é€ 
&lt;/div>
&lt;/h2>
&lt;p>ä¿®å¤åŒ…çš„å¤´éƒ¨å·²ç»åœ¨ Section 4.2 æœ‰äº†è¯¦ç»†è¯´æ˜&lt;/p>
&lt;p>FEC çš„å¤´éƒ¨åŒ…å« 12 å­—èŠ‚ï¼ˆæœ‰å¯èƒ½æ‰©å±•åˆ° 28 å­—èŠ‚ï¼‰ã€‚é€šè¿‡å¯¹æ¯ä¸ªæºåŒ…çš„æ¯ä¸€ä½è¿›è¡Œå¼‚æˆ–æ“ä½œæ¥ç”Ÿæˆç‰¹å®šçš„ä¿®å¤åŒ…ã€‚ç»™ä½ ä¸€ä¸ªä¿®å¤åŒ…ï¼Œé‚£ä¹ˆæºåŒ…çš„é›†åˆï¼Œå¯ä»¥é€šè¿‡ Section 6.3.1 ä¸­çš„å…¬å¼è®¡ç®—å‡ºæ¥ã€‚&lt;/p>
&lt;p>é€šè¿‡å°†æ¯ä¸ªæºåŒ…æŒ‰ç…§ä»¥ä¸‹å­—æ®µçš„é¡ºåºæ‹¼æ¥åœ¨ä¸€èµ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”Ÿæˆ bit stringã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>RTP å¤´éƒ¨çš„å‰ 64 bits&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ— ç¬¦å·ç½‘ç»œåºçš„ 16-bit æºåŒ…å­—èŠ‚å¤§å°é™¤ä»¥ 12ï¼ˆå› ä¸ºå›ºå®šçš„ RTP å¤´ï¼‰ã€‚è¯´äººè¯å°±æ˜¯ç½‘ç»œåºçš„ uin16_t çš„å˜é‡ = æºåŒ…å­—èŠ‚æ•° / 12&lt;/p>
&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>æ¯”å¦‚ä»¥ä¸‹å‚æ•°çš„é•¿åº¦å’Œï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼šCSRC listï¼Œextension header, RTP payload å’Œ RTP padding (16 bits).&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>é€šè¿‡å¯¹æºåŒ…çš„ bit string åº”ç”¨å¥‡å¶æ“ä½œï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”Ÿæˆ FEC bit stringã€‚&lt;/strong>&lt;/p>
&lt;p>FEC å¤´æ˜¯ä» FEC bit string æŒ‰ç…§ä»¥ä¸‹ç»“æ„ç”Ÿæˆçš„ï¼š&lt;/p>
&lt;ul>
&lt;li>å¿½ç•¥æ‰ FEC bit string ä¸­çš„ 2 bits æœ€é«˜æœ‰æ•ˆä½ã€‚è®¾ç½® FEC å¤´çš„ MSK bits æˆåˆé€‚çš„å€¼ï¼Œæ¯”å¦‚ï¼Œå®ƒè·Ÿ bitmask é•¿åº¦æœ‰å…³&lt;/li>
&lt;li>FEC bit string çš„ä¸‹ä¸€ä½ è¢«å†™å…¥ FEC å¤´çš„ P recovery bit&lt;/li>
&lt;li>ä¸‹ 1 ä½è¢«å†™å…¥ FEC å¤´çš„ X recovery bit&lt;/li>
&lt;li>ä¸‹ 4 ä½è¢«å†™å…¥ FEC å¤´çš„ CC recovery field&lt;/li>
&lt;li>ä¸‹ 1 ä½è¢«å†™å…¥ FEC å¤´çš„ M recovery bit&lt;/li>
&lt;li>ä¸‹ 7 ä½è¢«å†™å…¥ FEC å¤´çš„ PT recovery field&lt;/li>
&lt;li>ä¸‹ 16 ä½è¢«è·³è¿‡&lt;/li>
&lt;li>ä¸‹ 32 ä½è¢«å†™å…¥ FEC å¤´çš„ TS recovery field&lt;/li>
&lt;li>ä¸‹ 16 ä½è¢«å†™å…¥ FEC å¤´çš„ length recovery field&lt;/li>
&lt;li>æ ¹æ®é€‰æ‹©çš„ MSK å€¼ï¼Œ bit mask of appropriate length will be set to the appropriate values.&lt;/li>
&lt;/ul>
&lt;p>å°±åƒ Section 4.2 ä¸­æè¿°çš„é‚£æ ·ï¼ŒFEC å¤´éƒ¨çš„ SN base field å¿…é¡»è®¾ç½®æˆ the lowest sequence number of the source packets protected by this repair packet. å½“ MSK è¡¨ç¤ºä¸€ä¸ª bitmaskï¼ˆMSK=00,01,10ï¼‰çš„æ—¶å€™ï¼ŒSN base field corresponds to the lowest sequence number indicated in the bitmask. å½“ MSK=11ï¼Œä»¥ä¸‹çš„æƒ…å†µï¼š&lt;/p>
&lt;ol>
&lt;li>å¯¹äº interleaved FEC åŒ…ï¼Œè¿™å¯¹åº”ç€æºåŒ…çš„æœ€ä½ sequence numberï¼ŒæŒ‰ç…§åˆ—è¿›è¡Œæ„å»º&lt;/li>
&lt;li>å¯¹äº non-interleaved FEC åŒ…ï¼ŒSN base field å¿…é¡»è®¾ç½®æˆæºåŒ…çš„æœ€ä½ sequence numberï¼ŒæŒ‰ç…§è¡Œè¿›è¡Œæ„å»ºã€‚&lt;/li>
&lt;/ol>
&lt;p>ä¿®å¤åŒ…çš„è½½è·æ•°æ®åŒ…å«äº†æºåŒ… XOR ä¹‹åçš„æ•°æ®ã€‚å¦‚æœæºåŒ…çš„è½½è·é•¿åº¦å„ä¸ç›¸åŒï¼Œé‚£ä¹ˆçŸ­çš„åŒ…å¿…é¡»è¡¥é›¶è¡¥åˆ°é•¿çš„åŒ…é‚£ä¹ˆé•¿ã€‚&lt;/p>
&lt;p>ç”±äºè¿™ç§å¯èƒ½çš„ padding å’Œ å¼ºåˆ¶çš„ FEC å¤´ï¼Œä¸€ä¸ªä¿®å¤åŒ…çš„å¤§å°è¦æ¯”æºåŒ…çš„å¤§ã€‚&lt;strong>è¿™å¯èƒ½å¯¼è‡´ä¿®å¤åŒ…çš„å¤§å°è¶…è¿‡ MTUã€‚&lt;/strong>&lt;/p>
&lt;h2 id="63-source-packet-reconstruction-é‡å»ºæºåŒ…" >
&lt;div>
&lt;a href="#63-source-packet-reconstruction-%e9%87%8d%e5%bb%ba%e6%ba%90%e5%8c%85">
#
&lt;/a>
6.3. Source Packet Reconstruction é‡å»ºæºåŒ…
&lt;/div>
&lt;/h2>
&lt;p>è¿™ä¸€å°èŠ‚æè¿°äº†é‡å»ºä¸¢å¤±æºåŒ…çš„ä¿®å¤è¿‡ç¨‹ã€‚&lt;/p>
&lt;p>ä¿®å¤è¿‡ç¨‹æœ‰ä¸¤æ­¥ï¼š&lt;/p>
&lt;ol>
&lt;li>FEC decoder å†³å®šåº”è¯¥ä½¿ç”¨å“ªä¸€ä¸ªæºåŒ…å’Œä¿®å¤åŒ…æ¥æ¢å¤ä¸¢å¤±çš„åŒ…&lt;/li>
&lt;li>decoder ä¿®å¤ä¸¢å¤±çš„åŒ…ï¼ŒåŒ…æ‹¬ RTP å¤´éƒ¨å’Œ RTP è½½è·&lt;/li>
&lt;/ol>
&lt;p>åœ¨ä¸‹é¢å‡ ä¸ªå°èŠ‚ï¼Œæˆ‘ä»¬æè¿°äº†ä¸€äº›æ­¥éª¤ä¸€å’Œæ­¥éª¤äºŒçš„ RECOMMENDED çš„ç®—æ³•ã€‚åŸºäºè¿™ä¸ªå®ç°ï¼ŒæŸäº›ç®—æ³•å¯èƒ½ä¼šè¢«æŠ›å¼ƒä½¿ç”¨ã€‚&lt;/p>
&lt;p>ç„¶è€Œï¼Œæœ€ç»ˆå®ç° MUST ä¸ä¸‹é¢çš„æè¿°ä¸€è‡´ã€‚&lt;/p>
&lt;p>æ³¨æ„ï¼Œä¸ç®¡ FEC ä¿æŠ¤åº”ç”¨åœ¨è¡Œè¿˜æ˜¯åˆ—ï¼Œ1-D å¥‡å¶ç æ‰€ä½¿ç”¨çš„ç®—æ³•ç›¸åŒã€‚è€Œ 2-D å¥‡å¶ç ï¼Œé€šå¸¸éœ€è¦å¤šæ¬¡è¿­ä»£ï¼Œè¿™ä¸ªè¿­ä»£è§£ç ç®—æ³•è¢« Section 6.3.4 è¿›ä¸€æ­¥è§£é‡Šã€‚&lt;/p>
&lt;h3 id="631-associating-the-source-and-repair-packets-æºåŒ…ä¸ä¿®å¤åŒ…ä¹‹é—´çš„å…³è”" >
&lt;div>
&lt;a href="#631-associating-the-source-and-repair-packets-%e6%ba%90%e5%8c%85%e4%b8%8e%e4%bf%ae%e5%a4%8d%e5%8c%85%e4%b9%8b%e9%97%b4%e7%9a%84%e5%85%b3%e8%81%94">
##
&lt;/a>
6.3.1. Associating the Source and Repair Packets æºåŒ…ä¸ä¿®å¤åŒ…ä¹‹é—´çš„å…³è”
&lt;/div>
&lt;/h3>
&lt;p>æ ¹æ®&lt;strong>ä¿®å¤åŒ…&lt;/strong> p ï¼Œå¾—å‡º&lt;strong>æºåŒ…&lt;/strong>çš„é›†åˆ T (p)ã€‚&lt;/p>
&lt;p>æ³¨æ„çš„æ˜¯ï¼Œå¯¹äº L åˆ—ã€ D è¡Œçš„ source blockï¼Œ é›†åˆ T åŒ…å«äº† D ä¸ªæºåŒ… + ä¸€ä¸ªåˆ—ä¿®å¤åŒ…ï¼Œè¿˜æœ‰ L ä¸ªæºåŒ… + ä¸€ä¸ªè¡Œä¿®å¤åŒ…&lt;/p>
&lt;p>åˆ—ä¿®å¤åŒ…ï¼šé€šè¿‡ä¸€åˆ—æºåŒ…è®¡ç®—å‡ºæ¥çš„ä¿®å¤åŒ…&lt;/p>
&lt;p>è¡Œä¿®å¤åŒ…ï¼šé€šè¿‡ä¸€è¡ŒæºåŒ…è®¡ç®—å‡ºæ¥çš„ä¿®å¤åŒ…&lt;/p>
&lt;p>é›†åˆ T ä¸­å¦‚æœåªä¸¢äº†ä¸€ä¸ªæºåŒ…ï¼Œé‚£ä¹ˆæ•°æ®å¯ä»¥è¢«æ¢å¤ã€‚å¦‚æœé›†åˆ T ä¸­ä¸¢å¤±è¶…è¿‡ä¸€ä¸ªæºåŒ…ï¼Œé‚£ä¹ˆ 1-D FEC protection å°†å¤±æ•ˆã€‚&lt;/p>
&lt;h4 id="6311-signaled-in-sdp-åœ¨-sdp-ä¸­çš„äº¤äº’" >
&lt;div>
&lt;a href="#6311-signaled-in-sdp-%e5%9c%a8-sdp-%e4%b8%ad%e7%9a%84%e4%ba%a4%e4%ba%92">
###
&lt;/a>
6.3.1.1. Signaled in SDP åœ¨ SDP ä¸­çš„äº¤äº’
&lt;/div>
&lt;/h4>
&lt;p>ç¬¬ä¸€æ­¥æ˜¯å…³è”æºåŒ…å’Œä¿®å¤åŒ…ã€‚å¦‚æœ endpoint æ•´ä¸ªä¾èµ– out-of-band signalingï¼ˆMSK=11, M=N=0ï¼‰ï¼Œå¯ä»¥ä» SDP æè¿°çš„ media type parameters æ¨æ–­å‡ºè¿™ä¸ªä¿¡æ¯ã€‚è¿›ä¸€æ­¥æ¥è®²ï¼ŒRTP å¤´éƒ¨çš„ payload type field å¯ä»¥è¾…åŠ© receiver å» distinguish äº¤é”™çš„æˆ–éäº¤é”™çš„ FEC åŒ…ã€‚&lt;/p>
&lt;p>æ•°å­¦ä¸Šæ¥è®²ï¼Œå¯¹äºæ¥æ”¶åˆ°çš„ä»»æ„çš„ä¿®å¤åŒ… pï¼Œ æˆ‘ä»¬å¯ä»¥ç¡®å®šå‡ºè¢«ä¿æŠ¤çš„æºåŒ…çš„ sequence numberï¼š
$$
p_snb + i \times {X_1} \left( modulo 65535 \right)
$$
p*_snb è¡¨ç¤º p* çš„ FEC å¤´ï¼Œé‡Œé¢çš„ SN base filed çš„ã€‚&lt;/p>
&lt;p>X_1ï¼Œå¦‚æœ FEC åŒ…æ˜¯äº¤é”™å¼çš„ï¼Œå°±è¢«è®¾ç½®æˆ Lï¼Œå¦‚æœæ˜¯éäº¤é”™å¼çš„ï¼Œé‚£å°±æ˜¯ 1
$$
0 \le i \lt X_2
$$
X_2ï¼Œå¦‚æœ FEC åŒ…æ˜¯äº¤é”™å¼çš„ï¼Œå°±è¢«è®¾ç½®æˆ Dï¼Œå¦‚æœæ˜¯éäº¤é”™å¼çš„ï¼Œé‚£å°±æ˜¯ L&lt;/p>
&lt;h4 id="6312-using-bitmasks" >
&lt;div>
&lt;a href="#6312-using-bitmasks">
###
&lt;/a>
6.3.1.2. Using bitmasks
&lt;/div>
&lt;/h4>
&lt;p>å½“ä½¿ç”¨å›ºå®šå¤§å°çš„ bitmasks ï¼ˆ16-, 48-, 122-bitsï¼‰çš„æ—¶å€™ï¼ŒFEC å¤´éƒ¨çš„ SN base field è¡¨ç¤º lowest sequence number of the æºåŒ… that forms the FEC packet.&lt;/p>
&lt;p>bitmask ä¸­çš„ â€œ1â€ å…¶å®æ˜¯ä» SN base å¼€å§‹çš„ offsetï¼Œè¡¨ç¤ºè¢« FEC ä¿æŠ¤çš„å‰©ä½™ packetã€‚&lt;/p>
&lt;p>bitmasks æœ‰èƒ½åŠ›è¡¨ç¤ºä»»æ„çš„ protection patternsï¼Œæ¯”å¦‚ 1-D interleavedï¼Œ1-D non-interleaved, 2-D, staircaseã€‚&lt;/p>
&lt;h4 id="6313-using-m-and-offsets" >
&lt;div>
&lt;a href="#6313-using-m-and-offsets">
###
&lt;/a>
6.3.1.3. Using M and Offsets
&lt;/div>
&lt;/h4>
&lt;p>å½“ M çš„å€¼éé›¶æ—¶ï¼Œ8-bit çš„ field è¡¨ç¤ºç”± interleavedï¼ˆN&amp;gt;0ï¼‰ æˆ– non-interleavedï¼ˆN=0ï¼‰ FEC åŒ…æ‰€ä¿æŠ¤çš„æ•°æ®åŒ…çš„ offset&lt;/p>
&lt;p>é€šè¿‡ç»„åˆ interleaved å’Œ non-interleaved FEC åŒ…ï¼Œæˆ‘ä»¬å¯ä»¥ç»„æˆ 2-D protection patternsã€‚&lt;/p>
&lt;p>æ•°å­¦ä¸Šæ¥è®²ï¼Œå¯¹äºä»»æ„æ¥æ”¶åˆ°çš„ä¿®å¤åŒ… p*ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç¡®å®šè¢«ä¿æŠ¤çš„æºåŒ…çš„ sequence numberï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>When N = 0:
p*_snb, p*_snb+1,..., p*_snb+(M-1), p*_snb+M
When N &amp;gt; 0:
p*_snb, p*_snb+(Mx1), p*_snb+(Mx2),..., p*_snb+(Mx(N-1)), p*_snb+(MxN)
&lt;/code>&lt;/pre>&lt;h3 id="632-recovering-the-rtp-header-æ¢å¤-rtp-å¤´" >
&lt;div>
&lt;a href="#632-recovering-the-rtp-header-%e6%81%a2%e5%a4%8d-rtp-%e5%a4%b4">
##
&lt;/a>
6.3.2. Recovering the RTP Header æ¢å¤ RTP å¤´
&lt;/div>
&lt;/h3>
&lt;p>ç•¥è¿‡ï¼Œå› ä¸ºä¸éœ€è¦å®ç°&lt;/p>
&lt;h1 id="7-sdp-examples-æœ‰å…³-sdp-çš„ä¾‹å­" >
&lt;div>
&lt;a href="#7-sdp-examples-%e6%9c%89%e5%85%b3-sdp-%e7%9a%84%e4%be%8b%e5%ad%90">
##
&lt;/a>
7. SDP Examples æœ‰å…³ SDP çš„ä¾‹å­
&lt;/div>
&lt;/h1>
&lt;p>è¿™ä¸€èŠ‚ï¼Œæä¾›äº†ä¸¤ä¸ª SDP çš„ä¾‹å­ã€‚ä¾‹å­é‡Œä½¿ç”¨äº†åœ¨ RFC5956 ä¸­å®šä¹‰çš„ FEC grouping è¯­ä¹‰ã€‚&lt;/p>
&lt;h2 id="71-example-sdp-for-flexible-fec-protection-with-in-band-ssrc-mapping" >
&lt;div>
&lt;a href="#71-example-sdp-for-flexible-fec-protection-with-in-band-ssrc-mapping">
#
&lt;/a>
7.1. Example SDP for Flexible FEC Protection with in-band SSRC mapping
&lt;/div>
&lt;/h2>
&lt;p>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªè§†é¢‘æºæµå’Œä¸€ä¸ª FEC ä¿®å¤åŒ…æµã€‚æºå’Œä¿®å¤åŒ…æµè¢«å¤ç”¨åœ¨ä¸åŒçš„ SSRC é‡Œã€‚repair-window è¢«è®¾ç½®æˆ 200ms&lt;/p>
&lt;pre tabindex="0">&lt;code>v=0
o=mo 1122334455 1122334466 IN IP4 fec.example.com
s=FlexFEC minimal SDP signalling Example
t=0 0
m=video 30000 RTP/AVP 96 98
c=IN IP4 143.163.151.157
a=rtpmap:96 VP8/90000
a=rtpmap:98 flexfec/90000
a=fmtp:98; repair-window=200ms
&lt;/code>&lt;/pre>&lt;h2 id="72-example-sdp-for-flex-fec-protection-with-explicit-signalling-in-the-sdp" >
&lt;div>
&lt;a href="#72-example-sdp-for-flex-fec-protection-with-explicit-signalling-in-the-sdp">
#
&lt;/a>
7.2. Example SDP for Flex FEC Protection with explicit signalling in the SDP
&lt;/div>
&lt;/h2>
&lt;p>åœ¨è¿™é‡Œä¾‹å­é‡Œï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªè§†é¢‘æºæµï¼ˆssrcï¼š1234ï¼‰å’Œä¸€ä¸ª FEC ä¿®å¤åŒ…æµï¼ˆssrcï¼š2345ï¼‰ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬è·Ÿ &lt;code>a=ssrc-group:FEC-FR 1234 2345&lt;/code> æ„å»ºä¸€ä¸ª FEC groupsã€‚æºå’Œä¿®å¤åŒ…æµå¤ç”¨åœ¨ä¸åŒçš„ SSRC é‡Œã€‚repair-window è¢«è®¾ç½®æˆ 200ms&lt;/p>
&lt;pre tabindex="0">&lt;code>v=0
o=ali 1122334455 1122334466 IN IP4 fec.example.com
s=2-D Parity FEC with no in band signalling Example
t=0 0
m=video 30000 RTP/AVP 100 110
c=IN IP4 233.252.0.1/127
a=rtpmap:100 MP2T/90000
a=rtpmap:110 flexfec/90000
a=fmtp:110 L:5; D:10; ToP:2; repair-window:200000
a=ssrc:1234
a=ssrc:2345
a=ssrc-group:FEC-FR 1234 2345
&lt;/code>&lt;/pre>&lt;h1 id="8-congestion-control-considerations-æ‹¥å¡æ§åˆ¶çš„è€ƒè™‘" >
&lt;div>
&lt;a href="#8-congestion-control-considerations-%e6%8b%a5%e5%a1%9e%e6%8e%a7%e5%88%b6%e7%9a%84%e8%80%83%e8%99%91">
##
&lt;/a>
8. Congestion Control Considerations æ‹¥å¡æ§åˆ¶çš„è€ƒè™‘
&lt;/div>
&lt;/h1>
&lt;p>FEC ä¸ºåº”ç”¨å±‚å¯¹æŠ—ä¸¢åŒ…æä¾›äº†ä¸€ç§æœ‰æ•ˆçš„æ–¹æ³•ã€‚ç„¶è€Œï¼Œå¦‚æœåœ¨ä¸€ä¸ªä¸¢åŒ…æ˜¯å› ä¸ºæ‹¥å¡æ§åˆ¶çš„ç½‘ç»œä¸­ï¼Œé‚£ä¹ˆåœ¨ä½¿ç”¨ FEC ä¹‹å‰ï¼Œåº”è¯¥è€ƒè™‘åˆ° FEC æ³¨å…¥åˆ°ç½‘ç»œä¸­æ½œåœ¨çš„å½±å“ã€‚&lt;/p>
&lt;p>ç‰¹åˆ«çš„æ˜¯ï¼Œåœ¨å¸¦å®½é™åˆ¶çš„ç½‘ç»œä¸­ï¼ŒFEC ä¿®å¤åŒ…çš„æµåŠ¨ï¼Œå¯èƒ½æˆä¸ºå¸¦å®½æ¶ˆè€—çš„ç½ªé­ç¥¸é¦–ï¼Œæœ‰å¯èƒ½ä¼šå µå¡ç½‘ç»œã€‚åœ¨è¿™ä¸ªæƒ…å†µé‡Œï¼Œåº”ç”¨ç¨‹åº MUST NOT éšæ„å¢åŠ  FEC ä¿æŠ¤çš„æ¬¡æ•°ï¼Œå› ä¸ºè¿™ä¹ˆåšä¼šæœ‰å¯èƒ½å¯¼è‡´æ‹¥å¡å´©æºƒï¼ˆCongestion Collapseï¼‰ã€‚&lt;/p>
&lt;p>Congestive collapse (or congestion collapse) is the condition in which congestionprevents or limits useful communication.&lt;/p>
&lt;p>å¦‚æœä½ çœŸçš„å¾ˆæƒ³è¦ FEC ä¿æŠ¤ï¼Œé‚£ä¹ˆä½ æˆ–è®¸å¯ä»¥åœ¨æºç ç‡é™ä½çš„æ—¶å€™é‡‡ç”¨æ›´å¼ºçš„ FEC ä¿æŠ¤ã€‚&lt;/p>
&lt;p>åœ¨ä¸€ä¸ªç½‘ç»œå‹å¥½çš„å®ç°é‡Œï¼Œå¦‚æœåº”ç”¨ç¨‹åºçŸ¥é“ å‘é€ / æ¥å— FEC ä¿®å¤æµ å¹¶ä¸èƒ½å¸®åŠ©æ¢å¤ä¸¢å¤±çš„åŒ…çš„æ—¶å€™ï¼Œåº”ç”¨ç¨‹åº SHOULD NOT å‘é€ / æ¥æ”¶ FEC ä¿®å¤æµã€‚ç„¶è€Œï¼Œå¦‚æœè€ƒè™‘ç”¨äºå¸¦å®½ä¼°è®¡ï¼Œè€Œä¸æ˜¯é€šè¿‡æ¨æµ‹æ–¹å¼æ¢å¯»é¢å¤–çš„å®¹é‡ï¼Œåº”ç”¨ç¨‹åº MAY still continue å»ä½¿ç”¨ FECã€‚è¿™é‡Œ RECOMMENDED å»åŸºäºåº”ç”¨ç¨‹åºè§‚å¯Ÿåˆ°çš„ä¸¢åŒ…ç‡ï¼ŒåŠ¨æ€åœ°è°ƒæ•´ FEC ä¿æŠ¤ã€‚&lt;/p>
&lt;p>åœ¨å¤šæ’­çš„æƒ…æ™¯é‡Œï¼Œä¸ºæ¯ä¸€ä¸ªæ¥æ”¶ç«¯å»ä¼˜åŒ– FEC ä¿æŠ¤æ˜¯éå¸¸å›°éš¾çš„ã€‚å¦‚æœä½ æœ‰ä¸€å †ä¸åŒçš„æ¥å—è€…ï¼Œå¹¶ä¸”è¿™äº›æ¥å—è€…éƒ½è¦æ±‚ä½¿ç”¨ä¸åŒçš„ FEC ä¿æŠ¤çº§åˆ«çš„è¯ï¼Œè¿™é‡Œ RECOMMENDED å‘é€è€…æä¾›å¤šä¸ªä¿®å¤æµï¼Œæ¯ä¸ªä¿®å¤æµéƒ½æ˜¯ä¸åŒçš„ FEC ä¿æŠ¤çº§åˆ«ï¼Œè®©æ¥å—è€…åŠ å…¥å¯¹åº”çš„å¤šæ’­ session å»æ¥æ”¶æœ€é€‚åˆä»–ä»¬çš„ä¿®å¤æµã€‚&lt;/p>
&lt;p>ç¼–è€…æ³¨ï¼š2-D çš„å¥‡å¶ç åº”è¯¥ä¹ŸåŠ å…¥åˆ° â€œå¤šä½™çš„æ‹¥å¡æ§åˆ¶è€ƒè™‘â€ é‡Œ&lt;/p>
&lt;p>ï¼ˆä¸æ˜¯è¯‘è€…æ³¨ï¼‰&lt;/p>
&lt;h1 id="9-security-considerations-å®‰å…¨è€ƒè™‘" >
&lt;div>
&lt;a href="#9-security-considerations-%e5%ae%89%e5%85%a8%e8%80%83%e8%99%91">
##
&lt;/a>
9. Security Considerations å®‰å…¨è€ƒè™‘
&lt;/div>
&lt;/h1>
&lt;h1 id="10-iana-considerations" >
&lt;div>
&lt;a href="#10-iana-considerations">
##
&lt;/a>
10. IANA Considerations
&lt;/div>
&lt;/h1>
&lt;pre tabindex="0">&lt;code>New media subtypes are subject to IANA registration. For the
registration of the payload formats and their parameters introduced
in this document, refer to Section 5.
&lt;/code>&lt;/pre>&lt;h1 id="11-acknowledgements" >
&lt;div>
&lt;a href="#11-acknowledgements">
##
&lt;/a>
11. Acknowledgements
&lt;/div>
&lt;/h1>
&lt;pre tabindex="0">&lt;code>Some parts of this document are borrowed from [RFC5109]. Thus, the
author would like to thank the editor of [RFC5109] and those who
contributed to [RFC5109].
Thanks to Bernard Aboba , Rasmus Brandt , Roni Even , Stefan Holmer ,
Jonathan Lennox , and Magnus Westerlund for providing valuable
feedback on earlier versions of this draft.
&lt;/code>&lt;/pre>&lt;p>å‰©ä¸‹çš„æˆ‘å°±ä¸ç¿»è¯‘äº†ã€‚
è½¬è½½è¯·æ³¨æ˜ä½œè€… Junyi å¹¶ä¸”é™„å¸¦åŸæ–‡é“¾æ¥ï¼&lt;/p>
&lt;h1 id="2023å¹´8æœˆ23æ—¥æ›´æ–°" >
&lt;div>
&lt;a href="#2023%e5%b9%b48%e6%9c%8823%e6%97%a5%e6%9b%b4%e6%96%b0">
##
&lt;/a>
2023å¹´8æœˆ23æ—¥æ›´æ–°
&lt;/div>
&lt;/h1>
&lt;p>æˆ‘é ï¼Œæˆ‘å½“æ—¶æ€ä¹ˆå•ƒä¸‹æ¥çš„è¿™ä¸ªï¼Ÿï¼Ÿï¼Ÿ&lt;/p></description></item><item><title>RFC5389 - Session Traversal Utilities for NAT</title><link>/posts/rfc5389-stun/</link><pubDate>Sat, 27 Jun 2020 20:10:49 +0800</pubDate><author>junyi.h@comp.nus.edu.sg (Junyi Hou)</author><guid>/posts/rfc5389-stun/</guid><description>&lt;p>STUN æ˜¯ä¸€ç§åè®®ï¼Œç”¨äºæ£€æŸ¥ä¸¤ä¸ªç»ˆç«¯ä¹‹é—´çš„è¿é€šæ€§ï¼Œå¯ä»¥å·¥ä½œåœ¨å¤šç§ NAT ä¹‹ä¸­ï¼Œä¸éœ€è¦ NAT å¯¹å…¶æœ‰ä»»ä½•è¡Œä¸ºã€‚&lt;/p>
&lt;p>STUN æœ¬èº«ä¸æ˜¯ä¸€ä¸ª NAT ç©¿é€çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œæ˜¯ä¸€ä¸ª NAT ç©¿é€&lt;strong>æ¡ä»¶æ£€æµ‹å·¥å…·&lt;/strong>ã€‚&lt;/p>
&lt;h1 id="è¯´åœ¨å‰é¢" >
&lt;div>
&lt;a href="#%e8%af%b4%e5%9c%a8%e5%89%8d%e9%9d%a2">
##
&lt;/a>
è¯´åœ¨å‰é¢
&lt;/div>
&lt;/h1>
&lt;p>&lt;strong>è½¬è½½è¯·æ³¨æ˜ä½œè€…åŠå‡ºå¤„ï¼&lt;/strong>&lt;/p>
&lt;p>ç¿»è¯‘ä¸­é‡åˆ°çš„é—®é¢˜ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> æ–‡ç« ä¸èƒ½å¾ˆå¥½åŒºåˆ† indication å’Œ indication transaction&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> å­˜åœ¨ä¸ç†è§£çš„å†…å®¹ä»¥è¯¥æ ¼å¼è¿›è¡Œæ ‡è®° &lt;span style="color: red;">?? ä¸ç†è§£çš„å†…å®¹ï¼Ÿï¼Ÿ&lt;/span>&lt;/li>
&lt;/ul>
&lt;p>è¿˜æœªæ£€æŸ¥çš„é¡¹ç›®ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> ç¿»è¯‘çš„åè¯ä¸ä¼šä¸€ä¸ªå•è¯å¤šä¸ªç¿»è¯‘ã€‚ä¿è¯ä¸€è‡´æ€§&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> å¥å­ç»“æŸçš„å¥å·æ˜¯å¦å®Œæ•´&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> å•è¯å·¦å³ä¸¤è¾¹æ˜¯å¦æœ‰ç©ºæ ¼&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> å¤§å°å†™ã€æ‹¼å†™é—®é¢˜&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> æˆ–ã€ä¸”ï¼Œæ˜¯å¦å…¨éƒ½æ˜¯å·¦å³ä¸¤è¾¹åŠ é€—å·&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>è¯‘è€…æ³¨ï¼š&lt;/strong>&lt;/p>
&lt;p>æœ¬ç¿»è¯‘ä»…ä¾›å‚è€ƒï¼Œç›®çš„æ˜¯è®©è¯»è€…æ›´å¥½åœ°ç†è§£ STUN åè®®ï¼ˆ&lt;a href="https://www.junyi.dev/">RFC 5389&lt;/a>ï¼‰ã€‚&lt;/p>
&lt;p>&lt;strong>æˆ‘ä¸ªäºº&lt;/strong>å¯¹ç¿»è¯‘çš„è¦æ±‚æ˜¯é€»è¾‘ä¸¥å¯†å‡†ç¡®ï¼Œä¸”æ–‡ç« &lt;strong>æ ¸å¿ƒå†…å®¹&lt;/strong>ä¸è‹±æ–‡åŸç‰ˆä¸€è‡´ã€‚&lt;/p>
&lt;p>ä¸ºäº†æ›´æ–¹ä¾¿è¯»è€…ç†è§£ï¼Œæœ¬ç¿»è¯‘ &lt;strong>ä¸ä¿è¯&lt;/strong> éƒ¨åˆ†æªè¾ç»†èŠ‚ä¸è‹±æ–‡åŸç‰ˆä¸€è‡´ã€‚&lt;/p>
&lt;p>ä¸ºäº†ä¿è¯æ–‡ç« çš„å‡†ç¡®æ€§ï¼Œä¸ªåˆ«åè¯å°†ä¸ä¼šè¿›è¡Œç¿»è¯‘ã€‚&lt;/p>
&lt;p>åŒæ ·ï¼Œä¸ºäº†ä¿è¯æ–‡ç« çš„å‡†ç¡®æ€§ï¼Œæ¯å¥è¯çš„ç¿»è¯‘éƒ½ä¼šé™„ä¸Šè‹±æ–‡åŸç‰ˆä¾›è¯»è€…å‚è€ƒã€‚&lt;/p>
&lt;p>è¯‘è€…è¯­æ–‡å’Œè‹±è¯­çš„æ°´å¹³éƒ½ä¸é«˜ï¼Œå†æ¬¡å¼ºè°ƒï¼Œæœ¬ç¿»è¯‘ä»…ä¾›å‚è€ƒã€‚&lt;/p>
&lt;p>è¯‘è€…ï¼šJunyi&lt;/p>
&lt;p>è”ç³»é‚®ç®±ï¼šhhh#u.nus.edu (è‡ªè¡Œæ›¿æ¢æˆ at ç¬¦å·)&lt;/p>
&lt;h1 id="stun" >
&lt;div>
&lt;a href="#stun">
##
&lt;/a>
STUN
&lt;/div>
&lt;/h1>
&lt;p>STUN å…¨åå« Session Traversal Utilities for NAT (STUN)&lt;/p>
&lt;p>æœ€æ–°å®šä¹‰åœ¨ &lt;a href="https://datatracker.ietf.org/doc/rfc5389/">RFC 5389&lt;/a>&lt;/p>
&lt;p>STUN æ˜¯ä¸€ç§åè®®ï¼Œç”¨äºæ£€æŸ¥ä¸¤ä¸ªç»ˆç«¯ä¹‹é—´çš„è¿é€šæ€§ï¼Œå¯ä»¥å·¥ä½œåœ¨å¤šç§ NAT ä¹‹ä¸­ï¼Œä¸éœ€è¦ NAT å¯¹å…¶æœ‰ä»»ä½•è¡Œä¸ºã€‚&lt;/p>
&lt;p>STUN æœ¬èº«ä¸æ˜¯ä¸€ä¸ª NAT ç©¿é€çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œæ˜¯ä¸€ä¸ª NAT ç©¿é€æ¡ä»¶æ£€æµ‹å·¥å…·ã€‚&lt;/p>
&lt;p>STUN æœ€åˆå®šä¹‰åœ¨ RFC 3489ï¼Œæœ‰æ—¶æˆ‘ä»¬ä¹Ÿè¯´è¿™ä¸ªæœ€åˆç‰ˆæœ¬ä¸º â€œç»å…¸ STUNâ€ ï¼ˆclassic STUNï¼‰&lt;/p>
&lt;p>åœ¨é‚£æ—¶å€™å…¶å®å·²ç»æ˜¯ä¸€ä¸ªå®Œæ•´çš„ NAT ç©¿é€é—®é¢˜çš„è§£å†³æ–¹æ¡ˆäº†ï¼Œå®¢æˆ·ç«¯å¯ä»¥å»å‘ç°è‡ªå·±æ˜¯å¦åœ¨ NAT ä¹‹åï¼Œç¡®å®šå…¶æ‰€åœ¨ NAT çš„ç±»å‹ï¼Œå‘ç°å…¶ç»è¿‡ NAT è½¬æ¢åçš„ IP åœ°å€å’Œç«¯å£å·ï¼Œåˆ©ç”¨è¿™ä¸ª IP åœ°å€å’Œç«¯å£å·æ‰§è¡Œ SIPï¼ˆSession Initiation Protocolï¼‰ã€‚&lt;/p>
&lt;p>&lt;strong>å¬èµ·æ¥æŒºç¾å¥½çš„å“ˆï¼Œä½†æ˜¯éšç€æˆ‘ä»¬çš„åº”ç”¨éƒ¨ç½²ï¼Œå‘ç°ç»å…¸çš„ STUN æœ‰æ—¶å€™æ ¹æœ¬ä¸å·¥ä½œï¼&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>
&lt;p>é€šè¿‡ STUN è·å–åˆ°çš„ IP åœ°å€å’Œç«¯å£ä¿¡æ¯æœ‰æ—¶å€™å¯ä»¥è®©ä¸¤ä¸ª peer äº’é€šï¼Œæœ‰æ—¶å€™ä¸è¡Œ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åœ¨ peer ä¸äº’é€šæ—¶ï¼Œç»å…¸ STUN æ²¡æœ‰æä¾›è¡¥æ•‘æªæ–½&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åœ¨æœ‰äº› NAT å†…ï¼Œç»å…¸ STUN çš„ç®—æ³•æ˜¯é”™è¯¯çš„&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç»å…¸ STUN å­˜åœ¨å®‰å…¨æ¼æ´ï¼ˆæ”»å‡»è€…å¯ä»¥ç»™ peer æä¾›é”™è¯¯çš„æ˜ å°„åœ°å€ã€æ‹“æ‰‘ã€çº¦æŸï¼‰ã€‚è¿™ä¸ªé—®é¢˜æ— æ³•ä»æ ¹æœ¬è§£å†³ï¼Œæˆ‘ä»¬æœ€æ–°çš„åè®®ä¹Ÿåªèƒ½ç¼“è§£è¿™ä¸ªé—®é¢˜ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>åŸºäºä»¥ä¸ŠåŸå› ï¼ŒRFC 3489 &lt;strong>å·²ç»è¢«åºŸå¼ƒ&lt;/strong>ã€‚&lt;/p>
&lt;h1 id="3-æ“ä½œæ¦‚è¿°-overview-of-operation" >
&lt;div>
&lt;a href="#3-%e6%93%8d%e4%bd%9c%e6%a6%82%e8%bf%b0-overview-of-operation">
##
&lt;/a>
3. æ“ä½œæ¦‚è¿° Overview of Operation
&lt;/div>
&lt;/h1>
&lt;blockquote>
&lt;p>This section is descriptive only.&lt;/p>
&lt;/blockquote>
&lt;p>æœ¬èŠ‚ä»…ä½œæè¿°æ€§ç”¨é€”ã€‚&lt;/p>
&lt;blockquote>
&lt;p>STUN is a client-server protocol.&lt;/p>
&lt;/blockquote>
&lt;p>STUN æ˜¯ä¸€ç§ client-server åè®®ï¼Œæ¢å¥è¯è®²ï¼Œè¿è¡Œ STUN åè®®å®ç°çš„ä¸»æœºæ—¢å¯ä»¥å……å½“å®¢æˆ·ç«¯ä¹Ÿå¯ä»¥å……å½“æœåŠ¡å™¨ã€‚&lt;/p>
&lt;blockquote>
&lt;p>It supports two types of transactions.&lt;/p>
&lt;/blockquote>
&lt;p>STUN æ”¯æŒä¸¤ç§ç±»å‹çš„äº‹åŠ¡ã€‚&lt;/p>
&lt;blockquote>
&lt;p>One is a &lt;strong>request/response transaction&lt;/strong> in which a client sends a request to a server, and the server returns a response.&lt;/p>
&lt;/blockquote>
&lt;p>å…¶ä¸­ä¸€ç§æ˜¯&lt;strong>è¯·æ±‚/å“åº”å‹äº‹åŠ¡&lt;/strong>ã€‚å°±æ˜¯è¯´å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª request ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯ä¸€ä¸ª response ã€‚&lt;/p>
&lt;blockquote>
&lt;p>The second is an &lt;strong>indication transaction&lt;/strong> in which either agent â€“ client or server â€“ sends an indication that generates no response.&lt;/p>
&lt;/blockquote>
&lt;p>å¦ä¸€ç§æ˜¯&lt;strong>æŒ‡ç¤ºå‹äº‹åŠ¡&lt;/strong>ã€‚å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨åªæ˜¯??å‘é€ä¸€ä¸ªæŒ‡ç¤ºï¼Œå¹¶æ²¡æœ‰ä»»ä½• responseã€‚??&lt;/p>
&lt;blockquote>
&lt;p>Both types of transactions include a &lt;strong>transaction ID&lt;/strong>, which is a randomly selected 96-bit number.&lt;/p>
&lt;/blockquote>
&lt;p>ä¸Šè¿°çš„ä¸¤ç§äº‹åŠ¡ç±»å‹ï¼Œéƒ½åŒ…å«ä¸€ä¸ªéšæœºé€‰æ‹©çš„96ä½çš„äº‹åŠ¡IDã€‚&lt;/p>
&lt;blockquote>
&lt;p>For &lt;strong>request/response transactions&lt;/strong>, this transaction ID allows the client to associate the response with the request that generated it; for &lt;strong>indications&lt;/strong>, the transaction ID serves as a debugging aid.&lt;/p>
&lt;/blockquote>
&lt;p>å¯¹äº&lt;strong>è¯·æ±‚/å“åº”å‹äº‹åŠ¡&lt;/strong>ï¼Œ??äº‹åŠ¡IDå…è®¸å®¢æˆ·ç«¯å°†å…¶ç”Ÿæˆçš„è¯·æ±‚äº‹åŠ¡ä¸æ”¶åˆ°çš„å“åº”äº‹åŠ¡ç›¸å…³è”ã€‚??&lt;/p>
&lt;p>å¯¹äº&lt;strong>æŒ‡ç¤ºå‹äº‹åŠ¡&lt;/strong>ï¼Œäº‹åŠ¡IDå……å½“è°ƒè¯•å·¥å…·çš„è§’è‰²ã€‚&lt;/p>
&lt;blockquote>
&lt;p>All STUN messages start with a fixed header that includes a &lt;strong>method&lt;/strong>, a &lt;strong>class&lt;/strong>, and the &lt;strong>transaction ID&lt;/strong>.&lt;/p>
&lt;/blockquote>
&lt;p>æ‰€æœ‰çš„ STUN æ¶ˆæ¯éƒ½ä»¥ä¸€ä¸ªå›ºå®šçš„å¤´éƒ¨å¼€å§‹ã€‚è¿™ä¸ªå¤´éƒ¨åŒ…å«&lt;strong>æ–¹æ³•&lt;/strong>ã€&lt;strong>ç±»&lt;/strong>ã€&lt;strong>äº‹åŠ¡ID&lt;/strong>[^1]&lt;/p>
&lt;ul>
&lt;li>
&lt;blockquote>
&lt;p>The &lt;strong>method&lt;/strong> indicates which of the various requests or indications this is; this specification defines just one method, Binding, but other methods are expected to be defined in other documents.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>æ–¹æ³•&lt;/strong>è¡¨ç¤ºè¿™æ˜¯å“ªç§è¯·æ±‚ï¼Œæˆ–ï¼Œè¿™æ˜¯å“ªç§&lt;strong>æŒ‡ç¤º&lt;/strong>ã€‚åœ¨å½“å‰æ‚¨é˜…è¯»çš„è¿™ä¸ª RFC è§„èŒƒé‡Œï¼Œæˆ‘ä»¬åªè§„å®šäº†ä¸€ç§æ–¹æ³•ï¼šBindingã€‚ï¼ˆå…¶ä»–çš„æ–¹æ³•æœ‰æœ›åœ¨å…¶ä»–æ–‡æ¡£ä¸­å®šä¹‰ï¼‰&lt;/p>
&lt;/li>
&lt;li>
&lt;blockquote>
&lt;p>The &lt;strong>class&lt;/strong> indicates whether this is a request, a &lt;strong>success response&lt;/strong>, an &lt;strong>error response&lt;/strong>, or an &lt;strong>indication&lt;/strong>.&lt;/p>
&lt;/blockquote>
&lt;p>ç±»è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªè¯·æ±‚ã€æˆåŠŸçš„å“åº”ã€é”™è¯¯çš„å“åº”è¿˜æ˜¯ä¸€ä¸ªæŒ‡ç¤ºã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>Following the fixed header comes zero or more attributes, which are &lt;strong>Type-Length-Value&lt;/strong> extensions that convey additional information for the specific message.&lt;/p>
&lt;/blockquote>
&lt;p>ç´§è·Ÿåœ¨å›ºå®šå¤´éƒ¨åé¢çš„æ˜¯ 0 ä¸ªæˆ–å¤šä¸ª &lt;strong>Type-Length-Value&lt;/strong> æ‰©å±•å±æ€§ã€‚ä¸ç”¨ç»†è¯´ï¼Œç›¸ä¿¡ä½ ä¹Ÿæ˜ç™½è¿™ä¸ªæ‰©å±•å±æ€§çš„ç”¨é€”æ˜¯ä¸ºäº†ä¼ é€’é™„åŠ ä¿¡æ¯ã€‚&lt;/p>
&lt;hr>
&lt;blockquote>
&lt;p>This document defines a single method called Binding. The Binding method can be used either in request/response transactions or in indication transactions.&lt;/p>
&lt;/blockquote>
&lt;p>è¿™ä»½æ–‡æ¡£åªå®šä¹‰äº† Binding è¿™ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ—¢å¯ä»¥ç”¨åœ¨è¯·æ±‚/å“åº”å‹äº‹åŠ¡ï¼Œåˆå¯ä»¥ç”¨åœ¨æŒ‡ç¤ºå‹äº‹ç‰©ã€‚&lt;/p>
&lt;blockquote>
&lt;p>When used in request/response transactions, the Binding method can be used to determine the particular â€œbindingâ€ a NAT has allocated to a STUN client. When used in either request/ response &lt;strong>or&lt;/strong> in indication transactions, the Binding method can also be used to keep these â€œbindingsâ€ alive.&lt;/p>
&lt;/blockquote>
&lt;p>å½“åœ¨è¯·æ±‚/å“åº”å‹äº‹åŠ¡ä¸­ä½¿ç”¨ Binding æ–¹æ³•æ—¶ï¼Œå®ƒå¯ä»¥ç”¨æ¥ç¡®å®šä¸€ä¸ª NAT åˆ†é…ç»™ STUN å®¢æˆ·ç«¯çš„ç‰¹å®š â€œç»‘å®šâ€ã€‚&lt;/p>
&lt;p>å½“åœ¨è¯·æ±‚/å“åº”å‹äº‹åŠ¡&lt;strong>æˆ–&lt;/strong>æŒ‡ç¤ºå‹äº‹ç‰©ä¸­ä½¿ç”¨ Binding æ–¹æ³•æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•è¿˜å¯ä»¥ç”¨æ¥ç»´æŒè¿™äº›ç‰¹å®š â€œç»‘å®šâ€ æ˜¯æ´»åŠ¨çš„ã€‚&lt;/p>
&lt;hr>
&lt;blockquote>
&lt;p>In the Binding request/response transaction, a Binding request is sent from a STUN client to a STUN server.&lt;/p>
&lt;/blockquote>
&lt;p>åœ¨ä½¿ç”¨ Binding æ–¹æ³•çš„è¯·æ±‚/å“åº”å‹äº‹åŠ¡ä¸­ï¼Œä¸€æ¡ Binding è¯·æ±‚ ä¼šä» STUN å®¢æˆ·ç«¯å‘å¾€ STUN æœåŠ¡å™¨ã€‚&lt;/p>
&lt;blockquote>
&lt;p>When the Binding request arrives at the STUN server, it may have passed through one or more NATs between the STUN client and the STUN server (in Figure 1, there were two such NATs).&lt;/p>
&lt;/blockquote>
&lt;p>ä¸€æ¡ Binding è¯·æ±‚ åˆ°è¾¾ STUN æœåŠ¡å™¨çš„è¿‡ç¨‹é‡Œï¼Œå¯èƒ½ä¼šç©¿è¶Š 1 ä¸ªæˆ–å¤šä¸ª NAT è®¾å¤‡ã€‚ï¼ˆåœ¨ Figure 1 ä¸­ç©¿è¶Šäº†ä¸¤ä¸ª NAT è®¾å¤‡ï¼‰&lt;/p>
&lt;blockquote>
&lt;p>As the Binding request message passes through a NAT, the NAT will modify the source transport address (that is, the source IP address and the source port) of the packet. As a result, the source transport address of the request received by the server will be the public IP address and port created &lt;strong>by the NAT closest to the server&lt;/strong>. This is called a reflexive transport address.&lt;/p>
&lt;/blockquote>
&lt;p>åœ¨ä¸€ä¸ª Bingding è¯·æ±‚ æ•°æ®åŒ…ç»è¿‡ NAT çš„æ—¶å€™ï¼ŒNAT ä¼šä¿®æ”¹è¯¥æ•°æ®åŒ…çš„æ¥æºåœ°å€å’Œç«¯å£ã€‚&lt;/p>
&lt;p>å¯¹äºæœåŠ¡å™¨æ¥è¯´ï¼Œæ¥æ”¶åˆ°çš„è¿™ä»½æ•°æ®åŒ…çš„æ¥æºåœ°å€å’Œç«¯å£å…¶å®æ˜¯&lt;strong>ç¦»æœåŠ¡å™¨æœ€è¿‘çš„ NATçš„å…¬ç½‘ IP åœ°å€å’Œç«¯å£&lt;/strong> ã€‚&lt;/p>
&lt;p>è¿™å«åš reflexive transport addressã€‚&lt;/p>
&lt;p>??è¿™ä¸ªè¯·æ±‚æ•°æ®åŒ…çš„sourceåœ°å€å«åš reflexive transport addressï¼Ÿ??&lt;/p>
&lt;blockquote>
&lt;p>The STUN server copies that source transport address into an XOR-MAPPED-ADDRESS attribute in the STUN Binding response and sends the Binding response back to the STUN client. As this packet passes back through a NAT, the NAT will modify the &lt;strong>destination&lt;/strong> transport address in the IP header, but the transport address in the XOR-MAPPED-ADDRESS attribute within the body of the STUN response will remain untouched.&lt;/p>
&lt;/blockquote>
&lt;p>æ¥ç€ï¼ŒSTUN æœåŠ¡å™¨ä¼šäº§ç”Ÿä¸€ä¸ª Binding å“åº”ï¼Œç„¶åå¤åˆ¶æ”¶åˆ°æ•°æ®åŒ…çš„ æ¥æºåœ°å€å’Œç«¯å£ åˆ° Binding å“åº” é‡Œçš„ä¸€ä¸ªå«åš XOR-MAPPED-ADDRESS çš„å±æ€§ä¸­ï¼Œç„¶åå°† Binding å“åº” å‘å› STUN å®¢æˆ·ç«¯ã€‚&lt;/p>
&lt;p>è¿™ä¸ªå“åº”æ•°æ®åŒ…ä¹Ÿä¼šç»è¿‡ NATï¼ŒNAT ä¼šä¿®æ”¹è¯¥æ•°æ®åŒ…çš„&lt;strong>ç›®æ ‡&lt;/strong>åœ°å€å’Œç«¯å£ã€‚&lt;/p>
&lt;p>æ³¨æ„ï¼ŒNAT åªä¼šä¿®æ”¹ IP æŠ¥å¤´çš„åœ°å€å’Œç«¯å£ï¼ˆæ¥æºæˆ–ç›®æ ‡ï¼‰ï¼Œä¸ä¼šä¿®æ”¹ XOR-MAPPED-ADDRESS ä¸­çš„å†…å®¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒNAT åªä¿®æ”¹å¤´éƒ¨ï¼Œä¸ä¿®æ”¹ Payloadã€‚&lt;/p>
&lt;blockquote>
&lt;p>In this way, the client can learn its reflexive transport address allocated by the outermost NAT with respect to the STUN server.&lt;/p>
&lt;/blockquote>
&lt;p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå®¢æˆ·ç«¯å¯ä»¥äº†è§£åˆ°è‡ªå·± æœ€å¤–éƒ¨ NAT ç»™è‡ªå·±åˆ†é…çš„çš„ reflexive transport addressã€‚&lt;/p>
&lt;p>è¿™é‡Œè¯´çš„æœ€å¤–éƒ¨ï¼ŒæŒ‡çš„æ˜¯ç›¸å¯¹äº STUN server çš„æœ€å¤–éƒ¨ã€‚å¥—å¨ƒä½ æ‡‚å§ï¼ŒSTUN server æœ‰å¯èƒ½åœ¨ä¸€ä¸ªéå¸¸å¤§çš„å­ç½‘é‡Œï¼Œè¿™ä¸ªæ—¶å€™å®¢æˆ·ç«¯äº†è§£åˆ°çš„åªæ˜¯ç¦» STUN æœ€è¿‘çš„é‚£ä¸ª NAT åå°„å›çš„åœ°å€ã€‚&lt;/p>
&lt;hr>
&lt;blockquote>
&lt;p>In some usages, STUN must be multiplexed with other protocols (e.g., [MMUSIC-ICE], [SIP-OUTBOUND]). In these usages, there must be a way to inspect a packet and determine if it is a STUN packet or not.&lt;/p>
&lt;/blockquote>
&lt;p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œ STUN å¿…é¡»ä¸å…¶ä»–åè®®å¤ç”¨ï¼ˆæ¯”å¦‚ MMUSIC-ICE, SIP-OUTBOUNDï¼‰ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œå¿…é¡»æœ‰ä¸€ç§æ–¹å¼æ¥æ£€æµ‹æ•°æ®åŒ…æ˜¯å¦ä¸º STUN åè®®ç±»å‹ã€‚&lt;/p>
&lt;blockquote>
&lt;p>STUN provides three fields in the STUN header with fixed values that can be used for this purpose. If this is not sufficient, then STUN packets can also contain a FINGERPRINT value, which can further be used to distinguish the packets.&lt;/p>
&lt;/blockquote>
&lt;p>STUN åœ¨å¤´éƒ¨æä¾›äº†ä¸‰ä¸ªå­—æ®µç”¨äºå…¶ç‰¹æ®Šæƒ…å†µä¸‹æ£€æµ‹åè®®ç±»å‹çš„ç›®çš„ã€‚å¦‚æœè¿™ä¸‰ä¸ªå­—æ®µä»ç„¶ä¸å¤Ÿå®Œæˆæ£€æµ‹å·¥ä½œï¼Œé‚£ä¹ˆ STUN æ•°æ®åŒ…ä¸­è¿˜å¯ä»¥é€šè¿‡åŒ…å« FINGERPRINT å€¼ æ¥è¿›ä¸€æ­¥åŒºåˆ†æ•°æ®åŒ…çš„åè®®ç±»å‹ã€‚&lt;/p>
&lt;hr>
&lt;blockquote>
&lt;p>STUN defines a set of optional procedures that a usage can decide to use, called mechanisms. These mechanisms include DNS discovery, a redirection technique to an alternate server, a fingerprint attribute for demultiplexing, and two authentication and message-integrity exchanges. The authentication mechanisms revolve around the use of a username, password, and message-integrity value. Two authentication mechanisms, the long-term credential mechanism and the short-term credential mechanism, are defined in this specification.&lt;/p>
&lt;/blockquote>
&lt;p>STUN å®šä¹‰äº†ä¸€ç³»åˆ—çš„å¯é€‰æ“ä½œï¼Œç§°ä¸ºæœºåˆ¶ã€‚è¿™äº›æœºåˆ¶åŒ…å«äº†ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>DNSå‘ç°æœºåˆ¶&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¤‡é€‰æœåŠ¡å™¨çš„é‡å®šå‘æœºåˆ¶&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è§£å¤šè·¯å¤ç”¨[^2]çš„ fingerprint å±æ€§æœºåˆ¶&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åŒæˆæƒæœºåˆ¶&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä¿¡æ¯å®Œæ•´æ€§äº¤æ¢æœºåˆ¶&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>å…¶ä¸­ï¼ŒåŒæˆæƒæœºåˆ¶ï¼Œåœ¨æœ¬æ‰‹å†Œä¸­å®šä¹‰ä¸ºé•¿æœŸå‡­æ®æœºåˆ¶å’ŒçŸ­æœŸå‡­æ®æœºåˆ¶ã€‚&lt;/p>
&lt;blockquote>
&lt;p>Each usage specifies the mechanisms allowed with that usage.&lt;/p>
&lt;/blockquote>
&lt;p>ä¸åŒçš„ä½¿ç”¨åœºæ™¯å†³å®šäº†è¿™äº›æœºåˆ¶çš„å…·ä½“ç”¨æ³•ã€‚æ¢å¥è¯è®²ï¼Œä¸åŒçš„ä½¿ç”¨åœºæ™¯è¢«å…è®¸ä½¿ç”¨çš„æœºåˆ¶æ˜¯ä¸åŒçš„ã€‚&lt;/p>
&lt;hr>
&lt;blockquote>
&lt;p>In the long-term credential mechanism, the client and server share a pre-provisioned username and password and perform a digest challenge / response exchange inspired by (but differing in details) to the one defined for HTTP [RFC2617].&lt;/p>
&lt;/blockquote>
&lt;p>åœ¨é•¿æœŸå‡­æ®æœºåˆ¶é‡Œï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å…±äº«ä¸€ä¸ªé¢„å…ˆåˆ†é…å¥½çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œç„¶åæ‰§è¡Œ digest challenge / response exchangeã€‚&lt;/p>
&lt;p>è¿™ä¸ªé•¿æœŸå‡­æ®æœºåˆ¶å—åˆ° RFC 2617 çš„å¯å‘ï¼Œä½†æ˜¯å…·ä½“ç»†èŠ‚ä¸Šä¸ RFC 2617 ä¸åŒã€‚&lt;/p>
&lt;blockquote>
&lt;p>In the short-term credential mechanism, the client and the server exchange a username and password through some out-of-band method prior to the STUN exchange. For example, in the ICE usage [MMUSIC-ICE] the two endpoints use out-of-band signaling to exchange a username and password. These are used to integrity protect and authenticate the request and response. There is no challenge or nonce used.&lt;/p>
&lt;/blockquote>
&lt;p>åœ¨çŸ­æœŸå‡­æ®æœºåˆ¶é‡Œï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åœ¨ STUN äº¤æ¢ ä¹‹å‰ï¼Œé€šè¿‡ä¸€äº› out-of-band çš„æ–¹å¼[^3]æ¥äº¤æ¢ç”¨æˆ·åå’Œå¯†ç ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ ICEä¸­ï¼Œä¸¤ä¸ªç«¯ç‚¹ä½¿ç”¨ out-of-band ä¿¡ä»¤ æ¥äº¤æ¢ç”¨æˆ·åå’Œå¯†ç ã€‚å®ƒä»¬è¢«ç”¨æ¥ä¿è¯æ¶ˆæ¯çš„å®Œæ•´æ€§å’Œå¯¹è¯·æ±‚å’Œå“åº”è¿›è¡Œæˆæƒã€‚æ²¡æœ‰ä½¿ç”¨ challenge æˆ– nonce[^4]ã€‚&lt;/p>
&lt;h2 id="4-æœ¯è¯­-terminology-4-æœ¯è¯­-terminology4-æœ¯è¯­-terminology" >
&lt;div>
&lt;a href="#4-%e6%9c%af%e8%af%ad-terminology-4-%e6%9c%af%e8%af%ad-terminology4-%e6%9c%af%e8%af%ad-terminology">
#
&lt;/a>
&lt;a href="https://www.junyi.dev/posts/rfc5389-stun/#4-æœ¯è¯­-Terminology" title="4. æœ¯è¯­ Terminology">&lt;/a>4. æœ¯è¯­ Terminology
&lt;/div>
&lt;/h2>
&lt;blockquote>
&lt;p>In this document, the key words â€œMUSTâ€, â€œMUST NOTâ€, â€œREQUIREDâ€, â€œSHALLâ€, â€œSHALL NOTâ€, â€œSHOULDâ€, â€œSHOULD NOTâ€, â€œRECOMMENDEDâ€, â€œMAYâ€, and â€œOPTIONALâ€ are to be interpreted as described in BCP 14, RFC 2119 [RFC2119] and indicate requirement levels for compliant STUN implementations.&lt;/p>
&lt;/blockquote>
&lt;p>åœ¨è¿™ä»½æ–‡æ¡£ä¸­ï¼Œâ€œ**&lt;em>å¿…é¡»&lt;/em>&lt;strong>â€ï¼Œâ€œ&lt;/strong>&lt;em>å¿…é¡»ä¸&lt;/em>&lt;strong>â€ï¼Œâ€œ&lt;/strong>&lt;em>å¿…éœ€è¦&lt;/em>&lt;strong>â€ï¼Œâ€œ&lt;/strong>&lt;em>åº”å½“&lt;/em>&lt;strong>â€ï¼Œâ€œ&lt;/strong>&lt;em>ä¸åº”å½“&lt;/em>&lt;strong>â€ï¼Œâ€œ&lt;/strong>&lt;em>æœ€å¥½&lt;/em>&lt;strong>â€ï¼Œâ€œ&lt;/strong>&lt;em>æœ€å¥½ä¸&lt;/em>&lt;strong>â€ï¼Œâ€œ&lt;/strong>&lt;em>å»ºè®®&lt;/em>&lt;strong>â€ï¼Œâ€œ&lt;/strong>&lt;em>æˆ–è®¸&lt;/em>&lt;strong>â€ï¼Œâ€œ&lt;/strong>&lt;em>å¯é€‰&lt;/em>**â€ï¼Œå°†æŒ‰ç…§ BCP 14ï¼ŒRFC 2119 æ¥è§£é‡Šè¯´æ˜ STUN æ‰€éœ€çš„çš„å®ç°çº§åˆ«ã€‚&lt;/p>
&lt;p>å› ä¸ºä¸­è‹±æ–‡å•è¯å·®å¼‚ï¼Œæ‰€ä»¥åœ¨æœ¬ç¿»è¯‘ä¸­ï¼Œæ¶‰åŠåˆ°çš„ä¸Šè¿°è¯æ±‡éƒ½ä¼šç”¨**&lt;em>ç²—ä½“å€¾æ–œä¸‹åˆ’çº¿&lt;/em>**æ¥è¡¨ç¤ºã€‚&lt;/p>
&lt;h2 id="5-å®šä¹‰-definitions-5-å®šä¹‰-definitions5-å®šä¹‰-definitions" >
&lt;div>
&lt;a href="#5-%e5%ae%9a%e4%b9%89-definitions-5-%e5%ae%9a%e4%b9%89-definitions5-%e5%ae%9a%e4%b9%89-definitions">
#
&lt;/a>
&lt;a href="https://www.junyi.dev/posts/rfc5389-stun/#5-å®šä¹‰-Definitions" title="5. å®šä¹‰ Definitions">&lt;/a>5. å®šä¹‰ Definitions
&lt;/div>
&lt;/h2>
&lt;blockquote>
&lt;p>STUN Agent: A STUN agent is an entity that implements the STUN protocol. The entity can be either a STUN client or a STUN server.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>STUN ä»£ç†&lt;/strong>ï¼šä¸€ä¸ªå®ç°äº† STUN åè®®çš„å®ä½“è¢«ç§°ä¸º STUN ä»£ç†ã€‚ï¼ˆæ—¢å¯ä»¥ä¸ºå®¢æˆ·ç«¯åˆå¯ä»¥ä¸ºæœåŠ¡å™¨ï¼‰&lt;/p>
&lt;blockquote>
&lt;p>STUN Client: A STUN client is an entity that sends STUN requests and receives STUN responses. A STUN client can also send indications. In this specification, the terms STUN client and client are synonymous.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>STUN å®¢æˆ·ç«¯&lt;/strong>ï¼šä¸€ä¸ªå¯ä»¥å‘é€ STUN è¯·æ±‚ï¼Œä¸”ï¼Œæ¥å— STUN å“åº”çš„å®ä½“ï¼Œè¢«ç§°ä¸º STUN å®¢æˆ·ç«¯ã€‚STUN å®¢æˆ·ç«¯ä¹Ÿå¯ä»¥å‘é€æŒ‡ç¤º[^5]ã€‚æ‚¨å¯ä»¥ç†è§£ STUN å®¢æˆ·ç«¯å’Œå®¢æˆ·ç«¯æ˜¯åŒä¹‰è¯ã€‚&lt;/p>
&lt;blockquote>
&lt;p>STUN Server: A STUN server is an entity that receives STUN requests and sends STUN responses. A STUN server can also send indications. In this specification, the terms STUN server and server are synonymous.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>STUN æœåŠ¡å™¨&lt;/strong>ï¼šä¸€ä¸ªå¯ä»¥æ¥æ”¶ STUN è¯·æ±‚ï¼Œä¸”ï¼Œå‘é€ STUN å“åº”çš„å®ä½“ï¼Œè¢«ç§°ä¸º STUN æœåŠ¡å™¨ã€‚STUN æœåŠ¡å™¨ä¹Ÿå¯ä»¥å‘é€æŒ‡ç¤º[^5]ã€‚æ‚¨å¯ä»¥ç†è§£ STUN æœåŠ¡å™¨å’ŒæœåŠ¡å™¨æ˜¯åŒä¹‰è¯ã€‚&lt;/p>
&lt;blockquote>
&lt;p>Transport Address: The combination of an IP address and port number (such as a UDP or TCP port number).&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>ä¼ è¾“åœ°å€&lt;/strong>ï¼šIPåœ°å€å’Œç«¯å£çš„ç»„åˆè¢«ç§°ä¸ºä¼ è¾“åœ°å€ã€‚&lt;/p>
&lt;blockquote>
&lt;p>Reflexive Transport Address: A transport address learned by a client that identifies that client as seen by another host on an IP network, typically a STUN server. When there is an intervening NAT between the client and the other host, the reflexive transport address represents the mapped address allocated to the client on the public side of the NAT. Reflexive transport addresses are learned from the mapped address attribute (MAPPED-ADDRESS or XOR-MAPPED-ADDRESS) in STUN responses.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>åå°„æ€§ä¼ è¾“åœ°å€&lt;/strong>ï¼šä¸€ä¸ªå®¢æˆ·ç«¯ä»â€œå…¶ä»–ä¸»æœºâ€é‚£é‡Œäº†è§£åˆ°çš„è‡ªå·±çš„ä¼ è¾“åœ°å€ã€‚ä¸€èˆ¬è¿™ä¸ªâ€œå…¶ä»–ä¸»æœºâ€æŒ‡çš„æ˜¯ STUN æœåŠ¡å™¨ã€‚å½“ NAT å¹²é¢„åœ¨å®¢æˆ·ç«¯ä¸â€œå…¶ä»–ä¸»æœºâ€ä¹‹é—´æ—¶ï¼Œåå°„æ€§ä¼ è¾“åœ°å€ä»£è¡¨äº†è¿™ä¸ªå®¢æˆ·ç«¯åœ¨ NAT çš„å…¬å…±åŒºåŸŸé‚£ä¸€ä¾§è¢«åˆ†é…åˆ°çš„ä¼ è¾“åœ°å€ã€‚è¿™ä¸ªåå°„æ€§ä¼ è¾“åœ°å€è¢«æ”¾åœ¨ STUN å“åº”çš„ MAPPED-ADDRESS æˆ– XOR-MAPPED-ADDRESS é‡Œã€‚&lt;/p>
&lt;p>è®²äººè¯å°±æ˜¯ï¼Œå®¢æˆ·ç«¯æ‹¿åˆ°çš„å…¬ç½‘IPåœ°å€å’Œç«¯å£å·çš„ç»„åˆå°±å«åå°„æ€§ä¼ è¾“åœ°å€ã€‚ï¼ˆä¸ä¸¥è°¨ï¼Œè¦æƒ³ä¸¥è°¨è¿˜æ˜¯å¾—çœ‹ä¸Šé¢çš„å®šä¹‰ï¼‰&lt;/p>
&lt;blockquote>
&lt;p>Mapped Address: Same meaning as reflexive address. This term is retained only for historic reasons and due to the naming of the MAPPED-ADDRESS and XOR-MAPPED-ADDRESS attributes.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>æ˜ å°„åœ°å€&lt;/strong>ï¼šè·Ÿåå°„æ€§ä¼ è¾“åœ°å€ä¸€æ ·ã€‚è¿™æ˜¯ä¸ªå› ä¸ºå†å²åŸå› è€Œä¿ç•™ä¸‹æ¥çš„è¯ã€‚&lt;/p>
&lt;blockquote>
&lt;p>Long-Term Credential: A username and associated password that represent a shared secret between client and server. Long-term credentials are generally granted to the client when a subscriber enrolls in a service and persist until the subscriber leaves the service or explicitly changes the credential.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>é•¿æœŸå‡­æ®&lt;/strong>ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å…±äº«çš„ç”¨æˆ·åå¯†ç ã€‚é•¿æœŸå‡­æ®é€šå¸¸åœ¨è®¢é˜…è€…è®¢é˜…ä¸€ä¸ªæœåŠ¡æ—¶æˆäºˆç»™å®¢æˆ·ç«¯ï¼Œå¹¶ä¸”ä¸€ç›´æŒç»­åˆ°è®¢é˜…è€…é€€å‡ºæœåŠ¡æˆ–æ˜¾å¼æ›´æ”¹å‡­æ®ã€‚&lt;/p>
&lt;blockquote>
&lt;p>Long-Term Password: The password from a long-term credential.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>é•¿æœŸå¯†ç &lt;/strong>ï¼šé•¿æœŸå‡­æ®æ‰€ä½¿ç”¨çš„å¯†ç ã€‚&lt;/p>
&lt;blockquote>
&lt;p>Short-Term Credential: A &lt;strong>temporary&lt;/strong> username and associated password that represent a shared secret between client and server. Short-term credentials are obtained through some kind of protocol mechanism between the client and server, preceding the STUN exchange. A short-term credential has an explicit temporal scope, which may be based on a specific amount of time (such as 5 minutes) or on an event (such as termination of a SIP dialog).&lt;/p>
&lt;p>The specific scope of a short-term credential is defined by the application usage.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>çŸ­æœŸå‡­æ®&lt;/strong>ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å…±äº«çš„&lt;strong>ä¸´æ—¶çš„&lt;/strong>ç”¨æˆ·åå¯†ç ã€‚çŸ­æœŸå‡­æ®ä¸€èˆ¬æ˜¯åœ¨ STUN äº¤æ¢ä¹‹å‰ï¼Œé€šè¿‡æŸç§åè®®æœºåˆ¶è·å¾—çš„ã€‚çŸ­æœŸå‡­æ®æœ‰ä¸€ä¸ªæ˜¾å¼çš„æ—¶é—´èŒƒå›´ï¼Œå¯èƒ½åŸºäºæ—¶é—´é‡ï¼ˆæ¯”å¦‚ 5 åˆ†é’Ÿï¼‰ï¼Œæˆ–ï¼ŒåŸºäºäº‹ä»¶ï¼ˆæ¯”å¦‚ SIP å¯¹è¯çš„ç»ˆæ­¢ï¼‰ã€‚&lt;/p>
&lt;p>å…·ä½“çš„æ—¶é—´èŒƒå›´ï¼Œç”±å…·ä½“çš„åº”ç”¨ç¨‹åºä½¿ç”¨åœºæ™¯å†³å®šã€‚&lt;/p>
&lt;blockquote>
&lt;p>Short-Term Password: The password component of a short-term credential.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>çŸ­æœŸå¯†ç &lt;/strong>ï¼šçŸ­æœŸå‡­æ®æ‰€ä½¿ç”¨çš„å¯†ç ã€‚&lt;/p>
&lt;blockquote>
&lt;p>STUN Indication: A STUN message that does not receive a response.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>STUN æŒ‡ç¤º&lt;/strong>ï¼šä¸€ä¸ªä¸æ¥æ”¶å“åº”çš„ STUN æ¶ˆæ¯ã€‚ï¼ˆè¯´äººè¯å°±æ˜¯åªå‘ä¸æ”¶ï¼Œå°±å‘Šè¯‰ä½ ä¸€å£°ã€‚ï¼‰&lt;/p>
&lt;blockquote>
&lt;p>Attribute: The STUN term for a Type-Length-Value (TLV) object that can be added to a STUN message. Attributes are divided into two types: comprehension-required and comprehension-optional. STUN agents can safely ignore comprehension-optional attributes they donâ€™t understand, but cannot successfully process a message if it contains comprehension-required attributes that are not understood.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>å±æ€§&lt;/strong>ï¼šä¸€ä¸ª TLV å¯¹è±¡å¯ä»¥è¢«é™„åŠ åœ¨ STUN æ¶ˆæ¯é‡Œã€‚ä¸€å…±æœ‰ä¸¤ç§ç±»å‹çš„å±æ€§ï¼šå¿…é¡»è¦ç†è§£çš„å’Œå¯é€‰ç†è§£çš„ã€‚STUN ä»£ç† å¯ä»¥å®‰å…¨çš„å¿½ç•¥é‚£äº›å®ƒä»¬æ— æ³•ç†è§£çš„ã€å¯é€‰ç†è§£çš„å±æ€§ï¼Œä½†æ˜¯æ— æ³•æˆåŠŸå¤„ç†å®ƒä»¬æ— æ³•ç†è§£çš„ã€å¿…é¡»è¦ç†è§£çš„å±æ€§ã€‚&lt;/p>
&lt;blockquote>
&lt;p>RTO: Retransmission TimeOut, which defines the initial period of time between transmission of a request and the first retransmit of that request.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>RTO&lt;/strong>ï¼šé‡ä¼ è¶…æ—¶ã€‚ä¹Ÿå°±æ˜¯ä»è¯·æ±‚ä¼ è¾“åˆ°ç¬¬ä¸€æ¬¡é‡æ–°ä¼ è¾“ä¹‹é—´çš„æ—¶é—´ã€‚&lt;/p>
&lt;h2 id="6-stun-æ¶ˆæ¯ç»“æ„-stun-message-structure-6-stun-æ¶ˆæ¯ç»“æ„-stun-message-structure6-stun-æ¶ˆæ¯ç»“æ„-stun-message-structure" >
&lt;div>
&lt;a href="#6-stun-%e6%b6%88%e6%81%af%e7%bb%93%e6%9e%84-stun-message-structure-6-stun-%e6%b6%88%e6%81%af%e7%bb%93%e6%9e%84-stun-message-structure6-stun-%e6%b6%88%e6%81%af%e7%bb%93%e6%9e%84-stun-message-structure">
#
&lt;/a>
&lt;a href="https://www.junyi.dev/posts/rfc5389-stun/#6-STUN-æ¶ˆæ¯ç»“æ„-STUN-Message-Structure" title="6. STUN æ¶ˆæ¯ç»“æ„ STUN Message Structure">&lt;/a>6. STUN æ¶ˆæ¯ç»“æ„ STUN Message Structure
&lt;/div>
&lt;/h2>
&lt;blockquote>
&lt;p>STUN messages are encoded in binary using network-oriented format (most significant byte or octet first, also commonly known as big-endian). The transmission order is described in detail in Appendix B of RFC 791 [RFC0791]. Unless otherwise noted, numeric constants are in decimal (base 10).&lt;/p>
&lt;/blockquote>
&lt;p>STUN æ¶ˆæ¯ä½¿ç”¨ MSB çš„äºŒè¿›åˆ¶æ ¼å¼ç¼–ç ï¼ˆbig-endianï¼‰ã€‚ä¼ è¾“é¡ºåºåœ¨ RFC 791 çš„ Appendix B ä¸­æœ‰è¯¦ç»†æè¿°ã€‚é™¤äº†ç‰¹åˆ«æ³¨æ˜ä¹‹å¤–ï¼Œæ•°å­—å¸¸é‡éƒ½ä»¥ 10 è¿›åˆ¶è¡¨ç¤ºã€‚&lt;/p>
&lt;blockquote>
&lt;p>All STUN messages MUST start with a 20-byte header followed by zero or more &lt;strong>Attributes&lt;/strong>. The STUN header contains a STUN message type, magic cookie, transaction ID, and message length.&lt;/p>
&lt;/blockquote>
&lt;p>æ‰€æœ‰çš„ STUN æ¶ˆæ¯ &lt;strong>&lt;em>å¿…é¡»&lt;/em>&lt;/strong> ä»¥ 20-byte é•¿åº¦çš„å¤´éƒ¨å¼€å§‹ï¼Œç´§è·Ÿç€ 0 ä¸ª æˆ– å¤šä¸ª&lt;strong>å±æ€§&lt;/strong>ã€‚STUN å¤´éƒ¨åŒ…å«äº† STUN æ¶ˆæ¯ç±»å‹ã€magic cookieã€äº‹åŠ¡IDã€æ¶ˆæ¯é•¿åº¦ã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-none" data-lang="none"> 0 1 2 3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0 0| STUN Message Type | Message Length |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Magic Cookie |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| |
| Transaction ID (96 bits) |
| |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Figure 2: Format of STUN Message Header
&lt;/code>&lt;/pre>&lt;blockquote>
&lt;p>The most significant 2 bits of every STUN message MUST be zeroes. This can be used to differentiate STUN packets from other protocols when STUN is multiplexed with other protocols on the same port.&lt;/p>
&lt;/blockquote>
&lt;p>æ¯æ¡ STUN æ¶ˆæ¯ çš„æœ€é«˜ 2 bit &lt;strong>&lt;em>å¿…é¡»&lt;/em>&lt;/strong> ä¸ºé›¶ã€‚è¿™å¯ä»¥åœ¨ STUN ä¸å…¶ä»–åè®®åœ¨åŒä¸€ç«¯å£å¤ç”¨æ—¶ï¼ŒåŒºåˆ† STUN æ•°æ®åŒ…ã€‚&lt;/p>
&lt;blockquote>
&lt;p>The message type defines the message class (request, success response, failure response, or indication) and the message method (the primary function) of the STUN message. Although there are four message classes, there are only two types of transactions in STUN: request/response transactions (which consist of a request message and a response message) and indication transactions (which consist of a single &lt;strong>indication&lt;/strong> message). Response classes are split into error and success responses to aid in quickly processing the STUN message.&lt;/p>
&lt;/blockquote>
&lt;p>STUN æ¶ˆæ¯ç±»å‹å®šä¹‰äº†æ¶ˆæ¯æ‰€å±çš„ç±»ï¼ˆè¯·æ±‚ï¼ŒæˆåŠŸçš„å“åº”ï¼Œå¤±è´¥çš„å“åº”ï¼ŒæŒ‡ç¤ºï¼‰ï¼Œå’Œï¼Œä¸€æ¡ STUN æ¶ˆæ¯çš„æ–¹æ³•ï¼ˆä¸»è¦åŠŸèƒ½ï¼‰[^6]&lt;/p>
&lt;p>å°½ç®¡æœ‰å››ç§æ¶ˆæ¯æ‰€å±çš„ç±»ï¼Œä½†åœ¨ STUN ä¸­åªæœ‰ä¸¤ç§äº‹åŠ¡ç±»å‹ï¼šè¯·æ±‚/å“åº”å‹äº‹åŠ¡ï¼ˆåŒ…å«è¯·æ±‚æ¶ˆæ¯å’Œå“åº”æ¶ˆæ¯ï¼‰ï¼Œå’Œï¼ŒæŒ‡ç¤ºå‹äº‹åŠ¡ï¼ˆåŒ…å«å•ç‹¬çš„ä¸€æ¡&lt;strong>STUN æŒ‡ç¤º&lt;/strong>[^7]æ¶ˆæ¯ï¼‰ã€‚å“åº”ç±»è¢«åˆ’åˆ†ä¸ºå¤±è´¥çš„å“åº”å’ŒæˆåŠŸçš„å“åº”ï¼Œç›®çš„æ˜¯å¸®åŠ©å¿«é€Ÿå¤„ç† STUN æ¶ˆæ¯ã€‚&lt;/p>
&lt;p>æ›´ç›´è§‚ä¸€ç‚¹æ¥è®²ï¼š&lt;/p>
&lt;ul>
&lt;li>Transaction Typeï¼šè¯·æ±‚/å“åº”å‹äº‹åŠ¡
&lt;ul>
&lt;li>Message Typeï¼šè¯·æ±‚&lt;/li>
&lt;li>Message Typeï¼šæˆåŠŸçš„å“åº”&lt;/li>
&lt;li>Message Typeï¼šå¤±è´¥çš„å“åº”&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Transaction Typeï¼šæŒ‡ç¤ºå‹äº‹åŠ¡
&lt;ul>
&lt;li>Message Typeï¼šæŒ‡ç¤º&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>The message type field is decomposed further into the following structure:&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>STUN Message Type&lt;/strong> å­—æ®µè¢«åˆ†è§£æˆä»¥ä¸‹ç»“æ„ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-none" data-lang="none"> 0 1
2 3 4 5 6 7 8 9 0 1 2 3 4 5
+--+--+-+-+-+-+-+-+-+-+-+-+-+-+
|M |M |M|M|M|C|M|M|M|C|M|M|M|M|
|11|10|9|8|7|1|6|5|4|0|3|2|1|0|
+--+--+-+-+-+-+-+-+-+-+-+-+-+-+
Figure 3: Format of STUN Message Type Field
&lt;/code>&lt;/pre>&lt;blockquote>
&lt;p>Here the bits in the message type field are shown as most significant (M11) through least significant (M0). M11 through M0 represent a 12-bit encoding of the method. C1 and C0 represent a 2-bit encoding of the class. A class of 0b00 is a request, a class of 0b01 is an indication, a class of 0b10 is a success response, and a class of 0b11 is an error response. This specification defines a single method, Binding. &lt;strong>The method and class are orthogonal, so that for each method, a request, success response, error response, and indication are possible for that method.&lt;/strong> Extensions defining new methods MUST indicate which classes are permitted for that method.&lt;/p>
&lt;/blockquote>
&lt;p>Message Type å­—æ®µä»æœ€é«˜æœ‰æ•ˆä½ï¼ˆM11ï¼‰å¼€å§‹åˆ°æœ€ä½æœ‰æ•ˆä½ï¼ˆM0ï¼‰ç»“æŸã€‚M11 åˆ° M0 ä¸€å…±æ˜¯ 12-bitï¼Œè¿™12ä¸ªbitç¼–ç äº†æ–¹æ³•ã€‚ C1 å’Œ C- è¡¨ç¤ºç±»ï¼Œç”±2ä¸ªbitç»„æˆã€‚0b00 è¡¨ç¤ºä¸€ä¸ªè¯·æ±‚ï¼Œ0b01 è¡¨ç¤ºä¸€ä¸ªæŒ‡ç¤ºï¼Œ0b10 è¡¨ç¤ºä¸€ä¸ªæˆåŠŸçš„å“åº”ï¼Œ0b11 è¡¨ç¤ºä¸€ä¸ªå¤±è´¥çš„å“åº”ã€‚&lt;/p>
&lt;p>å½“å‰æ–‡æ¡£é‡Œå®šä¹‰äº†ä¸€ä¸ªå•ç‹¬çš„æ–¹æ³•ï¼ŒBingdingã€‚æ–¹æ³•å’Œç±»æ˜¯??æ­£äº¤??çš„å…³ç³»ï¼Œ&lt;strong>å› æ­¤å¯¹äºæ¯ä¸ªæ–¹æ³•ï¼Œéƒ½è¦æœ‰è¯·æ±‚ã€æŒ‡ç¤ºã€æˆåŠŸçš„å“åº”ã€å¤±è´¥çš„å“åº”ã€‚&lt;/strong>&lt;/p>
&lt;p>å®šä¹‰æ–°çš„æ‰©å±•æ–¹æ³•æ—¶ &lt;strong>&lt;em>å¿…é¡»&lt;/em>&lt;/strong> æŒ‡æ˜å…è®¸å“ªäº›ç±»&lt;/p>
&lt;blockquote>
&lt;p>For example, a Binding request has class=0b00 (request) and method=0b000000000001 (Binding) and is encoded into the first 16 bits as 0x0001. A Binding response has class=0b10 (success response) and method=0b000000000001, and is encoded into the first 16 bits as 0x0101.&lt;/p>
&lt;/blockquote>
&lt;p>ä¾‹å¦‚ï¼Œä¸€ä¸ª Binding æ–¹æ³•çš„è¯·æ±‚çš„ç±»çš„ç¼–ç ä¸º 0b00ï¼Œæ–¹æ³•å·ä¸º 0b000000000001ã€‚å‰16ä¸ªbitçš„åå…­è¿›åˆ¶ç¼–ç ä¸º 0x0001ã€‚Binding æ–¹æ³•çš„å“åº”çš„ç±»çš„ç¼–ç ä¸º 0b10ï¼Œæ–¹æ³•å·åŒæ ·ä¸º 0b000000000001ï¼Œå‰16ä¸ªbitçš„åå…­è¿›åˆ¶ç¼–ç ä¸º 0x0101ã€‚&lt;/p>
&lt;p>è¯‘è€…è¡¥å……ï¼šæ³¨æ„ï¼Œæ‚¨å¯èƒ½ä¼šå¥½å¥‡ï¼Œç±»çš„ç¼–ç é•¿åº¦ä¸º2bitï¼Œæ–¹æ³•ç¼–ç é•¿åº¦ä¸º12bitï¼ŒåŠ èµ·æ¥ä¸€å…±14bitï¼Œä¸ºä»€ä¹ˆè¿™é‡Œè¯´å‰16bitå‘¢ï¼ŸåŸå› æ˜¯ï¼Œè¿™é‡Œè¯´çš„å‰16ä¸ªbitï¼ŒæŒ‡çš„æ˜¯ STUN æ¶ˆæ¯ï¼ˆæˆ–ç€è¯´ STUN æ•°æ®åŒ…ï¼‰çš„å‰16bitï¼Œå¯¹äºä¸€ä¸ª STUN æ¶ˆæ¯ï¼Œæœ€é«˜ä½çš„ 2bit æ˜¯è¢«ä¿ç•™çš„ï¼Œè¿˜è®°å¾—å—ï¼Ÿ&lt;/p>
&lt;blockquote>
&lt;p>Note: This unfortunate encoding is due to assignment of values in [RFC3489] that did not consider encoding Indications, Success, and Errors using bit fields.&lt;/p>
&lt;/blockquote>
&lt;p>è¯·æ³¨æ„ï¼š&lt;/p>
&lt;p>The magic cookie field MUST contain the fixed value 0x2112A442 in network byte order. In RFC 3489 [RFC3489], this field was part of the transaction ID; placing the magic cookie in this location allows a server to detect if the client will understand certain attributes that were added in this revised specification. In addition, it aids in distinguishing STUN packets from packets of other protocols when STUN is multiplexed with those other protocols on the same port.&lt;/p>
&lt;p>[^1]: è¿˜è®°å¾—å—ï¼Œäº‹åŠ¡IDæ˜¯ä¸€ä¸ªéšæœºé€‰æ‹©çš„ 96ä½ çš„æ•°å­—
[^2]: è§£å¤šè·¯å¤ç”¨å°±æ˜¯ä¸å¤šè·¯å¤ç”¨çš„ä½œç”¨ç›¸åçš„ä¸€ä¸ªè¿‡ç¨‹
[^3]: In &lt;a href="https://en.wikipedia.org/wiki/Computer_networking">computer networking&lt;/a>, &lt;strong>out-of-band data&lt;/strong> is the data transferred through a stream that is independent from the main &lt;em>in-band&lt;/em> data stream.
[^4]: åœ¨è³‡è¨Šå®‰å…¨ä¸­ï¼ŒNonceæ˜¯ä¸€å€‹åœ¨åŠ å¯†é€šè¨Šåªèƒ½ä½¿ç”¨ä¸€æ¬¡çš„æ•¸å­—ã€‚åœ¨èªè­‰å”å®šä¸­ï¼Œå®ƒå¾€å¾€æ˜¯ä¸€å€‹éš¨æ©Ÿæˆ–å½éš¨æ©Ÿæ•¸ï¼Œä»¥é¿å…é‡é€æ”»æ“Šã€‚
[^5]: indicatino åœ¨ indication transaction ä¸­è¢«å‘é€ã€‚ æŒ‡ç¤º åœ¨ æŒ‡ç¤ºå‹äº‹åŠ¡ ä¸­è¢«å‘é€
[^6]: The method indicates which of the various requests or indications this is. æ–¹æ³•è¡¨ç¤ºè¿™æ˜¯å“ªç§è¯·æ±‚ï¼Œæˆ–ï¼Œè¿™æ˜¯å“ªç§æŒ‡ç¤ºã€‚
[^7]: ä¸€ä¸ªä¸æ¥æ”¶å“åº”çš„ STUN æ¶ˆæ¯ã€‚ï¼ˆè¯´äººè¯å°±æ˜¯åªå‘ä¸æ”¶ï¼Œå°±å‘Šè¯‰ä½ ä¸€å£°ã€‚ï¼‰&lt;/p>
&lt;h1 id="2023å¹´8æœˆ23æ—¥æ³¨" >
&lt;div>
&lt;a href="#2023%e5%b9%b48%e6%9c%8823%e6%97%a5%e6%b3%a8">
##
&lt;/a>
2023å¹´8æœˆ23æ—¥æ³¨
&lt;/div>
&lt;/h1>
&lt;p>ä¹‹å‰å†™äº†å¥½å¤šæ ¼å¼ï¼Œç°åœ¨ä¸æ”¯æŒï¼Œå“
ç­‰å“ªå¤©æœ‰ç©ºäº†æŠŠæºä»£ç æ‰¾å‡ºæ¥ã€‚ã€‚ã€‚&lt;/p></description></item><item><title>P2P æŠ€æœ¯</title><link>/posts/p2p/</link><pubDate>Fri, 26 Jun 2020 13:06:35 +0800</pubDate><author>junyi.h@comp.nus.edu.sg (Junyi Hou)</author><guid>/posts/p2p/</guid><description>&lt;p>æœ¬æ–‡ä¸»è¦è®°å½•è‡ªå·±å­¦ä¹ çš„ P2P æŠ€æœ¯&lt;/p>
&lt;p>åœ¨è¿™ç¯‡æ–‡ç« é‡Œï¼Œä¸»è¦åŒºåˆ†äº†å„ç§ NAT çš„ç±»å‹ï¼ŒåŒ…æ‹¬å…¨é”¥å½¢ã€åœ°å€é™åˆ¶é”¥å½¢ã€ç«¯å£é™åˆ¶é”¥å½¢çš„å†…å®¹å’ŒåŒºåˆ«&lt;/p>
&lt;h2 id="ç½‘ç»œåœ°å€è½¬æ¢-nat-network-address-translation" >
&lt;div>
&lt;a href="#%e7%bd%91%e7%bb%9c%e5%9c%b0%e5%9d%80%e8%bd%ac%e6%8d%a2-nat-network-address-translation">
#
&lt;/a>
ç½‘ç»œåœ°å€è½¬æ¢ NAT (Network Address Translation)
&lt;/div>
&lt;/h2>
&lt;h3 id="åŸºæœ¬ç½‘ç»œåœ°å€è½¬æ¢-basic-nat" >
&lt;div>
&lt;a href="#%e5%9f%ba%e6%9c%ac%e7%bd%91%e7%bb%9c%e5%9c%b0%e5%9d%80%e8%bd%ac%e6%8d%a2-basic-nat">
##
&lt;/a>
åŸºæœ¬ç½‘ç»œåœ°å€è½¬æ¢ Basic NAT
&lt;/div>
&lt;/h3>
&lt;p>ç®€å•æ¥è®²ï¼Œå°±æ˜¯ç›´æ¥æŠŠå†…éƒ¨ IP ç¿»è¯‘æˆå¤–éƒ¨ IPï¼Œè¿™ç§è½¬æ¢æŠ€æœ¯å—é™äºå¯¹å¤–åœ°å€çš„æ•°é‡ï¼Œæ˜¯ IP åˆ° IP çš„è½¬æ¢ï¼ˆç«¯å£ä¸æ¢ï¼‰&lt;/p>
&lt;p>éœ€è¦äº†è§£çš„åè¯æœ‰ï¼š&lt;/p>
&lt;ul>
&lt;li>SNATï¼šæºåœ°å€è½¬æ¢&lt;/li>
&lt;li>DNATï¼šç›®æ ‡åœ°å€è½¬æ¢&lt;/li>
&lt;/ul>
&lt;p>ä»¥åªæœ‰ä¸€ä¸ªå¯¹å¤–åœ°å€ä¸¾ä¾‹ï¼Œå¦‚æœ ClientA å’Œ ClientB åŒæ—¶è®¿é—®åŒä¸€ä¸ª Web Serverï¼Œé‚£ä¹ˆå½“ NAT Gatway æ”¶åˆ°è¿™ä¸ª Web Server å“åº”åŒ…çš„æ—¶å€™ï¼Œå°±æ— æ³•åˆ¤æ–­å°†æ•°æ®åŒ…è½¬å‘ç»™å“ªå°å®¢æˆ·æœºã€‚&lt;/p>
&lt;p>äºæ˜¯å°±æœ‰äº†æˆ‘ä»¬æ¥ä¸‹æ¥è¦ä»‹ç»çš„ NAPT æŠ€æœ¯&lt;/p>
&lt;h3 id="ç½‘ç»œåœ°å€ç«¯å£è½¬æ¢-napt" >
&lt;div>
&lt;a href="#%e7%bd%91%e7%bb%9c%e5%9c%b0%e5%9d%80%e7%ab%af%e5%8f%a3%e8%bd%ac%e6%8d%a2-napt">
##
&lt;/a>
ç½‘ç»œåœ°å€ç«¯å£è½¬æ¢ NAPT
&lt;/div>
&lt;/h3>
&lt;p>å…ˆæ˜ç¡®å‡ ä¸ªæ¦‚å¿µï¼š&lt;/p>
&lt;p>å†…ç½‘ä¸»æœºæ‹¥æœ‰çš„ç½‘ç»œåœ°å€ï¼š&lt;code>(LocalIP:LocalPort)&lt;/code>&lt;/p>
&lt;p>ç»ç”± NAT è½¬æ¢åçš„ç½‘ç»œåœ°å€ï¼š&lt;code>(PublicIP:PublicPort)&lt;/code>&lt;/p>
&lt;p>å¤–ç½‘ä¸»æœºæ‹¥æœ‰çš„ç½‘ç»œåœ°å€ï¼š&lt;code>(RemoteIP:RemotePort)&lt;/code>&lt;/p>
&lt;p>å¯¹&lt;code>æºç«¯å£&lt;/code>å’Œ&lt;code>ç›®æ ‡ç«¯å£&lt;/code>åŒæ—¶è¿›è¡Œè½¬æ¢ã€‚è¿™æ ·å°±å¯ä»¥è®©&lt;code>ä¸€ä¸ªå…¬ç½‘IP&lt;/code>æ»¡è¶³&lt;code>å¤šä¸ªåç«¯ä¸»æœº&lt;/code>åŒæ—¶è®¿é—®å¤–éƒ¨ç½‘ç»œã€‚æ¯”å¦‚å®¶åº­å®½å¸¦ã€‚&lt;/p>
&lt;p>è¿™é¡¹æŠ€æœ¯æœ€ä¸ºå¸¸è§ï¼Œå®ƒæ£€æµ‹å¹¶ä¿®æ”¹å‡ºå…¥æ•°æ®åŒ…çš„&lt;strong>IP åœ°å€&lt;/strong>å’Œ&lt;strong>ç«¯å£å·&lt;/strong>ï¼Œä»è€Œå…è®¸å¤šä¸ªå†…ç½‘ä¸»æœºå…±äº«åŒä¸€ä¸ªå…¬ç½‘ IP åœ°å€&lt;/p>
&lt;p>NAT åˆ†ä¸º &lt;code>é”¥å½¢NAT&lt;/code> å’Œ &lt;code>å¯¹ç§°å‹NAT&lt;/code>&lt;/p>
&lt;h2 id="é”¥å½¢-nat" >
&lt;div>
&lt;a href="#%e9%94%a5%e5%bd%a2-nat">
#
&lt;/a>
é”¥å½¢ NAT
&lt;/div>
&lt;/h2>
&lt;p>&lt;strong>åŒä¸€ä¸ªå†…éƒ¨ä¸»æœºçš„åœ°å€å’Œç«¯å£ï¼Œæ— è®ºç›®çš„åœ°å€æ˜¯å¦ç›¸åŒï¼ŒNAT éƒ½å°†å®ƒè½¬æ¢æˆåŒä¸€ä¸ªå¤–éƒ¨åœ°å€å’Œç«¯å£ã€‚&lt;/strong>&lt;/p>
&lt;p>192.168.1.2:8000 è®¿é—® Baidu.com:80 å’Œ google.com:80 æ—¶ï¼Œç»ç”± NAT è½¬æ¢ï¼Œå†…éƒ¨çš„ 192.168.1.2:8000 éƒ½ä¼šè¢«è½¬åŒ–æˆ 1.2.3.4:5000ï¼Œbaidu çœ‹åˆ°çš„æ˜¯ 5000 ç«¯å£ï¼Œè°·æ­Œçœ‹åˆ°çš„ä¹Ÿæ˜¯&lt;/p>
&lt;p>192.168.1.2:&lt;strong>8001&lt;/strong> è®¿é—® baidu.com:80 å’Œ google.com:80 æ—¶ï¼Œç»ç”± NAT è½¬æ¢ï¼Œå†…éƒ¨çš„ 192.168.1.2:8001 éƒ½ä¼šå˜æˆ 1.2.3.4:&lt;strong>5001&lt;/strong>ï¼Œbaidu çœ‹åˆ°çš„æ˜¯ &lt;strong>5001&lt;/strong> ç«¯å£ï¼Œgoogle çœ‹åˆ°çš„ä¹Ÿæ˜¯ã€‚&lt;/p>
&lt;p>æ‡‚äº†å—ï¼Œè¿™å°±æ˜¯é”¥å½¢çš„ç”±æ¥&lt;/p>
&lt;h2 id="å…¨é”¥å½¢-nat-full-cone-nat" >
&lt;div>
&lt;a href="#%e5%85%a8%e9%94%a5%e5%bd%a2-nat-full-cone-nat">
#
&lt;/a>
å…¨é”¥å½¢ NAT (Full Cone NAT)
&lt;/div>
&lt;/h2>
&lt;p>å†…å‘å¤–ï¼š&lt;code>(ç‰¹å®šæœ¬åœ°IP:ç‰¹å®šæœ¬åœ°ç«¯å£)&lt;/code> â€“&amp;gt; &lt;code>(å›ºå®šæ˜ å°„IP:å›ºå®šæ˜ å°„ç«¯å£)&lt;/code> â€“&amp;gt; &lt;code>(ç‰¹å®šè¿œç«¯IP:ç‰¹å®šè¿œç«¯ç«¯å£)&lt;/code>&lt;/p>
&lt;p>å»ºç«‹ Full Cone NAT è½¬æ¢å&lt;/p>
&lt;p>å¤–å‘å†…ï¼š&lt;code>(ç‰¹å®šæœ¬åœ°IP:ç‰¹å®šæœ¬åœ°ç«¯å£)&lt;/code> &amp;lt;â€“ &lt;code>(å›ºå®šæ˜ å°„IP:å›ºå®šæ˜ å°„ç«¯å£)&lt;/code> &amp;lt;â€“ &lt;code>(ä»»æ„è¿œç«¯IP:ä»»æ„ç«¯å£)&lt;/code>&lt;/p>
&lt;p>å½“å†…éƒ¨ä¸»æœºå‘å¤–å‘é€è¯·æ±‚æ—¶ï¼ŒNAT ç½‘å…³ä¼šæ‰“å¼€ä¸€ä¸ªç«¯å£åˆ›å»ºä¸€ä¸ªå…¬ç½‘æ˜ å°„ï¼Œå½¢æˆä¸€ä¸ª IP ç«¯å£å…ƒç»„ï¼Œç„¶åä¼šå°†ä¼ å…¥è¿™ä¸ªç«¯å£çš„æ•°æ®å…¨éƒ¨è½¬å‘ç»™å†…éƒ¨ä¸»æœºã€‚&lt;strong>ä¸€æ—¦æ˜ å°„å»ºç«‹ï¼Œé‚£ä¹ˆä»»æ„ä¸€å°ä¸»æœºï¼Œåªè¦ç»™æ˜ å°„å‡ºæ¥çš„å…¬ç½‘ IP å’Œç«¯å£å‘é€æ•°æ®ï¼Œå°±å¯ä»¥ç›´æ¥åˆ°è¾¾åç«¯æœåŠ¡&lt;/strong>ï¼š&lt;/p>
&lt;p>ä¹Ÿå°±æ˜¯ï¼Œå†…éƒ¨ä¸»æœºä»¥ç›¸åŒçš„ &lt;code>(LocalIP:LocalPort)&lt;/code> å¯¹ 2 ä¸ªä¸åŒçš„ &lt;code>(RemoteIP:RemotePort)&lt;/code> å‘é€ UDP æŠ¥æ–‡æ—¶ï¼ŒNAT ä¼šä¸ºå†…éƒ¨ä¸»æœºåªåˆ†é…ä¸€ä¸ª &lt;code>(PublicIP:PublicPort)&lt;/code>ï¼Œ&lt;strong>ä»»æ„ä¸€å°ä¸»æœºéƒ½å¯ä»¥ç»™ &lt;code>(PublicIP:PublicPort)&lt;/code> å‘é€æ•°æ®&lt;/strong>ã€‚&lt;/p>
&lt;h2 id="åœ°å€é™åˆ¶é”¥å½¢-nat-address-restricted-cone-nat" >
&lt;div>
&lt;a href="#%e5%9c%b0%e5%9d%80%e9%99%90%e5%88%b6%e9%94%a5%e5%bd%a2-nat-address-restricted-cone-nat">
#
&lt;/a>
åœ°å€é™åˆ¶é”¥å½¢ NAT (Address Restricted Cone NAT)
&lt;/div>
&lt;/h2>
&lt;p>è¿œç«¯ IP åœ°å€å—é™ï¼Œè¿œç«¯ç«¯å£æ— æ‰€è°“&lt;/p>
&lt;p>å†…å‘å¤–ï¼š&lt;code>(ç‰¹å®šæœ¬åœ°IP:ç‰¹å®šæœ¬åœ°ç«¯å£)&lt;/code> â€“&amp;gt; &lt;code>(å›ºå®šæ˜ å°„IP:å›ºå®šæ˜ å°„ç«¯å£)&lt;/code> â€“&amp;gt; &lt;code>(ç‰¹å®šè¿œç«¯IP:ç‰¹å®šè¿œç«¯ç«¯å£)&lt;/code>&lt;/p>
&lt;p>å»ºç«‹ Address Restricted Cone NAT è½¬æ¢å&lt;/p>
&lt;p>å¤–å‘å†…ï¼š&lt;code>(ç‰¹å®šæœ¬åœ°IP:ç‰¹å®šæœ¬åœ°ç«¯å£)&lt;/code> &amp;lt;â€“ &lt;code>(å›ºå®šæ˜ å°„IP:å›ºå®šæ˜ å°„ç«¯å£)&lt;/code> &amp;lt;â€“ &lt;code>(ç‰¹å®šè¿œç«¯IP:ä»»æ„ç«¯å£)&lt;/code>&lt;/p>
&lt;p>ï¼ˆæ³¨æ„è¿™é‡Œå˜æˆäº† &lt;strong>ä»»æ„&lt;/strong>ç«¯å£ï¼‰&lt;/p>
&lt;p>æˆ‘æ›´å–œæ¬¢å®ƒçš„è‹±æ–‡å½¢å¼ï¼Œä¸­æ–‡ç¿»è¯‘çš„å¾ˆä¸æ°å½“ã€‚è‹±æ–‡å«&lt;strong>åœ°å€å—é™çš„é”¥å½¢ NAT&lt;/strong>ã€‚å½“å†…éƒ¨ä¸»æœºå‘å¤–å‘é€è¯·æ±‚æ—¶ï¼ŒNAT ç½‘å…³ä¼šæ‰“å¼€ä¸€ä¸ªç«¯å£åˆ›å»ºä¸€ä¸ªå…¬ç½‘æ˜ å°„ï¼Œ&lt;strong>åŒæ—¶è®°å½•å¤–ç½‘çš„ IP åœ°å€&lt;/strong>ã€‚ä¸€æ—¦æ˜ å°„å»ºç«‹ï¼Œ&lt;strong>åªæœ‰è¢«è®°å½•çš„ IP åœ°å€ç»™æ˜ å°„å‡ºæ¥çš„å…¬ç½‘ IP å’Œç«¯å£å‘é€æ•°æ®ï¼Œæ‰å¯ä»¥åˆ°è¾¾åç«¯æœåŠ¡ï¼Œå…¶ä»– IP åœ°å€å‘é€ç»™ NAT ç½‘å…³çš„ï¼Œå°†ä¼šè¢«ä¸¢å¼ƒã€‚&lt;/strong>&lt;/p>
&lt;p>ä¹Ÿå°±æ˜¯ï¼Œå†…éƒ¨ä¸»æœºä»¥ç›¸åŒçš„ (LocalIP:LocalPort) å¯¹ 2 ä¸ªä¸åŒçš„ (RemoteIP:RemotePort) å‘é€ UDP æŠ¥æ–‡æ—¶ï¼ŒNAT ä¼šä¸ºå†…éƒ¨ä¸»æœºåªåˆ†é…ä¸€ä¸ª &lt;code>(PublicIP:PublicPort)&lt;/code>ï¼ŒåŒæ—¶ï¼Œä¹Ÿåªæœ‰è¿™ 2 ä¸ª RemoteIP å¯ä»¥ç»™ (PublicIP: PublicPort) å‘é€æ•°æ®ï¼ˆå› ä¸ºå…ˆç”±å†…å‘å¤–å‘è¿‡ï¼‰ï¼Œè¿™ä¸¤ä¸ª RemoteIP çš„ RemotePort å¯ä»¥æ˜¯ä»»æ„çš„&lt;/p>
&lt;h2 id="ç«¯å£é™åˆ¶é”¥å½¢-nat-port-restricted-cone-nat" >
&lt;div>
&lt;a href="#%e7%ab%af%e5%8f%a3%e9%99%90%e5%88%b6%e9%94%a5%e5%bd%a2-nat-port-restricted-cone-nat">
#
&lt;/a>
ç«¯å£é™åˆ¶é”¥å½¢ NAT (Port Restricted Cone NAT)
&lt;/div>
&lt;/h2>
&lt;p>è¿œç«¯ IP åœ°å€å’Œç«¯å£éƒ½å—é™ï¼Œä¸”åªæœ‰å†…éƒ¨ä¸»æœºå‘å¤–å‘é€è¿‡æ¶ˆæ¯æ‰å¯ä»¥å»ºç«‹ã€‚&lt;/p>
&lt;p>ä¸€æ—¦å†…éƒ¨åœ°å€ï¼ˆiAddr:iPortï¼‰æ˜ å°„åˆ°å¤–éƒ¨åœ°å€ï¼ˆeAddr:ePortï¼‰ï¼Œæ‰€æœ‰å‘è‡ª iAddr:iPort çš„æ•°æ®åŒ…éƒ½ç»ç”± eAddr:ePort å‘å¤–å‘é€ã€‚&lt;/p>
&lt;p>å†…å‘å¤–ï¼š(ç‰¹å®šæœ¬åœ° IP:ç‰¹å®šæœ¬åœ°ç«¯å£) â€“&amp;gt;(å›ºå®šæ˜ å°„ IP:å›ºå®šæ˜ å°„ç«¯å£) â€“&amp;gt; (ç‰¹å®šè¿œç«¯ IP:ç‰¹å®šè¿œç«¯ç«¯å£)&lt;/p>
&lt;p>å»ºç«‹ Port Restricted Cone NAT è½¬æ¢å&lt;/p>
&lt;p>å¤–å‘å†…ï¼š(ç‰¹å®šæœ¬åœ° IP:ç‰¹å®šæœ¬åœ°ç«¯å£) &amp;lt;â€“ (å›ºå®šæ˜ å°„ IP:å›ºå®šæ˜ å°„ç«¯å£) &amp;lt;â€“ (ç‰¹å®šè¿œç«¯ IP:ç‰¹å®šç«¯å£)&lt;/p>
&lt;p>ï¼ˆæ³¨æ„è¿™é‡Œå˜æˆäº† &lt;strong>ç‰¹å®š&lt;/strong>ç«¯å£ï¼‰&lt;/p>
&lt;p>è¿™ç§æ¨¡å¼åŒæ—¶è®°å½•&lt;strong>å†…éƒ¨ä¸»æœºçš„ IP å’Œç«¯å£&lt;/strong>å’Œ&lt;strong>å¤–éƒ¨ä¸»æœºçš„ IP å’Œç«¯å£&lt;/strong>ï¼Œä¹Ÿå°±æ˜¯å½¢æˆäº†ä¸€ç§ç»‘å®šå…³ç³»ã€‚&lt;/p>
&lt;p>ä¸ Address Restricted Cone NAT çš„åŒºåˆ«æ˜¯ï¼ŒAddress Restricted Cone NAT è®°å½•çš„åªæœ‰å¤–ç½‘ä¸»æœºçš„ IPï¼Œä¸è®°å½•ç«¯å£ï¼Œé‚£ä¸ªå¤–ç½‘ä¸»æœºçš„éšä¾¿ä¸€ä¸ªç«¯å£ç»™å†…ç½‘ä¸»æœºå‘é€æ•°æ®éƒ½å¯ä»¥ã€‚&lt;/p>
&lt;p>Port Restricted Cone NAT æ˜¯è®°å½•å¤–ç½‘ä¸»æœºçš„ IP å’Œç«¯å£ï¼Œ&lt;strong>åªæœ‰ (å†…ç½‘ IP, å†…ç½‘ç«¯å£) å’Œ (å¤–ç½‘ IP, å¤–ç½‘ç«¯å£) è¿™ä¸¤ä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³ï¼Œæ•°æ®æ‰ä¼šè½¬å‘ç»™å†…ç½‘ä¸»æœº&lt;/strong>ã€‚è€Œä¸”ä»¥åç»™å¤–éƒ¨ä»»ä½•ä¸»æœºå‘é€æ•°æ®ï¼Œéƒ½ä¼šç”¨ä¹‹å‰è½¬æ¢çš„ &lt;code>(PublicIP:PublicPort)&lt;/code> ç»™å¤–éƒ¨ä¸»æœºå‘é€æ•°æ®ã€‚&lt;/p>
&lt;p>ä¹Ÿå°±æ˜¯ï¼Œå†…éƒ¨ä¸»æœºä»¥ç›¸åŒçš„ (LocalIP:LocalPort) å¯¹ 2 ä¸ªä¸åŒçš„ (RemoteIP:RemotePort) å‘é€ UDP æŠ¥æ–‡æ—¶ï¼ŒNAT ä¼šä¸ºå†…éƒ¨ä¸»æœºåªåˆ†é…ä¸€ä¸ª &lt;code>(PublicIP:PublicPort)&lt;/code>ï¼ŒåŒæ—¶ï¼Œä¹Ÿåªæœ‰è¿™ 2 ä¸ª (RemoteIP:ReportPort) å¯ä»¥ç»™ (PublicIP: PublicPort) å‘é€æ•°æ®ï¼ˆå› ä¸ºå…ˆç”±å†…å‘å¤–å‘è¿‡ï¼‰&lt;/p>
&lt;h2 id="å¯¹ç§°å½¢-natsymmetric-nat" >
&lt;div>
&lt;a href="#%e5%af%b9%e7%a7%b0%e5%bd%a2-natsymmetric-nat">
#
&lt;/a>
å¯¹ç§°å½¢ NATï¼ˆSymmetric NATï¼‰
&lt;/div>
&lt;/h2>
&lt;p>è¿æ¥ä¸åŒçš„å¤–éƒ¨ç›®æ ‡ï¼ŒNAT æ‰“å¼€çš„ç«¯å£ä¸åŒã€‚æ˜¯ä¸€ç§ã€Œä¸€å¯¹ä¸€æ˜ å°„å…³ç³»ã€ã€‚&lt;/p>
&lt;p>æ¢å¥è¯è®²ï¼Œä¸åŒçš„ (iAddr:port, eAddr:port) ç»„åˆï¼ŒNAT ç½‘å…³ä¼šäº§ç”Ÿä¸åŒçš„é“¾è·¯ã€‚&lt;/p>
&lt;p>çœ‹èµ·æ¥ä¹Ÿå°±æ˜¯å¯¹ç§°çš„äº†ã€‚ï¼ˆæœ¬åœ°åœ°å€ï¼šç«¯å£ï¼Œç›®æ ‡åœ°å€ï¼šç«¯å£ï¼‰&lt;/p>
&lt;p>æ¯”å¦‚ &lt;strong>localA&lt;/strong>:8000 ç»è¿‡ä¸€å°æ‹¥æœ‰ &lt;strong>global&lt;/strong> çš„ä¸€å°å¯¹ç§° NAT çš„ Gatewayï¼Œè®¿é—® &lt;strong>baidu&lt;/strong>:80 å’Œ &lt;strong>google&lt;/strong>:80ï¼Œ&lt;/p>
&lt;p>baidu çœ‹åˆ°çš„å¯èƒ½æ˜¯æ¥è‡ª &lt;strong>global&lt;/strong>:5003 çš„è¯·æ±‚ï¼Œgoogle çœ‹åˆ°çš„å¯èƒ½æ˜¯æ¥è‡ª &lt;strong>global&lt;/strong>:5010 çš„è¯·æ±‚ã€‚&lt;/p>
&lt;p>æ‰“ä¸ªæ¯”æ–¹ï¼Œå½“å†…éƒ¨ä¸»æœºä»¥ç›¸åŒçš„ (LocalIP:LocalPort) å¯¹ 2 ä¸ªä¸åŒçš„ (RemoteIP:RemotePort) å‘é€ UDP æŠ¥æ–‡æ—¶ï¼Œæ­¤æ—¶ NAT å°†ä¼šä¸ºå†…éƒ¨ä¸»æœºåˆ†é…&lt;strong>ä¸¤ä¸ªä¸åŒçš„&lt;/strong> &lt;code>(PublicIP:PublicPort)&lt;/code>ï¼Œå¹¶ä¸”å»ºç«‹èµ·&lt;strong>ä¸¤ä¸ªä¸åŒçš„å†…ã€å¤–éƒ¨ Tuple è½¬æ¢å…³ç³»&lt;/strong>ã€‚&lt;/p>
&lt;h2 id="symmetric-å’Œ-port-restricted-çš„åŒºåˆ«" >
&lt;div>
&lt;a href="#symmetric-%e5%92%8c-port-restricted-%e7%9a%84%e5%8c%ba%e5%88%ab">
#
&lt;/a>
Symmetric å’Œ Port Restricted çš„åŒºåˆ«
&lt;/div>
&lt;/h2>
&lt;p>&lt;strong>Port Restricted:&lt;/strong>
&lt;img src="port-restricted.png" alt="drawing" width="400"/>&lt;/p>
&lt;ul>
&lt;li>ä¸€æ—¦å†…éƒ¨åœ°å€ï¼ˆiAddr:iPortï¼‰æ˜ å°„åˆ°å¤–éƒ¨åœ°å€ï¼ˆeAddr:ePortï¼‰ï¼Œæ‰€æœ‰å‘è‡ª iAddr:iPort çš„æ•°æ®åŒ…éƒ½ç»ç”± eAddr:ePort å‘å¤–å‘é€ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>Symmetric:&lt;/strong>
&lt;img src="symmetric.png" alt="drawing" width="400"/>&lt;/p>
&lt;ul>
&lt;li>æ¯ä¸€ä¸ªæ¥è‡ªç›¸åŒå†…éƒ¨ IP ä¸ç«¯å£ï¼Œåˆ°ä¸€ä¸ªç‰¹å®šç›®çš„åœ° IP å’Œç«¯å£çš„è¯·æ±‚ï¼Œéƒ½æ˜ å°„åˆ°ä¸€ä¸ªç‹¬ç‰¹çš„å¤–éƒ¨ IP å’Œç«¯å£ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="references" >
&lt;div>
&lt;a href="#references">
#
&lt;/a>
References
&lt;/div>
&lt;/h2>
&lt;p>&lt;a href="https://evilpan.com/2015/10/31/p2p-over-middle-box/">[1] P2P é€šä¿¡åŸç†ä¸å®ç°&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://zhuanlan.zhihu.com/p/136794983">[2] ç½‘ç»œä¹‹ NAT å’Œ N2N VPN&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.cnblogs.com/my_life/articles/11018457.html">[3] NAT çš„å››ç§ç±»å‹åŠç±»å‹æ£€æµ‹ 2ã€å¾ˆå¥½ã€‘&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://zh.wikipedia.org/wiki/%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2">[4] ç½‘ç»œåœ°å€è½¬æ¢ - Wikipedia&lt;/a>&lt;/p></description></item></channel></rss>