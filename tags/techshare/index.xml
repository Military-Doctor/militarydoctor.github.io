<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>TechShare on Junyi's Lab</title><link>https://www.junyi.dev/tags/techshare/</link><description>Junyi's Lab (TechShare)</description><generator>Hugo -- gohugo.io</generator><language>zh</language><lastBuildDate>Mon, 18 Mar 2024 19:57:21 +0800</lastBuildDate><atom:link href="https://www.junyi.dev/tags/techshare/index.xml" rel="self" type="application/rss+xml"/><item><title>ğŸ™ˆ åœ¨ GitHub Pages åšå®¢ä¸Šéšè—æ•æ„Ÿæ–‡ç« </title><link>https://www.junyi.dev/posts/github-actions/</link><pubDate>Mon, 18 Mar 2024 19:57:21 +0800</pubDate><guid>https://www.junyi.dev/posts/github-actions/</guid><description>&lt;h2 id="èƒŒæ™¯" >
&lt;div>
&lt;a href="#%e8%83%8c%e6%99%af">
#
&lt;/a>
èƒŒæ™¯
&lt;/div>
&lt;/h2>&lt;p>å¦‚ä½•&lt;strong>é˜²æ­¢ä»–äººçœ‹åˆ°ä½ &lt;/strong>æ‰˜ç®¡åœ¨GitHub Pagesä¸Šçš„æŸäº›æ–‡ç« ï¼Ÿ&lt;/p>
&lt;p>è¿™ç¯‡æŒ‡å—æä¾›äº†ä¸€ç§åœ¨GitHub Pagesä¸Šæ‰˜ç®¡ç½‘ç«™åŒæ—¶ä¿æŒæ•æ„Ÿå†…å®¹ç§å¯†çš„ç­–ç•¥ã€‚&lt;/p>
&lt;p>è¿™ä¸ªè§£å†³æ–¹æ¡ˆæ¶‰åŠåˆ°ä½¿ç”¨ä¸¤ä¸ªç‹¬ç«‹çš„ GitHub ä»“åº“ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>ç§æœ‰ä»“åº“ &lt;code>blog-src&lt;/code>: å­˜æ”¾ä½ çš„ç½‘ç«™æºä»£ç ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å…¬å¼€ä»“åº“ &lt;code>blog.github.io&lt;/code>: ç”¨äºç”Ÿæˆçš„é™æ€ç½‘ç«™ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>è¿™ä¸ªæ–¹æ³•ç¡®ä¿æ•æ„Ÿå†…å®¹åœ¨ &lt;code>blog-src&lt;/code> ä¸­ä¿æŒç§å¯†ã€‚&lt;/p>
&lt;p>æ¯æ¬¡å¯¹ &lt;code>blog-src&lt;/code> è¿›è¡Œæäº¤æ—¶ï¼Œä¸€ä¸ªè‡ªåŠ¨åŒ–è¿‡ç¨‹ä¼šæ„å»ºé™æ€ç½‘ç«™å¹¶å°†å…¶æ¨é€åˆ° &lt;code>blog.github.io&lt;/code>ï¼ˆå‚è§&lt;a href="#fig1">å›¾ 1&lt;/a>ï¼‰ã€‚&lt;/p>
&lt;figure>
&lt;img id="fig1" src="fig1.png" alt="The Overview of using Github Actions to publish GitHub pages" width="500" />
&lt;figcaption>å›¾ 1 - ä¿®æ”¹ &lt;code>blog-src&lt;/code> æ—¶ï¼Œè‡ªåŠ¨æ„å»ºç½‘ç«™å¹¶åŒæ­¥åˆ° &lt;code>blog.github.io&lt;/code>&lt;/figcaption>
&lt;/figure>
&lt;p>è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å®ç°è¿™ä¸ªåŠŸèƒ½ï¼&lt;/p>
&lt;h2 id="ç¬¬ä¸€æ­¥åˆ›å»ºä¸€ä¸ª-personal-access-token" >
&lt;div>
&lt;a href="#%e7%ac%ac%e4%b8%80%e6%ad%a5%e5%88%9b%e5%bb%ba%e4%b8%80%e4%b8%aa-personal-access-token">
#
&lt;/a>
ç¬¬ä¸€æ­¥ï¼Œåˆ›å»ºä¸€ä¸ª personal access token
&lt;/div>
&lt;/h2>&lt;ol>
&lt;li>
&lt;p>è®¿é—®&lt;a href="https://github.com/settings/tokens">æ­¤é¡µé¢&lt;/a>ï¼ˆSettings âœ Developer Settings âœ Personal access tokensï¼‰&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Generate new token (classic)&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å‹¾é€‰æ‰€æœ‰çš„ &amp;ldquo;repo&amp;rdquo; å’Œ &amp;ldquo;workflow&amp;rdquo;ã€‚ï¼ˆå‚è§&lt;a href="#fig2">å›¾2&lt;/a>ï¼‰&lt;/p>
&lt;/li>
&lt;/ol>
&lt;figure>
&lt;img src="create-personal-key.png" alt="View Service" width="500" />
&lt;figcaption>å›¾ 2 - ç»™ GitHub Action åˆ›å»ºä¸€ä¸ª personal access token&lt;/figcaption>
&lt;/figure>
&lt;figure>
&lt;img src="created-token.png" alt="View Service" width="500" />
&lt;figcaption>å›¾ 3 - åˆ›å»ºå¥½çš„ personal access token&lt;/figcaption>
&lt;/figure>
&lt;p>å¤åˆ¶ä½ ç”Ÿæˆçš„ Tokenï¼Œæ¯”å¦‚æˆ‘çš„æ˜¯ &lt;code>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&lt;/code>&lt;/p>
&lt;p>ï¼ˆæ­¤ Token ä»…ç”¨ä½œæ¼”ç¤ºï¼Œå®é™…å·²å¤±æ•ˆï¼‰&lt;/p>
&lt;h2 id="ç¬¬äºŒæ­¥ç»™-blog-src-åˆ›å»ºä¸€ä¸ª-repository-secret" >
&lt;div>
&lt;a href="#%e7%ac%ac%e4%ba%8c%e6%ad%a5%e7%bb%99-blog-src-%e5%88%9b%e5%bb%ba%e4%b8%80%e4%b8%aa-repository-secret">
#
&lt;/a>
ç¬¬äºŒæ­¥ï¼Œç»™ &lt;code>blog-src&lt;/code> åˆ›å»ºä¸€ä¸ª repository secret
&lt;/div>
&lt;/h2>&lt;p>è¿™ä¸ªä»“åº“åŒ…å«æˆ‘ä»¬ç½‘ç«™çš„æºä»£ç ï¼Œå’Œä¸€ä¸ª GitHub Actionã€‚&lt;/p>
&lt;p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æŠŠ personal access tokenï¼ˆä»ç¬¬ä¸€æ­¥ç”Ÿæˆï¼‰æ”¾åˆ° repository secret é‡Œï¼Œä»¥æ”¯æŒ GitHub Action è¿‡ç¨‹ã€‚&lt;/p>
&lt;p>è½¬åˆ° &lt;code>blog-src&lt;/code> âœ Settings âœ Secrets and variables âœ Actions âœ New &lt;strong>repository&lt;/strong> secret&lt;/p>
&lt;figure>
&lt;img src="new-repo-secret.png" alt="View Service" width="500" />
&lt;figcaption>å›¾ 4 - åˆ›å»º repository secret çš„å…¥å£&lt;/figcaption>
&lt;/figure>
&lt;figure>
&lt;img src="add-secret.png" alt="View Service" width="500" />
&lt;figcaption>å›¾ 5 - åˆ›å»ºä¸€ä¸ª repository secret&lt;/figcaption>
&lt;/figure>
&lt;h2 id="ç¬¬ä¸‰æ­¥ç»™-blog-src-è®¾ç½®ä¸€ä¸ª-workflow" >
&lt;div>
&lt;a href="#%e7%ac%ac%e4%b8%89%e6%ad%a5%e7%bb%99-blog-src-%e8%ae%be%e7%bd%ae%e4%b8%80%e4%b8%aa-workflow">
#
&lt;/a>
ç¬¬ä¸‰æ­¥ï¼Œç»™ &lt;code>blog-src&lt;/code> è®¾ç½®ä¸€ä¸ª workflow
&lt;/div>
&lt;/h2>&lt;p>Repository âœ Actions âœ Set up a workflow yourself&lt;/p>
&lt;figure>
&lt;img src="setup-actions.png" alt="Setup Actions", width="500" />
&lt;figcaption>å›¾ 6 - è®¾ç½®ä¸€ä¸ª workflow.&lt;/figcaption>
&lt;/figure>
&lt;p>ä½ éœ€è¦å­¦ä¹ å¦‚ä½•ç¼–å†™å·¥ä½œæµï¼Œä»¥ä¸‹æ˜¯ä¸€äº›ä½ å¯ä»¥é˜…è¯»çš„æ–‡æ¡£ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.github.com/en/actions/quickstart">GitHub Actions å¿«é€Ÿå…¥é—¨&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.github.com/en/actions/examples">å·¥ä½œæµç¤ºä¾‹&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>ä»”ç»†è®¾è®¡ä½ çš„ workflow æ–‡ä»¶ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># main.yaml&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># A Sample workflow for building and deploying a site to GitHub Pages&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Deploy Website to Pages&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">on&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">push&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">branches&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">main&lt;/span> &lt;span style="color:#75715e"># Triggers this workflow whenever there&amp;#39;s a push to the `main` branch&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Allows you to run this workflow manually from the Actions tab&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">workflow_dispatch&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">schedule&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Runs at 00:00 UTC every day&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">cron&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;0 0 * * *&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">permissions&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">contents&lt;/span>: &lt;span style="color:#ae81ff">read&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">pages&lt;/span>: &lt;span style="color:#ae81ff">write&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">id-token&lt;/span>: &lt;span style="color:#ae81ff">write&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Allow only one concurrent deployment, skipping runs queued between the run in-progress and latest queued.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># However, do NOT cancel in-progress runs as we want to allow these production deployments to complete.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">concurrency&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">group&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;pages&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">cancel-in-progress&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Default to bash&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">defaults&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">run&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">shell&lt;/span>: &lt;span style="color:#ae81ff">bash&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">jobs&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">build-and-deploy&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">runs-on&lt;/span>: &lt;span style="color:#ae81ff">ubuntu-latest&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">env&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">YOUR_ENV_HERE&lt;/span>: &lt;span style="color:#ae81ff">0.1.2.3&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">steps&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Checkout&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">uses&lt;/span>: &lt;span style="color:#ae81ff">actions/checkout@v3&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">with&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">submodules&lt;/span>: &lt;span style="color:#ae81ff">recursive&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">fetch-depth&lt;/span>: &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Build my website&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">run&lt;/span>: |&lt;span style="color:#e6db74">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> echo &amp;#34;Building the website ... (Remember to replace it with the real command!!!)&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Deploy to GitHub Pages&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">uses&lt;/span>: &lt;span style="color:#ae81ff">peaceiris/actions-gh-pages@v3&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">with&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">personal_token&lt;/span>: &lt;span style="color:#ae81ff">${{ secrets.GH_PAGES_PAT }}&lt;/span> &lt;span style="color:#75715e"># The pre-defined secret in Step 2.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">publish_dir&lt;/span>: &lt;span style="color:#ae81ff">./public &lt;/span> &lt;span style="color:#75715e"># Content in this folder will be pushed to the target repo.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">user_name&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;github-actions[bot]&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">user_email&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;github-actions[bot]@users.noreply.github.com&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">external_repository&lt;/span>: &lt;span style="color:#ae81ff">Junyi-99/blog.github.io &lt;/span> &lt;span style="color:#75715e"># Your GitHub Pages Repo (target repo)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">commit_message&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;Automated deployment from Repository blog-src&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ç¬¬å››æ­¥æ¨é€åˆ°-blog-src" >
&lt;div>
&lt;a href="#%e7%ac%ac%e5%9b%9b%e6%ad%a5%e6%8e%a8%e9%80%81%e5%88%b0-blog-src">
#
&lt;/a>
ç¬¬å››æ­¥ï¼Œæ¨é€åˆ° &lt;code>blog-src&lt;/code>
&lt;/div>
&lt;/h2>&lt;p>åœ¨è¿™ä¸ªæ­¥éª¤ä¸­ï¼Œä½ éœ€è¦åšçš„å°±æ˜¯å‘ &lt;code>blog-src&lt;/code> &lt;strong>æ¨é€&lt;/strong> ä¸€äº›æäº¤ï¼Œå¦‚æœä¸€åˆ‡é¡ºåˆ©çš„è¯ï¼Œä½ çš„ GitHub Actions å°†ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œæ„å»ºä½ çš„ç½‘ç«™ï¼Œå¹¶å°†å…¶æ¨é€åˆ° &lt;code>blog.github.io&lt;/code> ä»“åº“ã€‚&lt;/p>
&lt;p>ï¼ˆæ–‡ç« ç»“æŸï¼‰&lt;/p></description></item></channel></rss>